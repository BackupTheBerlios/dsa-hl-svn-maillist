<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r4437 - in rl/trunk: Mac/Rastullah.xcodeproj	engine/core/include engine/core/src engine/startup/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2008-July/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4437%20-%20in%20rl/trunk%3A%20Mac/Rastullah.xcodeproj%0A%09engine/core/include%20engine/core/src%20engine/startup/src&In-Reply-To=%3C200807062110.m66LAsFZ000303%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001507.html">
   <LINK REL="Next"  HREF="001509.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r4437 - in rl/trunk: Mac/Rastullah.xcodeproj	engine/core/include engine/core/src engine/startup/src</H1>
    <B>blakharaz at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4437%20-%20in%20rl/trunk%3A%20Mac/Rastullah.xcodeproj%0A%09engine/core/include%20engine/core/src%20engine/startup/src&In-Reply-To=%3C200807062110.m66LAsFZ000303%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r4437 - in rl/trunk: Mac/Rastullah.xcodeproj	engine/core/include engine/core/src engine/startup/src">blakharaz at mail.berlios.de
       </A><BR>
    <I>Sun Jul  6 23:10:54 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001507.html">[Dsa-hl-svn] r4436 - modules/common/gui/imagesets
</A></li>
        <LI>Next message: <A HREF="001509.html">[Dsa-hl-svn] r4438 - in rl/trunk/engine: core/include core/src	startup/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1508">[ date ]</a>
              <a href="thread.html#1508">[ thread ]</a>
              <a href="subject.html#1508">[ subject ]</a>
              <a href="author.html#1508">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: blakharaz
Date: 2008-07-06 23:10:49 +0200 (Sun, 06 Jul 2008)
New Revision: 4437

Modified:
   rl/trunk/Mac/Rastullah.xcodeproj/project.pbxproj
   rl/trunk/engine/core/include/ConfigurationManager.h
   rl/trunk/engine/core/src/ConfigurationManager.cpp
   rl/trunk/engine/core/src/RubyInterpreter.cpp
   rl/trunk/engine/startup/src/RastullahMain.cpp
Log:
Mac OS X: Use paths relative to started executable to support application bundles?\226?\128?\168Xcode project: added &quot;copy frameworks&quot; target

Modified: rl/trunk/Mac/Rastullah.xcodeproj/project.pbxproj
===================================================================
--- rl/trunk/Mac/Rastullah.xcodeproj/project.pbxproj	2008-07-06 09:45:38 UTC (rev 4436)
+++ rl/trunk/Mac/Rastullah.xcodeproj/project.pbxproj	2008-07-06 21:10:49 UTC (rev 4437)
@@ -429,19 +429,6 @@
 		44D8147A0BF7B62F00534175 /* Trigger.h in Headers */ = {isa = PBXBuildFile; fileRef = 44D814750BF7B62F00534175 /* Trigger.h */; };
 		44D8147B0BF7B62F00534175 /* Zone.h in Headers */ = {isa = PBXBuildFile; fileRef = 44D814760BF7B62F00534175 /* Zone.h */; };
 		44D8147C0BF7B62F00534175 /* ZoneManager.h in Headers */ = {isa = PBXBuildFile; fileRef = 44D814770BF7B62F00534175 /* ZoneManager.h */; };
-		48187AAB0D885CBB00CE6689 /* libRlCommon.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAAB20BD0E0FB00C6D4A0 /* libRlCommon.dylib */; };
-		48187AAC0D885CBB00CE6689 /* libRlCore.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAB610BD0E2DA00C6D4A0 /* libRlCore.dylib */; };
-		48187AAD0D885CBB00CE6689 /* libRlAi.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC270BD0E3FF00C6D4A0 /* libRlAi.dylib */; };
-		48187AAE0D885CBB00CE6689 /* libRlRules.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC370BD0E44900C6D4A0 /* libRlRules.dylib */; };
-		48187AAF0D885CBB00CE6689 /* libRlUi.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC3E0BD0E46000C6D4A0 /* libRlUi.dylib */; };
-		483514870D8AED510077477D /* OIS.framework in Resources */ = {isa = PBXBuildFile; fileRef = 4857E4E40D46A664009D376D /* OIS.framework */; };
-		483514890D8AED510077477D /* libmeshmagick.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 440785DD0C09D231006E496D /* libmeshmagick.dylib */; };
-		4835148A0D8AED510077477D /* libruby.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 483646A10D83D57800912FEC /* libruby.dylib */; };
-		4835148B0D8AED510077477D /* OgreCEGUIRenderer.framework in Resources */ = {isa = PBXBuildFile; fileRef = 444EB3720BD1784A00C6D4A0 /* OgreCEGUIRenderer.framework */; };
-		4835148C0D8AED510077477D /* OpenSteer.framework in Resources */ = {isa = PBXBuildFile; fileRef = 444EB0DA0BD119BB00C6D4A0 /* OpenSteer.framework */; };
-		4835148D0D8AED510077477D /* CEGUI.framework in Resources */ = {isa = PBXBuildFile; fileRef = 444EAEBD0BD0F09900C6D4A0 /* CEGUI.framework */; };
-		4835148E0D8AED510077477D /* Ogre.framework in Resources */ = {isa = PBXBuildFile; fileRef = 444EAEBE0BD0F09900C6D4A0 /* Ogre.framework */; };
-		4835148F0D8AED510077477D /* OgreNewt.framework in Resources */ = {isa = PBXBuildFile; fileRef = 444EB0880BD1153500C6D4A0 /* OgreNewt.framework */; };
 		483646990D83D13700912FEC /* ContentLoader.h in Headers */ = {isa = PBXBuildFile; fileRef = 483646960D83D13700912FEC /* ContentLoader.h */; };
 		4836469A0D83D13700912FEC /* SoundStitching.h in Headers */ = {isa = PBXBuildFile; fileRef = 483646970D83D13700912FEC /* SoundStitching.h */; };
 		4836469B0D83D13700912FEC /* StartAnimationJob.h in Headers */ = {isa = PBXBuildFile; fileRef = 483646980D83D13700912FEC /* StartAnimationJob.h */; };
@@ -549,6 +536,21 @@
 		483D86A70D8C3DA200F3629E /* Fmod4Sound.cpp in Sources */ = {isa = PBXBuildFile; fileRef = 483D869A0D8C3DA200F3629E /* Fmod4Sound.cpp */; };
 		483D86A80D8C3DA200F3629E /* Fmod4SoundStitching.cpp in Sources */ = {isa = PBXBuildFile; fileRef = 483D869B0D8C3DA200F3629E /* Fmod4SoundStitching.cpp */; };
 		483D87CE0D8C564400F3629E /* libRlScript.dylib in Frameworks */ = {isa = PBXBuildFile; fileRef = 48570C1B0D8A6C5400096E35 /* libRlScript.dylib */; };
+		484D8D0B0E1E05F400BCFC2B /* OgreCEGUIRenderer.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 444EB3720BD1784A00C6D4A0 /* OgreCEGUIRenderer.framework */; };
+		484D8D0C0E1E05F400BCFC2B /* OpenSteer.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 444EB0DA0BD119BB00C6D4A0 /* OpenSteer.framework */; };
+		484D8D0D0E1E05F400BCFC2B /* CEGUI.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 444EAEBD0BD0F09900C6D4A0 /* CEGUI.framework */; };
+		484D8D0E0E1E05F400BCFC2B /* Ogre.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 444EAEBE0BD0F09900C6D4A0 /* Ogre.framework */; };
+		484D8D0F0E1E05F400BCFC2B /* OgreNewt.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 444EB0880BD1153500C6D4A0 /* OgreNewt.framework */; };
+		484D92140E1E060200BCFC2B /* Xerces.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 4836CBC80D8FB0BE002FE5D7 /* Xerces.framework */; };
+		484D92150E1E060200BCFC2B /* OIS.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 4857E4E40D46A664009D376D /* OIS.framework */; };
+		484D921E0E1E078100BCFC2B /* libRlCommon.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAAB20BD0E0FB00C6D4A0 /* libRlCommon.dylib */; };
+		484D921F0E1E078100BCFC2B /* libRlCore.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAB610BD0E2DA00C6D4A0 /* libRlCore.dylib */; };
+		484D92200E1E078100BCFC2B /* libRlAi.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC270BD0E3FF00C6D4A0 /* libRlAi.dylib */; };
+		484D92210E1E078100BCFC2B /* libRlRules.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC370BD0E44900C6D4A0 /* libRlRules.dylib */; };
+		484D92220E1E078100BCFC2B /* libRlUi.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC3E0BD0E46000C6D4A0 /* libRlUi.dylib */; };
+		484D92230E1E078100BCFC2B /* libRlScript.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 48570C1B0D8A6C5400096E35 /* libRlScript.dylib */; };
+		484D92240E1E078100BCFC2B /* libRlFmod4Driver.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 483D86700D8C3A3300F3629E /* libRlFmod4Driver.dylib */; };
+		484D92250E1E078100BCFC2B /* RlScript.bundle in Resources */ = {isa = PBXBuildFile; fileRef = 483D87C90D8C55E500F3629E /* RlScript.bundle */; };
 		484FE6BA0E17BC8800FA880F /* Carbon.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 484FE6B90E17BC8800FA880F /* Carbon.framework */; };
 		484FE6BB0E17BC8800FA880F /* Carbon.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 484FE6B90E17BC8800FA880F /* Carbon.framework */; };
 		484FE6BC0E17BC8800FA880F /* Carbon.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 484FE6B90E17BC8800FA880F /* Carbon.framework */; };
@@ -656,9 +658,6 @@
 		48A52CC20E0EF77E008DBDD8 /* libboost_system.lib in Frameworks */ = {isa = PBXBuildFile; fileRef = 48A52CAF0E0EF55C008DBDD8 /* libboost_system.lib */; };
 		48A52CC30E0EF785008DBDD8 /* libboost_system.lib in Frameworks */ = {isa = PBXBuildFile; fileRef = 48A52CAF0E0EF55C008DBDD8 /* libboost_system.lib */; };
 		48B5F63A0DAF48AF00D05C95 /* Info.plist in Resources */ = {isa = PBXBuildFile; fileRef = 8D0C4E960486CD37000505A6 /* Info.plist */; };
-		48B5F6520DAF4D2D00D05C95 /* libRlScript.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 48570C1B0D8A6C5400096E35 /* libRlScript.dylib */; };
-		48B5F6530DAF4D3500D05C95 /* libRlFmod4Driver.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 483D86700D8C3A3300F3629E /* libRlFmod4Driver.dylib */; };
-		48B5F6540DAF4D4400D05C95 /* RlScript.bundle in Resources */ = {isa = PBXBuildFile; fileRef = 483D87C90D8C55E500F3629E /* RlScript.bundle */; };
 		48B772DD0D58350B000A3B97 /* XmlProcessor.h in Headers */ = {isa = PBXBuildFile; fileRef = 48B772DA0D58350B000A3B97 /* XmlProcessor.h */; };
 		48B772DE0D58350B000A3B97 /* XmlPropertyReader.h in Headers */ = {isa = PBXBuildFile; fileRef = 48B772DB0D58350B000A3B97 /* XmlPropertyReader.h */; };
 		48B772DF0D58350B000A3B97 /* XmlPropertyWriter.h in Headers */ = {isa = PBXBuildFile; fileRef = 48B772DC0D58350B000A3B97 /* XmlPropertyWriter.h */; };
@@ -820,6 +819,26 @@
 		};
 /* End PBXContainerItemProxy section */
 
+/* Begin PBXCopyFilesBuildPhase section */
+		484D8D0A0E1E058D00BCFC2B /* Copy Frameworks */ = {
+			isa = PBXCopyFilesBuildPhase;
+			buildActionMask = 2147483647;
+			dstPath = &quot;&quot;;
+			dstSubfolderSpec = 10;
+			files = (
+				484D92140E1E060200BCFC2B /* Xerces.framework in Copy Frameworks */,
+				484D92150E1E060200BCFC2B /* OIS.framework in Copy Frameworks */,
+				484D8D0B0E1E05F400BCFC2B /* OgreCEGUIRenderer.framework in Copy Frameworks */,
+				484D8D0C0E1E05F400BCFC2B /* OpenSteer.framework in Copy Frameworks */,
+				484D8D0D0E1E05F400BCFC2B /* CEGUI.framework in Copy Frameworks */,
+				484D8D0E0E1E05F400BCFC2B /* Ogre.framework in Copy Frameworks */,
+				484D8D0F0E1E05F400BCFC2B /* OgreNewt.framework in Copy Frameworks */,
+			);
+			name = &quot;Copy Frameworks&quot;;
+			runOnlyForDeploymentPostprocessing = 0;
+		};
+/* End PBXCopyFilesBuildPhase section */
+
 /* Begin PBXFileReference section */
 		0867D6ABFE840B52C02AAC07 /* English */ = {isa = PBXFileReference; fileEncoding = 10; lastKnownFileType = text.plist.strings; name = English; path = English.lproj/InfoPlist.strings; sourceTree = &quot;&lt;group&gt;&quot;; };
 		1870340FFE93FCAF11CA0CD7 /* English */ = {isa = PBXFileReference; lastKnownFileType = wrapper.nib; name = English; path = English.lproj/main.nib; sourceTree = &quot;&lt;group&gt;&quot;; };
@@ -1670,12 +1689,12 @@
 			isa = PBXGroup;
 			children = (
 				485A056A0D71EDC40024198D /* MessageObject.h */,
+				485A057E0D71EDF20024198D /* MessagePump.cpp */,
 				485A056B0D71EDC40024198D /* MessagePump.h */,
 				485A056C0D71EDC40024198D /* MessageType.h */,
 				48B772E00D583521000A3B97 /* XmlProcessor.cpp */,
 				48B772E10D583521000A3B97 /* XmlPropertyReader.cpp */,
 				48B772E20D583521000A3B97 /* XmlPropertyWriter.cpp */,
-				485A057E0D71EDF20024198D /* MessagePump.cpp */,
 				48B772DA0D58350B000A3B97 /* XmlProcessor.h */,
 				48B772DB0D58350B000A3B97 /* XmlPropertyReader.h */,
 				48B772DC0D58350B000A3B97 /* XmlPropertyWriter.h */,
@@ -2848,6 +2867,7 @@
 				8D0C4E8C0486CD37000505A6 /* Resources */,
 				8D0C4E8F0486CD37000505A6 /* Sources */,
 				8D0C4E910486CD37000505A6 /* Frameworks */,
+				484D8D0A0E1E058D00BCFC2B /* Copy Frameworks */,
 			);
 			buildRules = (
 			);
@@ -2900,22 +2920,14 @@
 			isa = PBXResourcesBuildPhase;
 			buildActionMask = 2147483647;
 			files = (
-				48B5F6540DAF4D4400D05C95 /* RlScript.bundle in Resources */,
-				48B5F6530DAF4D3500D05C95 /* libRlFmod4Driver.dylib in Resources */,
-				48B5F6520DAF4D2D00D05C95 /* libRlScript.dylib in Resources */,
-				48187AAB0D885CBB00CE6689 /* libRlCommon.dylib in Resources */,
-				48187AAC0D885CBB00CE6689 /* libRlCore.dylib in Resources */,
-				483514870D8AED510077477D /* OIS.framework in Resources */,
-				483514890D8AED510077477D /* libmeshmagick.dylib in Resources */,
-				4835148A0D8AED510077477D /* libruby.dylib in Resources */,
-				4835148B0D8AED510077477D /* OgreCEGUIRenderer.framework in Resources */,
-				4835148C0D8AED510077477D /* OpenSteer.framework in Resources */,
-				4835148D0D8AED510077477D /* CEGUI.framework in Resources */,
-				4835148E0D8AED510077477D /* Ogre.framework in Resources */,
-				4835148F0D8AED510077477D /* OgreNewt.framework in Resources */,
-				48187AAD0D885CBB00CE6689 /* libRlAi.dylib in Resources */,
-				48187AAE0D885CBB00CE6689 /* libRlRules.dylib in Resources */,
-				48187AAF0D885CBB00CE6689 /* libRlUi.dylib in Resources */,
+				484D921E0E1E078100BCFC2B /* libRlCommon.dylib in Resources */,
+				484D921F0E1E078100BCFC2B /* libRlCore.dylib in Resources */,
+				484D92200E1E078100BCFC2B /* libRlAi.dylib in Resources */,
+				484D92210E1E078100BCFC2B /* libRlRules.dylib in Resources */,
+				484D92220E1E078100BCFC2B /* libRlUi.dylib in Resources */,
+				484D92230E1E078100BCFC2B /* libRlScript.dylib in Resources */,
+				484D92240E1E078100BCFC2B /* libRlFmod4Driver.dylib in Resources */,
+				484D92250E1E078100BCFC2B /* RlScript.bundle in Resources */,
 				8D0C4E8D0486CD37000505A6 /* InfoPlist.strings in Resources */,
 				8D0C4E8E0486CD37000505A6 /* main.nib in Resources */,
 				48D409CE0D9E483300AE5340 /* modules in Resources */,

Modified: rl/trunk/engine/core/include/ConfigurationManager.h
===================================================================
--- rl/trunk/engine/core/include/ConfigurationManager.h	2008-07-06 09:45:38 UTC (rev 4436)
+++ rl/trunk/engine/core/include/ConfigurationManager.h	2008-07-06 21:10:49 UTC (rev 4437)
@@ -1,292 +1,303 @@
-/* This source file is part of Rastullahs Lockenpracht.
- * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the Clarified Artistic License.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  Clarified Artistic License for more details.
- *
- *  You should have received a copy of the Clarified Artistic License
- *  along with this program; if not you can get it here
- *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
- */
-
-/**
- * \file ConfigurationManager.h
- *
- * Declaration of the ConfigurationManager subsystem
- */
-
-#ifndef __RL_CONFIGURATIONMANAGER_H__
-#define __RL_CONFIGURATIONMANAGER_H__
-
-#include &quot;CorePrerequisites.h&quot;
-#include &quot;ConfigFile.h&quot;
-
-#include &lt;boost/filesystem/operations.hpp&gt;
-#include &lt;boost/filesystem/exception.hpp&gt;
-
-namespace fs = boost::filesystem;
-
-namespace rl
-{
-    /**
-     * The ConfigurationManager subsystem class
-     *
-     * It provides a convenient way for other subsystems to access values read from the
-     * configuration files. If no configuration file is available, sane default values are
-     * provided so that Rastullah will work properly on most systems.
-     */
-    class _RlCoreExport ConfigurationManager : public Ogre::Singleton&lt;ConfigurationManager&gt;
-    {
-        public:
-
-            ~ConfigurationManager();
-
-            /**
-             * Returns a pointer to the single instance of the
-             * ConfigurationManager.
-             *
-             * The ConfigurationManager object is created, if it does not
-             * exist.
-             *
-             * @return Pointer to ConfigurationManager object
-             */
-            static ConfigurationManager* getSingletonPtr();
-
-            /**
-             * Returns a reference to the single instance of the
-             * ConfigurationManager.
-             *
-             * The ConfigurationManager object is created, if it does not
-             * exist.
-             *
-             * @return Reference to ConfigurationManager object
-             */
-            static ConfigurationManager&amp; getSingleton();
-
-            /**
-             * Returns the filename for the log written by Ogre
-             *
-             * @return filename of Ogre's logfile
-             */
-            Ogre::String getOgreLogFile() const;
-
-            /**
-             * Returns the filename for the log written by Rastullah
-             *
-             * @return filename of Rastullah's logfile
-             */
-            Ogre::String getRastullahLogFile() const;
-
-            /**
-             * Returns the filename for the log written by CEGUI
-             *
-             * @return filename of CEGUI's logfile
-             */
-            Ogre::String getCeguiLogFile() const;
-
-            /**
-             * Returns a list of paths, were Rastullah configuration files
-             * reside
-             *
-             * The list is seperated via the : character and has to be
-             * processed, before usage
-             *
-             * @return colon seperated path of Rastullah configuration
-             *         directories
-             */
-            Ogre::String getRastullahCfgPath() const;
-
-            /**
-             * Returns the root of the Rastullah modules directory
-             *
-             * @return directory where Rastullah modules reside
-             */
-            Ogre::String getModulesRootDirectory() const;
-
-            /**
-             * Returns the directory where Rastullah stores all its log files
-             *
-             * @return directoy where Rastullah logfiles are stored
-             */
-            Ogre::String getRastullahLogDirectory() const;
-
-            /**
-             * Adds a key-value pair to the list specified by section
-             *
-             * If the key already exists in the list, its value will be updated
-             *
-             * @param section The section where the key-value pair will be inserted
-             * @param key The key of the key-value pair
-             * @param value The value of the key-value pair
-             */
-            void addSetting(const Ogre::String&amp; section, const Ogre::String&amp; key, const Ogre::String&amp; value);
-
-            /**
-             * Returns the string value for a specific key in a specific section
-             *
-             * @param section The sections key-value list, which is searched
-             * @param key The key, for which a value will be returned
-             * @return string value for the specific key in the specific section
-             */
-            Ogre::String getStringSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
-
-            /**
-             * Returns the int value for a specific key in a specific section
-             *
-             * @param section The sections key-value list, which is searched
-             * @param key The key, for which a value will be returned
-             * @return int value for the specific key in the specific section
-             */
-            int getIntSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
-
-            /**
-             * Returns the boolean value for a specific key in a specific section
-             *
-             * @param section The sections key-value list, which is searched
-             * @param key The key, for which a value will be returned
-             * @return boolean value for the specific key in the specific section
-             */
-            bool getBoolSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
-
-            /**
-             * Returns the real value for a specific key in a specific section
-             *
-             * @param section The sections key-value list, which is searched
-             * @param key The key, for which a value will be returned
-             * @return real value for the specific key in the specific section
-             */
-            Ogre::Real getRealSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
-
-            /**
-             * Returns a pointer to the settings of the named section.
-             * @param section name of the section to get settings of.
-             * @return key-value list of graphic settings
-             */
-            Ogre::NameValuePairList getSettings(const Ogre::String&amp; section) const;
-
-            /**
-             * Returns a pointer to the video settings
-             * @return key-value list of graphic settings
-             */
-            Ogre::NameValuePairList* getVideoSettings() const;
-
-            /**
-             * Returns a list of Ogre plugins specific to the OS
-             *
-             * @return vector of plugin names
-             */
-            Ogre::StringVector getPluginList() const;
-
-            /**
-             * Returns the list of Rastullah game modules
-             *
-             * @return vector of module names
-             */
-            Ogre::StringVector getModuleList() const;
-
-            /**
-             * Returns the filename of the current keymap file used by
-             * Rastullah
-             *
-             * @return filename of keymap file
-             */
-            Ogre::String getKeymap() const;
-
-            /**
-             * Returns the log level specifying how verbose the created
-             * logfiles are
-             *
-             * @return verbosity level of logfiles
-             */
-            Logger::LogLevel getLogLevel() const;
-
-            /**
-             * Loads configuration files from the configuration directories
-             *
-             * Loads up to four configuration files (systemwide, user, current
-             * directory, module) and sets certain settings for the game
-             */
-            void loadConfig();
-
-            /**
-             * Saves a configuration file in OS specific directory
-             */
-            void saveConfig() const;
-
-        private:
-
-            /**
-             * Constructs a new ConfigurationManager object.
-             *
-             * Sets the name for the Ogre, Rastullah and CEGUI logfiles
-             * and the Rastullah configuration file. The path
-             * where configuration files might be reside is also set.
-             */
-            ConfigurationManager();
-
-            /**
-             * Sets the path where configuration files may reside
-             * based on the operating system.
-             */
-            void setRastullahCfgPath();
-
-            /**
-             * Adds the specified path to the Rastullah configuration path
-             * variable.
-             *
-             * All values are seperated via a colon.
-             *
-             * @param cfg_dir Directory where a configuration file may reside
-             */
-            void addToCfgPath(const std::string&amp; cfg_dir);
-
-            /**
-             * Adds a plugin to the plugin list, correctly adds _d for Windows if compiled
-             * in debug mode
-             *
-             * @param plugin the plugin to add (name without _d or file extension)
-             * @param pluginDir the directory in which the plugin dll is located
-             */
-            void addPlugin(const Ogre::String&amp; plugin, const Ogre::String&amp; pluginDir);
-
-            /**
-             * Check if a specified file exists.
-             *
-             * @param filename File being checked for existence
-             * @return true if file exists, false otherwise
-             */
-            bool checkForFile(const std::string&amp; filename);
-
-            /**
-             * Searches for a specific key in a specific section
-             *
-             * @param section The sections key-value list, which is searched
-             * @param key The key, for which a value will be returned
-             * @return value if key exits, otherwise NULL
-             */
-            Ogre::String findSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
-
-            Ogre::String mRastullahCfgFile;           //!&lt; Filename of the Rastullah configuration file
-            Ogre::String mOgreLogFile;                //!&lt; Filename of the logfile written by OGRE
-            Ogre::String mRastullahLogFile;           //!&lt; Filename of the logfile written by Rastullah
-            Ogre::String mCeguiLogFile;               //!&lt; Filename of the logfile written by CEGUI
-            Ogre::String mModulesCfgFile;             //!&lt; Filename of the Module configuration file
-            Ogre::String mModulesRootDirectory;       //!&lt; Directory where Rastullah's modules reside
-            Ogre::String mRastullahLogDirectory;      //!&lt; Directory where all logfiles are stored
-            Ogre::String mRastullahCfgPath;           //!&lt; List of directories containing Rastullah configuration files
-            Ogre::String mOgrePluginDirectory;        //!&lt; Directory where OGRE stores its plugins
-            Ogre::StringVector mModuleList;           //!&lt; List of Rastullah game modules
-            Ogre::StringVector mPluginList;           //!&lt; List of OGRE Plugins, which will be loaded by CoreSubsystem
-
-            typedef std::map&lt;Ogre::String, Ogre::NameValuePairList&gt; SectionMap;
-            /// Stores settings per section in a NameValuePairList
-            SectionMap mSettings;                     
-    };
-}
-
-#endif
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+
+/**
+ * \file ConfigurationManager.h
+ *
+ * Declaration of the ConfigurationManager subsystem
+ */
+
+#ifndef __RL_CONFIGURATIONMANAGER_H__
+#define __RL_CONFIGURATIONMANAGER_H__
+
+#include &quot;CorePrerequisites.h&quot;
+#include &quot;ConfigFile.h&quot;
+
+#include &lt;boost/filesystem/operations.hpp&gt;
+#include &lt;boost/filesystem/exception.hpp&gt;
+
+namespace fs = boost::filesystem;
+
+namespace rl
+{
+    /**
+     * The ConfigurationManager subsystem class
+     *
+     * It provides a convenient way for other subsystems to access values read from the
+     * configuration files. If no configuration file is available, sane default values are
+     * provided so that Rastullah will work properly on most systems.
+     */
+    class _RlCoreExport ConfigurationManager : public Ogre::Singleton&lt;ConfigurationManager&gt;
+    {
+        public:
+
+            ~ConfigurationManager();
+
+            /**
+             * Returns a pointer to the single instance of the
+             * ConfigurationManager.
+             *
+             * The ConfigurationManager object is created, if it does not
+             * exist.
+             *
+             * @return Pointer to ConfigurationManager object
+             */
+            static ConfigurationManager* getSingletonPtr();
+
+            /**
+             * Returns a reference to the single instance of the
+             * ConfigurationManager.
+             *
+             * The ConfigurationManager object is created, if it does not
+             * exist.
+             *
+             * @return Reference to ConfigurationManager object
+             */
+            static ConfigurationManager&amp; getSingleton();
+
+            /**
+             * Returns the filename for the log written by Ogre
+             *
+             * @return filename of Ogre's logfile
+             */
+            Ogre::String getOgreLogFile() const;
+
+            /**
+             * Returns the filename for the log written by Rastullah
+             *
+             * @return filename of Rastullah's logfile
+             */
+            Ogre::String getRastullahLogFile() const;
+
+            /**
+             * Returns the filename for the log written by CEGUI
+             *
+             * @return filename of CEGUI's logfile
+             */
+            Ogre::String getCeguiLogFile() const;
+
+            /**
+             * Returns a list of paths, were Rastullah configuration files
+             * reside
+             *
+             * The list is seperated via the : character and has to be
+             * processed, before usage
+             *
+             * @return colon seperated path of Rastullah configuration
+             *         directories
+             */
+            Ogre::String getRastullahCfgPath() const;
+
+            /**
+             * Returns the root of the Rastullah modules directory
+             *
+             * @return directory where Rastullah modules reside
+             */
+            Ogre::String getModulesRootDirectory() const;
+
+            /**
+             * Returns the directory where Rastullah stores all its log files
+             *
+             * @return directoy where Rastullah logfiles are stored
+             */
+            Ogre::String getRastullahLogDirectory() const;
+
+            /**
+             * Adds a key-value pair to the list specified by section
+             *
+             * If the key already exists in the list, its value will be updated
+             *
+             * @param section The section where the key-value pair will be inserted
+             * @param key The key of the key-value pair
+             * @param value The value of the key-value pair
+             */
+            void addSetting(const Ogre::String&amp; section, const Ogre::String&amp; key, const Ogre::String&amp; value);
+
+            /**
+             * Returns the string value for a specific key in a specific section
+             *
+             * @param section The sections key-value list, which is searched
+             * @param key The key, for which a value will be returned
+             * @return string value for the specific key in the specific section
+             */
+            Ogre::String getStringSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
+
+            /**
+             * Returns the int value for a specific key in a specific section
+             *
+             * @param section The sections key-value list, which is searched
+             * @param key The key, for which a value will be returned
+             * @return int value for the specific key in the specific section
+             */
+            int getIntSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
+
+            /**
+             * Returns the boolean value for a specific key in a specific section
+             *
+             * @param section The sections key-value list, which is searched
+             * @param key The key, for which a value will be returned
+             * @return boolean value for the specific key in the specific section
+             */
+            bool getBoolSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
+
+            /**
+             * Returns the real value for a specific key in a specific section
+             *
+             * @param section The sections key-value list, which is searched
+             * @param key The key, for which a value will be returned
+             * @return real value for the specific key in the specific section
+             */
+            Ogre::Real getRealSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
+
+            /**
+             * Returns a pointer to the settings of the named section.
+             * @param section name of the section to get settings of.
+             * @return key-value list of graphic settings
+             */
+            Ogre::NameValuePairList getSettings(const Ogre::String&amp; section) const;
+
+            /**
+             * Returns a pointer to the video settings
+             * @return key-value list of graphic settings
+             */
+            Ogre::NameValuePairList* getVideoSettings() const;
+
+            /**
+             * Returns a list of Ogre plugins specific to the OS
+             *
+             * @return vector of plugin names
+             */
+            Ogre::StringVector getPluginList() const;
+
+            /**
+             * Returns the list of Rastullah game modules
+             *
+             * @return vector of module names
+             */
+            Ogre::StringVector getModuleList() const;
+
+            /**
+             * Returns the filename of the current keymap file used by
+             * Rastullah
+             *
+             * @return filename of keymap file
+             */
+            Ogre::String getKeymap() const;
+
+            /**
+             * Returns the log level specifying how verbose the created
+             * logfiles are
+             *
+             * @return verbosity level of logfiles
+             */
+            Logger::LogLevel getLogLevel() const;
+
+            /**
+             * Loads configuration files from the configuration directories
+             *
+             * Loads up to four configuration files (systemwide, user, current
+             * directory, module) and sets certain settings for the game
+             */
+            void loadConfig();
+
+            /**
+             * Saves a configuration file in OS specific directory
+             */
+            void saveConfig() const;
+			
+			/**
+			 * Set the path of the started RL executable
+			 */
+			void setExecutablePath(const Ogre::String&amp; path);
+	
+			/**
+			 * Set the path of the started RL executable
+			 */
+			const Ogre::String&amp; getExecutablePath() const;
+	
+        private:
+
+            /**
+             * Constructs a new ConfigurationManager object.
+             *
+             * Sets the name for the Ogre, Rastullah and CEGUI logfiles
+             * and the Rastullah configuration file. The path
+             * where configuration files might be reside is also set.
+             */
+            ConfigurationManager();
+
+            /**
+             * Sets the path where configuration files may reside
+             * based on the operating system.
+             */
+            void setRastullahCfgPath();
+
+            /**
+             * Adds the specified path to the Rastullah configuration path
+             * variable.
+             *
+             * All values are seperated via a colon.
+             *
+             * @param cfg_dir Directory where a configuration file may reside
+             */
+            void addToCfgPath(const std::string&amp; cfg_dir);
+
+            /**
+             * Adds a plugin to the plugin list, correctly adds _d for Windows if compiled
+             * in debug mode
+             *
+             * @param plugin the plugin to add (name without _d or file extension)
+             * @param pluginDir the directory in which the plugin dll is located
+             */
+            void addPlugin(const Ogre::String&amp; plugin, const Ogre::String&amp; pluginDir);
+
+            /**
+             * Check if a specified file exists.
+             *
+             * @param filename File being checked for existence
+             * @return true if file exists, false otherwise
+             */
+            bool checkForFile(const std::string&amp; filename);
+
+            /**
+             * Searches for a specific key in a specific section
+             *
+             * @param section The sections key-value list, which is searched
+             * @param key The key, for which a value will be returned
+             * @return value if key exits, otherwise NULL
+             */
+            Ogre::String findSetting(const Ogre::String&amp; section, const Ogre::String&amp; key) const;
+			
+			Ogre::String mExecutablePath;             //!&lt; Filename of the running RL executable
+            Ogre::String mRastullahCfgFile;           //!&lt; Filename of the Rastullah configuration file
+            Ogre::String mOgreLogFile;                //!&lt; Filename of the logfile written by OGRE
+            Ogre::String mRastullahLogFile;           //!&lt; Filename of the logfile written by Rastullah
+            Ogre::String mCeguiLogFile;               //!&lt; Filename of the logfile written by CEGUI
+            Ogre::String mModulesCfgFile;             //!&lt; Filename of the Module configuration file
+            Ogre::String mModulesRootDirectory;       //!&lt; Directory where Rastullah's modules reside
+            Ogre::String mRastullahLogDirectory;      //!&lt; Directory where all logfiles are stored
+            Ogre::String mRastullahCfgPath;           //!&lt; List of directories containing Rastullah configuration files
+            Ogre::String mOgrePluginDirectory;        //!&lt; Directory where OGRE stores its plugins
+            Ogre::StringVector mModuleList;           //!&lt; List of Rastullah game modules
+            Ogre::StringVector mPluginList;           //!&lt; List of OGRE Plugins, which will be loaded by CoreSubsystem
+
+            typedef std::map&lt;Ogre::String, Ogre::NameValuePairList&gt; SectionMap;
+            /// Stores settings per section in a NameValuePairList
+            SectionMap mSettings;                     
+    };
+}
+
+#endif

Modified: rl/trunk/engine/core/src/ConfigurationManager.cpp
===================================================================
--- rl/trunk/engine/core/src/ConfigurationManager.cpp	2008-07-06 09:45:38 UTC (rev 4436)
+++ rl/trunk/engine/core/src/ConfigurationManager.cpp	2008-07-06 21:10:49 UTC (rev 4437)
@@ -51,6 +51,7 @@
     ConfigurationManager::ConfigurationManager()
     {
         // Filenames for log and configuration files
+		mExecutablePath = &quot;./&quot;;
         mRastullahCfgFile = &quot;rastullah.conf&quot;;
         mOgreLogFile = &quot;ogre.log&quot;;
         mCeguiLogFile = &quot;cegui.log&quot;;
@@ -382,12 +383,25 @@
     {
         return Ogre::String(&quot;config/keymap-german.xml&quot;);
     }
+	
+	void ConfigurationManager::setExecutablePath(const Ogre::String&amp; path)
+	{
+		mExecutablePath = path;
+	}
 
+	const Ogre::String&amp; ConfigurationManager::getExecutablePath() const
+	{
+		return mExecutablePath;
+	}
+
     void ConfigurationManager::setRastullahCfgPath()
     {
         // First try: Current directory
         addToCfgPath(&quot;./&quot;);
 
+#		if OGRE_PLATFORM == OGRE_PLATFORM_APPLE
+		addToCfgPath(mExecutablePath + &quot;/../Resources/modules/config/&quot;);
+#		endif
 #       if OGRE_PLATFORM != OGRE_PLATFORM_WIN32
         // Check system wide /etc/rastullah directory
         addToCfgPath(&quot;/etc/rastullah/&quot;);
@@ -421,9 +435,12 @@
     {
         try {
 #           if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
+			std::cout &lt;&lt; &quot;Checking for &quot; &lt;&lt; fs::complete(filename);
             if (fs::exists(filename))
 #           else
-            if (fs::exists(fs::path(filename, fs::portable_posix_name)))
+			std::cout &lt;&lt; &quot;Checking for &quot; &lt;&lt; 
+				fs::complete(fs::path(filename, fs::portable_posix_name)).string();
+			if (fs::exists(fs::path(filename, fs::portable_posix_name)))
 #           endif
             {
                 return true;

Modified: rl/trunk/engine/core/src/RubyInterpreter.cpp
===================================================================
--- rl/trunk/engine/core/src/RubyInterpreter.cpp	2008-07-06 09:45:38 UTC (rev 4436)
+++ rl/trunk/engine/core/src/RubyInterpreter.cpp	2008-07-06 21:10:49 UTC (rev 4437)
@@ -55,6 +55,10 @@
 
     // UTF 8 aktivieren
     execute( &quot;$KCODE = 'u'&quot; );
+	
+	#if OGRE_PLATFORM == OGRE_PLATFORM_APPLE
+	addSearchPath(ConfigurationManager::getSingleton().getExecutablePath()+&quot;/../Resources&quot;);
+	#endif
 
     //Skript-Verzeichnisse der  Dateien duerfen auch in /script liegen
     ModuleMap modules = CoreSubsystem::getSingleton().getAllModules();
@@ -92,6 +96,7 @@
 
 void RubyInterpreter::addSearchPath(const Ogre::String&amp; path)
 {
+	LOG_DEBUG(&quot;RubyInterpreter&quot;, &quot;Search path &quot;+path+&quot; added.&quot;);
     ruby_incpush(path.c_str());
 }
 

Modified: rl/trunk/engine/startup/src/RastullahMain.cpp
===================================================================
--- rl/trunk/engine/startup/src/RastullahMain.cpp	2008-07-06 09:45:38 UTC (rev 4436)
+++ rl/trunk/engine/startup/src/RastullahMain.cpp	2008-07-06 21:10:49 UTC (rev 4437)
@@ -37,7 +37,7 @@
     #include &lt;shellapi.h&gt;
 #endif
 
-void startupRl(bool developerMode, Ogre::String module)
+void startupRl(bool developerMode, Ogre::String module, Ogre::String executablePath)
 {
     rl::CoreSubsystem* core = NULL;
     rl::RulesSubsystem* rules = NULL;
@@ -49,6 +49,7 @@
 #ifndef _DEBUG
     try {
 #endif // #ifndef _DEBUG
+		rl::ConfigurationManager::getSingleton().setExecutablePath(executablePath);
         rl::ConfigurationManager::getSingleton().loadConfig();
 
         Ogre::String logDir = rl::ConfigurationManager::getSingleton().getRastullahLogDirectory();
@@ -151,12 +152,15 @@
 
 }
 
-void analyzeParameters(int argc, char** argv, bool&amp; developerMode, Ogre::String&amp; startModule)
+void analyzeParameters(int argc, char** argv, 
+	bool&amp; developerMode, Ogre::String&amp; startModule, Ogre::String&amp; executablePath)
 {
     developerMode = false;
     startModule = &quot;&quot;;
+	Ogre::String executable = argv[0];
+	executablePath = executable.substr(0, executable.find_last_of(&quot;/&quot;));
 
-    for (int argIdx = 0; argIdx &lt; argc; argIdx++)
+    for (int argIdx = 1; argIdx &lt; argc; argIdx++)
     {
         if (strncmp(argv[argIdx], &quot;--dev&quot;, 5) == 0)
             developerMode = true;
@@ -183,7 +187,8 @@
 
     bool developer;
     Ogre::String module;
-    analyzeParameters(argc, argv, developer, module);
+	Ogre::String executablePath;
+    analyzeParameters(argc, argv, developer, module, executablePath);
 
     for (int argIdx = 0; argIdx &lt; argc; argIdx++)
     {
@@ -192,7 +197,7 @@
     delete[] argv;
     LocalFree(argList);
 
-    startupRl(developer, module);
+    startupRl(developer, module, executablePath);
 
     return 0;
 }
@@ -203,9 +208,10 @@
 {
     bool developer;
     Ogre::String module;
+	Ogre::String executablePath;
 
-    analyzeParameters(argc, argv, developer, module);
-    startupRl(developer, module);
+    analyzeParameters(argc, argv, developer, module, executablePath);
+    startupRl(developer, module, executablePath);
 
     return 0;
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001507.html">[Dsa-hl-svn] r4436 - modules/common/gui/imagesets
</A></li>
	<LI>Next message: <A HREF="001509.html">[Dsa-hl-svn] r4438 - in rl/trunk/engine: core/include core/src	startup/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1508">[ date ]</a>
              <a href="thread.html#1508">[ thread ]</a>
              <a href="subject.html#1508">[ subject ]</a>
              <a href="author.html#1508">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
