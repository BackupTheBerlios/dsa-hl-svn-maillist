<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r3670 - in modules: common/materials/model	common/materials/programs ruchin/models
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2007-August/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r3670%20-%20in%20modules%3A%20common/materials/model%0A%09common/materials/programs%20ruchin/models&In-Reply-To=%3C200708070922.l779MRmB028466%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000740.html">
   <LINK REL="Next"  HREF="000742.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r3670 - in modules: common/materials/model	common/materials/programs ruchin/models</H1>
    <B>pnyx at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r3670%20-%20in%20modules%3A%20common/materials/model%0A%09common/materials/programs%20ruchin/models&In-Reply-To=%3C200708070922.l779MRmB028466%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r3670 - in modules: common/materials/model	common/materials/programs ruchin/models">pnyx at mail.berlios.de
       </A><BR>
    <I>Tue Aug  7 11:22:27 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000740.html">[Dsa-hl-svn] r3669 - rl/trunk/engine/core/src
</A></li>
        <LI>Next message: <A HREF="000742.html">[Dsa-hl-svn] r3671 - modules/common/materials/programs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#741">[ date ]</a>
              <a href="thread.html#741">[ thread ]</a>
              <a href="subject.html#741">[ subject ]</a>
              <a href="author.html#741">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: pnyx
Date: 2007-08-07 11:21:23 +0200 (Tue, 07 Aug 2007)
New Revision: 3670

Added:
   modules/common/materials/programs/Basic_Pixel_ShaderUV1_glsl.source
   modules/common/materials/programs/Basic_Pixel_Shader_Variation_glsl.source
   modules/common/materials/programs/Basic_Pixel_Shader_glsl.source
   modules/common/materials/programs/Basic_Vertex_Shader_glsl.source
   modules/common/materials/programs/Face_Pixel_Shader_glsl.source
   modules/common/materials/programs/Face_Vertex_Shader_glsl.source
   modules/common/materials/programs/Skin_Vertex_Shader_glsl.source
   modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader.source
   modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader_glsl.source
   modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader.source
   modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader_glsl.source
   modules/common/materials/programs/Torso_Pixel_Shader_2_glsl.source
   modules/common/materials/programs/Torso_Pixel_Shader_glsl.source
   modules/common/materials/programs/Torso_Vertex_Shader_glsl.source
Removed:
   modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader.program.source
   modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader.program.source
Modified:
   modules/common/materials/model/gras_plane_02.dds
   modules/common/materials/programs/Basic_Vertex_Shader.material
   modules/common/materials/programs/Basic_Vertex_ShaderUV1.material
   modules/common/materials/programs/Basic_Vertex_Shader_Alpha.material
   modules/common/materials/programs/Basic_Vertex_Shader_Hair.material
   modules/common/materials/programs/Basic_Vertex_Shader_Variation.material
   modules/common/materials/programs/Face_Vertex_Shader.material
   modules/common/materials/programs/Skin_Vertex_Shader.material
   modules/common/materials/programs/TerrainVColorBlending.material
   modules/common/materials/programs/Torso_Vertex_Shader.material
   modules/ruchin/models/Ruchin_ground.material
   modules/ruchin/models/nat_grasplane_02.material
   modules/ruchin/models/ruchin_terrain.material
Log:
*converted most shaders to glsl

Modified: modules/common/materials/model/gras_plane_02.dds
===================================================================
(Binary files differ)

Added: modules/common/materials/programs/Basic_Pixel_ShaderUV1_glsl.source
===================================================================
(Binary files differ)


Property changes on: modules/common/materials/programs/Basic_Pixel_ShaderUV1_glsl.source
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/common/materials/programs/Basic_Pixel_Shader_Variation_glsl.source
===================================================================
(Binary files differ)


Property changes on: modules/common/materials/programs/Basic_Pixel_Shader_Variation_glsl.source
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/common/materials/programs/Basic_Pixel_Shader_glsl.source
===================================================================
(Binary files differ)


Property changes on: modules/common/materials/programs/Basic_Pixel_Shader_glsl.source
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: modules/common/materials/programs/Basic_Vertex_Shader.material
===================================================================
--- modules/common/materials/programs/Basic_Vertex_Shader.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Basic_Vertex_Shader.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -15,6 +15,16 @@
 	entry_point ps_main
 }
 
+vertex_program Basic_Vertex_Shader_glsl glsl
+{
+	source Basic_Vertex_Shader_glsl.source
+}
+//DirectX 9.0 HLSL Pixel Shader ps_2_0
+fragment_program Basic_Pixel_Shader_glsl glsl
+{
+	source Basic_Pixel_Shader_glsl.source
+}
+
 vertex_program Basic_Vertex_Shader_SR hlsl
 {
   source SimpleShadowReceiver.hlsl
@@ -25,13 +35,61 @@
 material Basic_Vertex_Shader
 {
 	receive_shadows off
-	technique
+	technique glsl
 	{
 		//Rendering Pass: Pass 0 (pass index: #0 )
 		pass
 		{
 			alpha_rejection greater 128
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+			
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+	}
+	
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Basic_Pixel_Shader
 			{
 			}

Modified: modules/common/materials/programs/Basic_Vertex_ShaderUV1.material
===================================================================
--- modules/common/materials/programs/Basic_Vertex_ShaderUV1.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Basic_Vertex_ShaderUV1.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -5,17 +5,69 @@
 	target ps_2_0
 	entry_point ps_main
 }
+fragment_program Basic_Pixel_ShaderUV1_glsl glsl
+{
+	source Basic_Pixel_ShaderUV1_glsl.source
 
+}
 
+
 material Basic_Vertex_ShaderUV1
 {
-	technique
+	technique glsl
 	{
 		//Rendering Pass: Pass 0 (pass index: #0 )
 		pass
 		{
 			alpha_rejection greater 128
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_ShaderUV1_glsl
+			{
+				param_named baseMap int 0
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+	}
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Basic_Pixel_ShaderUV1
 			{
 			}

Modified: modules/common/materials/programs/Basic_Vertex_Shader_Alpha.material
===================================================================
--- modules/common/materials/programs/Basic_Vertex_Shader_Alpha.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Basic_Vertex_Shader_Alpha.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -1,7 +1,8 @@
 //Effect: Textured
 material Basic_Vertex_Shader_Alpha
 {
-	technique
+
+	technique glsl
 	{	
 		pass
 		{
@@ -12,6 +13,59 @@
       		//alpha_rejection greater 50
       		
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+		
+		
+	}
+	technique hlsl
+	{	
+		pass
+		{
+			scene_blend alpha_blend
+      		// Tiefenpuffer aus
+      		depth_write off
+      		
+      		//alpha_rejection greater 50
+      		
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Basic_Pixel_Shader
 			{
 			}

Modified: modules/common/materials/programs/Basic_Vertex_Shader_Hair.material
===================================================================
--- modules/common/materials/programs/Basic_Vertex_Shader_Hair.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Basic_Vertex_Shader_Hair.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -1,20 +1,127 @@
 //Effect: Textured
 material Basic_Vertex_Shader_Hair
 {
-	technique
+	technique glsl
 	{
 		//Rendering Pass: Pass 0 (pass index: #0 )
 		pass
 		{
 			scene_blend alpha_blend 
       		// Tiefenpuffer aus
-      		depth_write off
-      		//alpha_rejection greater 128
+      		//depth_write off
+      		alpha_rejection greater 128
       		
       		cull_hardware anticlockwise 
       		cull_software back 
       		
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+		
+		pass
+		{
+			scene_blend alpha_blend 
+      		// Tiefenpuffer aus
+      		//depth_write off
+      		alpha_rejection greater 20
+      		
+      		cull_hardware clockwise 
+      		cull_software front 
+      		
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+		
+		
+	}
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			scene_blend alpha_blend 
+      		// Tiefenpuffer aus
+      		//depth_write off
+      		alpha_rejection greater 128
+      		
+      		cull_hardware anticlockwise 
+      		cull_software back 
+      		
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Basic_Pixel_Shader
 			{
 			}
@@ -58,8 +165,8 @@
 		{
 			scene_blend alpha_blend 
       		// Tiefenpuffer aus
-      		depth_write off
-      		//alpha_rejection greater 128
+      		//depth_write off
+      		alpha_rejection greater 20
       		
       		cull_hardware clockwise 
       		cull_software front 

Modified: modules/common/materials/programs/Basic_Vertex_Shader_Variation.material
===================================================================
--- modules/common/materials/programs/Basic_Vertex_Shader_Variation.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Basic_Vertex_Shader_Variation.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -7,16 +7,85 @@
 	target ps_2_0
 	entry_point ps_main
 }
+fragment_program Basic_Pixel_Shader_Variation_glsl glsl
+{
+	source Basic_Pixel_Shader_Variation_glsl.source
 
+}
+
 material Basic_Vertex_Shader_Variation
 {
-	technique
+	technique glsl
 	{
 		//Rendering Pass: Pass 0 (pass index: #0 )
 		pass
 		{
 			alpha_rejection greater 128
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader_Variation_glsl
+			{
+				param_named baseMap int 0
+				param_named varMap int 1
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+			
+			// HLSL Vertex Shader
+			shadow_receiver_vertex_program_ref Basic_Vertex_Shader_SR
+			{
+				//Shader Constant: matWorldViewProjection
+				param_named_auto matWorldViewProjection worldviewproj_matrix
+				//Shader Constant: matWorld
+				param_named_auto matWorld world_matrix
+				//Shader Constant: matTextureViewProjection
+				param_named_auto matTextureViewProjection texture_viewproj_matrix
+			}
+
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+			texture_unit
+			{
+				texture_alias variation
+
+			}
+		}
+	}
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Basic_Pixel_Shader_Variation
 			{
 			}

Added: modules/common/materials/programs/Basic_Vertex_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/Basic_Vertex_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Basic_Vertex_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,153 @@
+//
+// Translator library functions
+//
+
+float xlat_lib_saturate( float x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec2 xlat_lib_saturate( vec2 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec3 xlat_lib_saturate( vec3 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec4 xlat_lib_saturate( vec4 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+mat2 xlat_lib_saturate(mat2 m) {
+  return mat2( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0));
+}
+
+mat3 xlat_lib_saturate(mat3 m) {
+  return mat3( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0));
+}
+
+mat4 xlat_lib_saturate(mat4 m) {
+  return mat4( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0), clamp(m[3], 0.0, 1.0));
+}
+
+
+//
+// Structure definitions
+//
+
+struct VS_OUTPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec4 Color;
+};
+
+struct VS_INPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec3 Normal;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform vec4 Light1_attenuation;
+uniform vec4 Light1_color;
+uniform vec4 Light1_position;
+uniform vec4 Light1_spec_power;
+uniform vec4 Light2_attenuation;
+uniform vec4 Light2_color;
+uniform vec4 Light2_position;
+uniform vec4 Light2_spec_power;
+uniform vec4 Light3_attenuation;
+uniform vec4 Light3_color;
+uniform vec4 Light3_position;
+uniform vec4 Light3_spec_power;
+uniform vec4 groundcolor;
+uniform mat4 matViewProjection;
+uniform vec4 skycolor;
+uniform vec4 vViewPosition;
+
+//
+// Function declarations
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input );
+
+//
+// Function definitions
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input ) {
+    VS_OUTPUT Output;
+    vec3 LightDir;
+    float Dist;
+    float AngleAttn;
+    vec3 EyeVect;
+    vec3 HalfVect;
+    float SpecAttn;
+    float DistAttn;
+
+    Output.Color = mix( skycolor, groundcolor, vec4( ((dot( Input.Normal, vec3( 0.000000, -1.00000, 0.000000)) + 1.00000) / 2.00000)));
+    Output.Position = ( matViewProjection * Input.Position );
+    LightDir = vec3( (Light1_position - (Input.Position * Light1_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light1_color * Light1_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light1_attenuation.y  + (Light1_attenuation.z  * Dist)) + ((Light1_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light1_color * AngleAttn) + SpecAttn) * DistAttn);
+    LightDir = vec3( (Light3_position - (Input.Position * Light3_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light3_color * Light3_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light3_attenuation.y  + (Light3_attenuation.z  * Dist)) + ((Light3_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light3_color * AngleAttn) + SpecAttn) * DistAttn);
+    LightDir = vec3( (Light2_position - (Input.Position * Light2_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light2_color * Light2_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light2_attenuation.y  + (Light2_attenuation.z  * Dist)) + ((Light2_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light2_color * AngleAttn) + SpecAttn) * DistAttn);
+    Output.Texcoord = Input.Texcoord;
+    Output.Texcoord1 = Input.Texcoord1;
+    Output.Texcoord2 = Input.Texcoord2;
+    return Output;
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    VS_OUTPUT xlat_retVal;
+    VS_INPUT xlat_temp_Input;
+    xlat_temp_Input.Position = vec4( gl_Vertex);
+    xlat_temp_Input.Texcoord = vec2( gl_MultiTexCoord0);
+    xlat_temp_Input.Texcoord1 = vec2( gl_MultiTexCoord1);
+    xlat_temp_Input.Texcoord2 = vec2( gl_MultiTexCoord2);
+    xlat_temp_Input.Normal = vec3( gl_Normal);
+
+    xlat_retVal = vs_main( xlat_temp_Input);
+
+    gl_Position = vec4( xlat_retVal.Position);
+    gl_TexCoord[0] = vec4( xlat_retVal.Texcoord, 0.0, 0.0);
+    gl_TexCoord[1] = vec4( xlat_retVal.Texcoord1, 0.0, 0.0);
+    gl_TexCoord[2] = vec4( xlat_retVal.Texcoord2, 0.0, 0.0);
+    gl_TexCoord[3] = vec4( xlat_retVal.Color);
+}
+
+
+
\ No newline at end of file

Added: modules/common/materials/programs/Face_Pixel_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/Face_Pixel_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Face_Pixel_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,58 @@
+//
+// Structure definitions
+//
+
+struct PS_INPUT {
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec4 Color;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform sampler2D Texture1;
+uniform sampler2D Texture2;
+uniform sampler2D baseMap;
+
+//
+// Function declarations
+//
+
+vec4 ps_main( in PS_INPUT Input );
+
+//
+// Function definitions
+//
+
+vec4 ps_main( in PS_INPUT Input ) {
+    vec4 eyeColor;
+    vec4 faceColor;
+	
+	
+    eyeColor = (texture2D( Texture1, Input.Texcoord1) * texture2D( Texture2, Input.Texcoord2));
+    faceColor = texture2D( baseMap, Input.Texcoord);
+    return vec4( (mix( eyeColor.xyz , faceColor.xyz , vec3( faceColor.w )) * Input.Color.xyz ), 1.00000);
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    vec4 xlat_retVal;
+    PS_INPUT xlat_temp_Input;
+    xlat_temp_Input.Texcoord = vec2( gl_TexCoord[0]);
+    xlat_temp_Input.Texcoord1 = vec2( gl_TexCoord[1]);
+    xlat_temp_Input.Texcoord2 = vec2( gl_TexCoord[2]);
+    xlat_temp_Input.Color = vec4( gl_TexCoord[3]);
+
+    xlat_retVal = ps_main( xlat_temp_Input);
+
+    gl_FragData[0] = vec4( xlat_retVal);
+}
+
+

Modified: modules/common/materials/programs/Face_Vertex_Shader.material
===================================================================
--- modules/common/materials/programs/Face_Vertex_Shader.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Face_Vertex_Shader.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -13,15 +13,90 @@
 	entry_point ps_main
 }
 
+vertex_program Face_Vertex_Shader_glsl glsl
+{
+	source Face_Vertex_Shader_glsl.source
+}
+
+
+fragment_program Face_Pixel_Shader_glsl glsl
+{
+	source Face_Pixel_Shader_glsl.source
+}
+
+
 material Face_Vertex_Shader
 {
-	receive_shadows off
-	technique
+	
+	technique glsl
 	{
 		//Rendering Pass: Pass 0 (pass index: #0 )
 		pass
 		{
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Face_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+				param_named Texture1 int 1
+				param_named Texture2 int 2
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Face_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				param_named subsurfcolor float4 0.8 0 0 1
+				param_named skincolor float4 0.5 0.5 0.5 1
+				param_named eyeDirection float3 0.0 0 0.0
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.25 0.25 0.25 1.0
+			}
+			
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+			texture_unit
+			{
+				texture_alias eyeColor
+
+			}
+			texture_unit
+			{
+				texture_alias eyeShadow
+
+			}
+		}
+	}
+	
+
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Face_Pixel_Shader
 			{
 			}
@@ -75,7 +150,7 @@
 		}
 	}
 
-	technique
+	technique fixed_function
 	{
         pass
         {

Added: modules/common/materials/programs/Face_Vertex_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/Face_Vertex_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Face_Vertex_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,166 @@
+//
+// Translator library functions
+//
+
+float xlat_lib_saturate( float x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec2 xlat_lib_saturate( vec2 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec3 xlat_lib_saturate( vec3 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec4 xlat_lib_saturate( vec4 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+mat2 xlat_lib_saturate(mat2 m) {
+  return mat2( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0));
+}
+
+mat3 xlat_lib_saturate(mat3 m) {
+  return mat3( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0));
+}
+
+mat4 xlat_lib_saturate(mat4 m) {
+  return mat4( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0), clamp(m[3], 0.0, 1.0));
+}
+
+
+//
+// Structure definitions
+//
+
+struct VS_OUTPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec4 Color;
+};
+
+struct VS_INPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec3 Normal;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform vec4 Light1_attenuation;
+uniform vec4 Light1_color;
+uniform vec4 Light1_position;
+uniform vec4 Light1_spec_power;
+uniform vec4 Light2_attenuation;
+uniform vec4 Light2_color;
+uniform vec4 Light2_position;
+uniform vec4 Light2_spec_power;
+uniform vec4 Light3_attenuation;
+uniform vec4 Light3_color;
+uniform vec4 Light3_position;
+uniform vec4 Light3_spec_power;
+uniform vec3 eyeDirection;
+uniform vec4 groundcolor;
+uniform mat4 matViewProjection;
+uniform vec4 skincolor;
+uniform vec4 skycolor;
+uniform vec4 subsurfcolor;
+uniform vec4 vViewPosition;
+
+//
+// Function declarations
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input );
+
+//
+// Function definitions
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input ) {
+    VS_OUTPUT Output;
+    vec3 LightDir;
+    float Dist;
+    float AngleAttn;
+    vec3 EyeVect;
+    vec3 HalfVect;
+    float SpecAttn;
+    float DistAttn;
+    float accDistAttn;
+    vec2 eyeDir;
+
+    Output.Color = vec4( 0.000000, 0.000000, 0.000000, 0.000000);
+    Output.Position = ( matViewProjection * Input.Position );
+    LightDir = vec3( (Light1_position - (Input.Position * Light1_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light1_color * Light1_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light1_attenuation.y  + (Light1_attenuation.z  * Dist)) + ((Light1_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light1_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn = DistAttn;
+    LightDir = vec3( (Light3_position - (Input.Position * Light3_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light3_color * Light3_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light3_attenuation.y  + (Light3_attenuation.z  * Dist)) + ((Light3_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light3_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn += DistAttn;
+    LightDir = vec3( (Light2_position - (Input.Position * Light2_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light2_color * Light2_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light2_attenuation.y  + (Light2_attenuation.z  * Dist)) + ((Light2_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light2_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn += DistAttn;
+    Output.Color = mix( ((xlat_lib_saturate( accDistAttn ) * subsurfcolor) * Output.Color), Output.Color, xlat_lib_saturate( ((Output.Color * 3.00000) - 0.200000) ));
+    Output.Color += mix( skycolor, groundcolor, vec4( ((dot( Input.Normal, vec3( 0.000000, -1.00000, 0.000000)) + 1.00000) / 2.00000)));
+    Output.Color *= (skincolor + 0.500000);
+    Output.Texcoord = Input.Texcoord;
+    Output.Texcoord2 = Input.Texcoord1;
+    eyeDir.x  = clamp( (( -eyeDirection.x  ) / 3.00000), -0.300000, 0.300000);
+    eyeDir.y  = clamp( (( -eyeDirection.z  ) / 3.00000), -0.300000, 0.300000);
+    Output.Texcoord1.x  = (Input.Texcoord1.x  + eyeDir.x );
+    Output.Texcoord1.y  = (Input.Texcoord1.y  + eyeDir.y );
+    return Output;
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    VS_OUTPUT xlat_retVal;
+    VS_INPUT xlat_temp_Input;
+    xlat_temp_Input.Position = vec4( gl_Vertex);
+    xlat_temp_Input.Texcoord = vec2( gl_MultiTexCoord0);
+    xlat_temp_Input.Texcoord1 = vec2( gl_MultiTexCoord1);
+    xlat_temp_Input.Texcoord2 = vec2( gl_MultiTexCoord2);
+    xlat_temp_Input.Normal = vec3( gl_Normal);
+
+    xlat_retVal = vs_main( xlat_temp_Input);
+
+    gl_Position = vec4( xlat_retVal.Position);
+    gl_TexCoord[0] = vec4( xlat_retVal.Texcoord, 0.0, 0.0);
+    gl_TexCoord[1] = vec4( xlat_retVal.Texcoord1, 0.0, 0.0);
+    gl_TexCoord[2] = vec4( xlat_retVal.Texcoord2, 0.0, 0.0);
+    gl_TexCoord[3] = vec4( xlat_retVal.Color);
+}
+
+

Modified: modules/common/materials/programs/Skin_Vertex_Shader.material
===================================================================
--- modules/common/materials/programs/Skin_Vertex_Shader.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Skin_Vertex_Shader.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -4,17 +4,71 @@
 	target vs_2_0
 	entry_point vs_main
 }
+vertex_program Skin_Vertex_Shader_glsl glsl
+{
+	source Skin_Vertex_Shader_glsl.source
+}
 
 material Skin_Vertex_Shader
 {
 	receive_shadows off
-	technique
+	
+	technique glsl
 	{
 		//Rendering Pass: Pass 0 (pass index: #0 )
 		pass
 		{
 			alpha_rejection greater 128
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Skin_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				param_named subsurfcolor float4 0.8 0 0 1
+				param_named skincolor float4 0.5 0.5 0.5 1
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.25 0.25 0.25 1.0
+			}
+			
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+	}
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Basic_Pixel_Shader
 			{
 			}

Added: modules/common/materials/programs/Skin_Vertex_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/Skin_Vertex_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Skin_Vertex_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,162 @@
+//
+// Translator library functions
+//
+
+float xlat_lib_saturate( float x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec2 xlat_lib_saturate( vec2 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec3 xlat_lib_saturate( vec3 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec4 xlat_lib_saturate( vec4 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+mat2 xlat_lib_saturate(mat2 m) {
+  return mat2( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0));
+}
+
+mat3 xlat_lib_saturate(mat3 m) {
+  return mat3( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0));
+}
+
+mat4 xlat_lib_saturate(mat4 m) {
+  return mat4( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0), clamp(m[3], 0.0, 1.0));
+}
+
+
+//
+// Structure definitions
+//
+
+struct VS_OUTPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec4 Color;
+};
+
+struct VS_INPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec3 Normal;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform vec4 Light1_attenuation;
+uniform vec4 Light1_color;
+uniform vec4 Light1_position;
+uniform vec4 Light1_spec_power;
+uniform vec4 Light2_attenuation;
+uniform vec4 Light2_color;
+uniform vec4 Light2_position;
+uniform vec4 Light2_spec_power;
+uniform vec4 Light3_attenuation;
+uniform vec4 Light3_color;
+uniform vec4 Light3_position;
+uniform vec4 Light3_spec_power;
+uniform vec4 groundcolor;
+uniform mat4 matViewProjection;
+uniform vec4 skincolor;
+uniform vec4 skycolor;
+uniform vec4 subsurfcolor;
+uniform vec4 vViewPosition;
+
+//
+// Function declarations
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input );
+
+//
+// Function definitions
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input ) {
+    VS_OUTPUT Output;
+    vec3 LightDir;
+    float Dist;
+    float AngleAttn;
+    vec3 EyeVect;
+    vec3 HalfVect;
+    float SpecAttn;
+    float DistAttn;
+    float accDistAttn;
+
+    Output.Color = vec4( 0.000000, 0.000000, 0.000000, 0.000000);
+    Output.Position = ( matViewProjection * Input.Position );
+    LightDir = vec3( (Light1_position - (Input.Position * Light1_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light1_color * Light1_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light1_attenuation.y  + (Light1_attenuation.z  * Dist)) + ((Light1_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light1_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn = DistAttn;
+    LightDir = vec3( (Light3_position - (Input.Position * Light3_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light3_color * Light3_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light3_attenuation.y  + (Light3_attenuation.z  * Dist)) + ((Light3_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light3_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn += DistAttn;
+    LightDir = vec3( (Light2_position - (Input.Position * Light2_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light2_color * Light2_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light2_attenuation.y  + (Light2_attenuation.z  * Dist)) + ((Light2_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light2_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn += DistAttn;
+    Output.Color = mix( ((xlat_lib_saturate( accDistAttn ) * subsurfcolor) * Output.Color), Output.Color, xlat_lib_saturate( ((Output.Color * 3.00000) - 0.200000) ));
+    Output.Color += mix( skycolor, groundcolor, vec4( ((dot( Input.Normal, vec3( 0.000000, -1.00000, 0.000000)) + 1.00000) / 2.00000)));
+    Output.Color *= (skincolor * 2.00000);
+    Output.Texcoord = Input.Texcoord;
+    Output.Texcoord1 = Input.Texcoord1;
+    Output.Texcoord2 = Input.Texcoord2;
+    return Output;
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    VS_OUTPUT xlat_retVal;
+    VS_INPUT xlat_temp_Input;
+    xlat_temp_Input.Position = vec4( gl_Vertex);
+    xlat_temp_Input.Texcoord = vec2( gl_MultiTexCoord0);
+    xlat_temp_Input.Texcoord1 = vec2( gl_MultiTexCoord1);
+    xlat_temp_Input.Texcoord2 = vec2( gl_MultiTexCoord2);
+    xlat_temp_Input.Normal = vec3( gl_Normal);
+
+    xlat_retVal = vs_main( xlat_temp_Input);
+
+    gl_Position = vec4( xlat_retVal.Position);
+    gl_TexCoord[0] = vec4( xlat_retVal.Texcoord, 0.0, 0.0);
+    gl_TexCoord[1] = vec4( xlat_retVal.Texcoord1, 0.0, 0.0);
+    gl_TexCoord[2] = vec4( xlat_retVal.Texcoord2, 0.0, 0.0);
+    gl_TexCoord[3] = vec4( xlat_retVal.Color);
+}
+
+
+
\ No newline at end of file

Modified: modules/common/materials/programs/TerrainVColorBlending.material
===================================================================
--- modules/common/materials/programs/TerrainVColorBlending.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/TerrainVColorBlending.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -2,7 +2,7 @@
 //DirectX 9.0 HLSL Vertex Shader vs_2_0
 vertex_program TerrainVColorBlending_Vertex_Shader hlsl
 {
-	source TerrainVColorBlending_Vertex_Shader.program.source
+	source TerrainVColorBlending_Vertex_Shader.source
 	target vs_2_0
 	entry_point vs_main
 }
@@ -10,20 +10,142 @@
 //DirectX 9.0 HLSL Pixel Shader ps_2_0
 fragment_program TerrainVColorBlending_Pixel_Shader hlsl
 {
-	source TerrainVColorBlending_Pixel_Shader.program.source
+	source TerrainVColorBlending_Pixel_Shader.source
 	target ps_2_0
 	entry_point ps_main
 }
 
+vertex_program TerrainVColorBlending_Vertex_Shader_glsl glsl
+{
+	source TerrainVColorBlending_Vertex_Shader_glsl.source
+}
 
-material TerrainVColorBlending
+//DirectX 9.0 HLSL Pixel Shader ps_2_0
+fragment_program TerrainVColorBlending_Pixel_Shader_glsl glsl
 {
-	technique
+	source TerrainVColorBlending_Pixel_Shader_glsl.source
+}
+
+
+material TerrainVColorBlendingd
+{
+	technique glsl
 	{
 
 		pass
 		{
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref TerrainVColorBlending_Pixel_Shader_glsl
+			{
+				param_named Texture0 int 0
+				param_named Texture1 int 1
+				param_named Texture2 int 2
+				param_named Texture3 int 3
+				param_named Texture4 int 4
+				param_named Texture5 int 5
+				
+
+				param_named scale_Detail4 float 0.050000 // Alpha
+			}
+			
+			
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref TerrainVColorBlending_Vertex_Shader_glsl
+			{
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named Light_Ambient float4 0.000000 0.000000 0.000000 1.000000
+				
+				//Lights:
+				param_named_auto Light_Attenuation0 light_attenuation 0
+				param_named_auto Light_Attenuation1 light_attenuation 1
+				
+				param_named_auto Light_Color0  light_diffuse_colour 0
+				param_named_auto Light_Color1  light_diffuse_colour 1
+				
+				param_named_auto Light_Position0 light_position 0
+				param_named_auto Light_Position1 light_position 1
+
+				param_named skycolor float4 0.2 0.2 0.2 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+				
+				
+				
+				param_named scale_Texture0 float 0.018000 // Schwarz
+				param_named scale_Detail0 float 0.020000
+
+				param_named scale_Texture1 float 0.007000 // Rot
+				param_named scale_Detail1 float 0.020000
+
+				param_named scale_Texture2 float 0.008500 // Gruen
+				param_named scale_Detail2 float 0.060000
+
+				param_named scale_Texture3 float 0.008000 // Blau
+				param_named scale_Detail3 float 0.050000
+
+				param_named scale_Texture4 float 0.016000 // Alpha 
+														  // fuer scale_Detail4 siehe Oben (Pixelshader)
+								
+			}
+			
+			
+			
+			shadow_receiver_vertex_program_ref Basic_Vertex_Shader_SR
+			{
+				//Shader Constant: matWorldViewProjection
+				param_named_auto matWorldViewProjection worldviewproj_matrix
+				//Shader Constant: matWorld
+				param_named_auto matWorld world_matrix
+				//Shader Constant: matTextureViewProjection
+				param_named_auto matTextureViewProjection texture_viewproj_matrix
+			}
+			
+			
+			
+			//Texture Schwarz
+			texture_unit
+			{
+				texture_alias black
+				texture nat_felsen_01.dds 2d
+			}
+			//Texture Rot
+			texture_unit
+			{
+				texture_alias red
+				texture nat_gras_01.dds 2d
+			}
+			//Texture Gruen
+			texture_unit
+			{
+				texture_alias green
+				texture nat_steingrund_01.dds 2d
+			}
+			//Texture Blau
+			texture_unit
+			{
+				texture_alias blue
+				texture nat_erdboden_01.dds 2d
+			}
+			//Texture Alpha
+			texture_unit
+			{
+				texture_alias alpha
+				texture Tiles.dds 2d
+			}
+			//Lightingmap
+			texture_unit
+			{
+				texture_alias Lightingmap
+				texture Lightingmap2.png 2d
+			}
+		}
+	}
+
+	technique hlsl
+	{
+
+		pass
+		{
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref TerrainVColorBlending_Pixel_Shader
 			{
 

Deleted: modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader.program.source
===================================================================
--- modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader.program.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader.program.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -1,36 +0,0 @@
-uniform sampler Texture0;
-uniform sampler Texture1;
-uniform sampler Texture2;
-uniform sampler Texture3;
-uniform sampler Texture4;
-uniform sampler Texture5;
-
-uniform float scale_Detail4;
-
-float4 ps_main(float4 Color: COLOR0,
-               float4 UV0 : TEXCOORD0,
-               float4 UV1 : TEXCOORD1,
-               float4 UV2 : TEXCOORD2,
-               float4 UV3 : TEXCOORD3,
-               float4 UV4 : TEXCOORD4,
-               float4 Light:COLOR1) : COLOR0
-{   
-   
-///*   
-
-
-   
-   float4 TexColor = float4(tex2D(Texture0,UV0.xy).rgb,tex2D(Texture0,UV0.zw).a);
-   TexColor = lerp(TexColor,float4(tex2D(Texture1,UV1.xy).rgb,tex2D(Texture1,UV1.zw).a),Color.r);
-   TexColor = lerp(TexColor,float4(tex2D(Texture2,UV2.xy).rgb,tex2D(Texture2,UV2.zw).a),Color.g);
-   TexColor = lerp(TexColor,float4(tex2D(Texture3,UV3.xy).rgb,tex2D(Texture3,UV3.zw).a),Color.b);
-   TexColor = lerp(float4(tex2D(Texture4,UV4.xy).rgb,tex2D(Texture4,UV4.zw * scale_Detail4).a),TexColor,Color.a);
-   
-
-  return TexColor * (TexColor.a+ 0.5) * ((tex2D(Texture5,UV4.zw)-0.5) + Light);
-  //return float4(Color.aaaa);
-
-}
-
-
-

Copied: modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader.source (from rev 3656, modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader.program.source)

Added: modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/TerrainVColorBlending_Pixel_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,48 @@
+
+//
+// Global variable definitions
+//
+
+uniform sampler2D Texture0;
+uniform sampler2D Texture1;
+uniform sampler2D Texture2;
+uniform sampler2D Texture3;
+uniform sampler2D Texture4;
+uniform sampler2D Texture5;
+uniform float scale_Detail4;
+
+//
+// Function declarations
+//
+
+vec4 ps_main( in vec4 Color, in vec4 UV0, in vec4 UV1, in vec4 UV2, in vec4 UV3, in vec4 UV4, in vec4 Light );
+
+//
+// Function definitions
+//
+
+vec4 ps_main( in vec4 Color, in vec4 UV0, in vec4 UV1, in vec4 UV2, in vec4 UV3, in vec4 UV4, in vec4 Light ) {
+    vec4 TexColor;
+
+    TexColor = vec4( texture2D( Texture0, UV0.xy ).xyz , texture2D( Texture0, UV0.zw ).w );
+    TexColor = mix( TexColor, vec4( texture2D( Texture1, UV1.xy ).xyz , texture2D( Texture1, UV1.zw ).w ), vec4( Color.x ));
+    TexColor = mix( TexColor, vec4( texture2D( Texture2, UV2.xy ).xyz , texture2D( Texture2, UV2.zw ).w ), vec4( Color.y ));
+    TexColor = mix( TexColor, vec4( texture2D( Texture3, UV3.xy ).xyz , texture2D( Texture3, UV3.zw ).w ), vec4( Color.z ));
+    TexColor = mix( vec4( texture2D( Texture4, UV4.xy ).xyz , texture2D( Texture4, (UV4.zw  * scale_Detail4)).w ), TexColor, vec4( Color.w ));
+    return ((TexColor * (TexColor.w  + 0.500000)) * ((texture2D( Texture5, UV4.zw ) - 0.500000) + Light));
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    vec4 xlat_retVal;
+
+    xlat_retVal = ps_main( vec4(gl_Color), vec4(gl_TexCoord[0]), vec4(gl_TexCoord[1]), vec4(gl_TexCoord[2]), vec4(gl_TexCoord[3]), vec4(gl_TexCoord[4]), vec4(gl_SecondaryColor));
+
+    gl_FragData[0] = vec4( xlat_retVal);
+}
+
+
+
\ No newline at end of file

Deleted: modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader.program.source
===================================================================
--- modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader.program.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader.program.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -1,88 +0,0 @@
-float4x4 matViewProjection;
-
-uniform float scale_Texture0;
-uniform float scale_Texture1;
-uniform float scale_Texture2;
-uniform float scale_Texture3;
-uniform float scale_Texture4;
-
-uniform float scale_Detail0;
-uniform float scale_Detail1;
-uniform float scale_Detail2;
-uniform float scale_Detail3;
-
-uniform float4 Light_Ambient;
-uniform float4 Light_Color0;
-uniform float4 Light_Position0;
-uniform float4 Light_Attenuation0;
-
-uniform float4 Light_Color1;
-uniform float4 Light_Position1;
-uniform float4 Light_Attenuation1;
-
-float4 skycolor;
-float4 groundcolor;
-
-
-struct VS_OUTPUT 
-{
-   float4 Position : POSITION0;
-   float4 Color:   COLOR0;
-   float4 UV0 : TEXCOORD0;
-   float4 UV1 : TEXCOORD1;
-   float4 UV2 : TEXCOORD2;
-   float4 UV3 : TEXCOORD3;
-   float4 UV4 : TEXCOORD4;
-   float4 Light: COLOR1;
-};
-
-VS_OUTPUT vs_main( float4 Position : POSITION0,
-                   float4 Color:COLOR0,
-                   float2 UV:TEXCOORD0,
-                   float3 Normal: NORMAL)
-{
-   VS_OUTPUT Output;
-   UV = Position.xz /4;
-   
-   Output.UV0 = float4(UV*scale_Texture0,UV*scale_Detail0);
-   Output.UV1 = float4(UV*scale_Texture1,UV*scale_Detail1);
-   Output.UV2 = float4(UV*scale_Texture2,UV*scale_Detail2);
-   Output.UV3 = float4(UV*scale_Texture3,UV*scale_Detail3);
-   Output.UV4 = float4(UV*scale_Texture4,UV);
-   
-   
-   Output.Position = mul( matViewProjection, Position );
-   
-   Output.Color = Color;
-   
-   // ######## Light 0 #########
-   float3 LightDir0 = Light_Position0 - Position * Light_Position0.w;
-   float Dist0 = length(LightDir0);
-   LightDir0 /= Dist0;
-   
-   float DistAttn0 = saturate(1/(Light_Attenuation0.y +
-                                Light_Attenuation0.z * Dist0 +
-                                Light_Attenuation0.w * Dist0 * Dist0));
-   float AngleAttn0= saturate(dot(Normal,LightDir0));
-   
-   
-   // ######## Light 1 #########
-   float3 LightDir1 = Light_Position1 - Position * Light_Position1.w;
-   float Dist1 = length(LightDir1);
-   LightDir1 /= Dist1;
-   
-   float DistAttn1 = saturate(1/(Light_Attenuation1.y +
-                                Light_Attenuation1.z * Dist1 +
-                                Light_Attenuation1.w * Dist1 * Dist1));
-   float AngleAttn1= saturate(dot(Normal,LightDir1));
-   
-   
-   // Light Output
-   Output.Light =lerp(skycolor,groundcolor,(dot(Normal, float3(0,-1,0))+1)/2 ) +(Light_Ambient-0.5 + ((Light_Color0 * DistAttn0 * AngleAttn0) + (Light_Color1 * DistAttn1 * AngleAttn1))*1.25);
-   
-   return( Output );
-   
-}
-
-
-

Copied: modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader.source (from rev 3657, modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader.program.source)

Added: modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/TerrainVColorBlending_Vertex_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,137 @@
+//
+// Translator library functions
+//
+
+float xlat_lib_saturate( float x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec2 xlat_lib_saturate( vec2 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec3 xlat_lib_saturate( vec3 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec4 xlat_lib_saturate( vec4 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+mat2 xlat_lib_saturate(mat2 m) {
+  return mat2( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0));
+}
+
+mat3 xlat_lib_saturate(mat3 m) {
+  return mat3( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0));
+}
+
+mat4 xlat_lib_saturate(mat4 m) {
+  return mat4( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0), clamp(m[3], 0.0, 1.0));
+}
+
+
+//
+// Structure definitions
+//
+
+struct VS_OUTPUT {
+    vec4 Position;
+    vec4 Color;
+    vec4 UV0;
+    vec4 UV1;
+    vec4 UV2;
+    vec4 UV3;
+    vec4 UV4;
+    vec4 Light;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform vec4 Light_Ambient;
+uniform vec4 Light_Attenuation0;
+uniform vec4 Light_Attenuation1;
+uniform vec4 Light_Color0;
+uniform vec4 Light_Color1;
+uniform vec4 Light_Position0;
+uniform vec4 Light_Position1;
+uniform vec4 groundcolor;
+uniform mat4 matViewProjection;
+uniform float scale_Detail0;
+uniform float scale_Detail1;
+uniform float scale_Detail2;
+uniform float scale_Detail3;
+uniform float scale_Texture0;
+uniform float scale_Texture1;
+uniform float scale_Texture2;
+uniform float scale_Texture3;
+uniform float scale_Texture4;
+uniform vec4 skycolor;
+
+//
+// Function declarations
+//
+
+VS_OUTPUT vs_main( in vec4 Position, in vec4 Color, in vec2 UV, in vec3 Normal );
+
+//
+// Function definitions
+//
+
+VS_OUTPUT vs_main( in vec4 Position, in vec4 Color, in vec2 UV, in vec3 Normal ) {
+    VS_OUTPUT Output;
+    vec3 LightDir0;
+    float Dist0;
+    float DistAttn0;
+    float AngleAttn0;
+    vec3 LightDir1;
+    float Dist1;
+    float DistAttn1;
+    float AngleAttn1;
+
+    UV = (Position.xz  / 4.00000);
+    Output.UV0 = vec4( (UV * scale_Texture0), (UV * scale_Detail0));
+    Output.UV1 = vec4( (UV * scale_Texture1), (UV * scale_Detail1));
+    Output.UV2 = vec4( (UV * scale_Texture2), (UV * scale_Detail2));
+    Output.UV3 = vec4( (UV * scale_Texture3), (UV * scale_Detail3));
+    Output.UV4 = vec4( (UV * scale_Texture4), UV);
+    Output.Position = ( matViewProjection * Position );
+    Output.Color = Color;
+    LightDir0 = vec3( (Light_Position0 - (Position * Light_Position0.w )));
+    Dist0 = length( LightDir0 );
+    LightDir0 /= Dist0;
+    DistAttn0 = xlat_lib_saturate( (1.00000 / ((Light_Attenuation0.y  + (Light_Attenuation0.z  * Dist0)) + ((Light_Attenuation0.w  * Dist0) * Dist0))) );
+    AngleAttn0 = xlat_lib_saturate( dot( Normal, LightDir0) );
+    LightDir1 = vec3( (Light_Position1 - (Position * Light_Position1.w )));
+    Dist1 = length( LightDir1 );
+    LightDir1 /= Dist1;
+    DistAttn1 = xlat_lib_saturate( (1.00000 / ((Light_Attenuation1.y  + (Light_Attenuation1.z  * Dist1)) + ((Light_Attenuation1.w  * Dist1) * Dist1))) );
+    AngleAttn1 = xlat_lib_saturate( dot( Normal, LightDir1) );
+    Output.Light = (mix( skycolor, groundcolor, vec4( ((dot( Normal, vec3( 0.000000, -1.00000, 0.000000)) + 1.00000) / 2.00000))) + ((Light_Ambient - 0.500000) + ((((Light_Color0 * DistAttn0) * AngleAttn0) + ((Light_Color1 * DistAttn1) * AngleAttn1)) * 1.25000)));
+    return Output;
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    VS_OUTPUT xlat_retVal;
+
+    xlat_retVal = vs_main( vec4(gl_Vertex), vec4(gl_Color), vec2(gl_MultiTexCoord0), vec3(gl_Normal));
+
+    gl_Position = vec4( xlat_retVal.Position);
+    gl_FrontColor = vec4( xlat_retVal.Color);
+    gl_TexCoord[0] = vec4( xlat_retVal.UV0);
+    gl_TexCoord[1] = vec4( xlat_retVal.UV1);
+    gl_TexCoord[2] = vec4( xlat_retVal.UV2);
+    gl_TexCoord[3] = vec4( xlat_retVal.UV3);
+    gl_TexCoord[4] = vec4( xlat_retVal.UV4);
+    gl_FrontSecondaryColor = vec4( xlat_retVal.Light);
+}
+
+
+
\ No newline at end of file

Added: modules/common/materials/programs/Torso_Pixel_Shader_2_glsl.source
===================================================================
--- modules/common/materials/programs/Torso_Pixel_Shader_2_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Torso_Pixel_Shader_2_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,59 @@
+//
+// Structure definitions
+//
+
+struct PS_INPUT {
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec4 Color;
+    vec4 SubColor;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform sampler2D baseMap;
+uniform sampler2D clothMap;
+
+//
+// Function declarations
+//
+
+vec4 ps_main( in PS_INPUT Input );
+
+//
+// Function definitions
+//
+
+vec4 ps_main( in PS_INPUT Input ) {
+    vec4 skin;
+    vec4 cloth;
+
+    skin = (texture2D( baseMap, Input.Texcoord) * vec4( Input.SubColor.xyz , 1.00000));
+    cloth = (texture2D( clothMap, Input.Texcoord2) * vec4( Input.Color.xyz , 1.00000));
+    return vec4( mix( skin.xyz , cloth.xyz , vec3( cloth.w )), (skin.w  + cloth.w ));
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    vec4 xlat_retVal;
+    PS_INPUT xlat_temp_Input;
+    xlat_temp_Input.Texcoord = vec2( gl_TexCoord[0]);
+    xlat_temp_Input.Texcoord1 = vec2( gl_TexCoord[1]);
+    xlat_temp_Input.Texcoord2 = vec2( gl_TexCoord[2]);
+    xlat_temp_Input.Color = vec4( gl_TexCoord[3]);
+    xlat_temp_Input.SubColor = vec4( gl_TexCoord[4]);
+
+    xlat_retVal = ps_main( xlat_temp_Input);
+
+    gl_FragData[0] = vec4( xlat_retVal);
+}
+
+
+
\ No newline at end of file

Added: modules/common/materials/programs/Torso_Pixel_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/Torso_Pixel_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Torso_Pixel_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,59 @@
+//
+// Structure definitions
+//
+
+struct PS_INPUT {
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec4 Color;
+    vec4 SubColor;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform sampler2D baseMap;
+uniform sampler2D clothMap;
+
+//
+// Function declarations
+//
+
+vec4 ps_main( in PS_INPUT Input );
+
+//
+// Function definitions
+//
+
+vec4 ps_main( in PS_INPUT Input ) {
+    vec4 skin;
+    vec4 cloth;
+
+    skin = (texture2D( baseMap, Input.Texcoord) * vec4( Input.SubColor.xyz , 1.00000));
+    cloth = (texture2D( clothMap, Input.Texcoord1) * vec4( Input.Color.xyz , 1.00000));
+    return vec4( mix( skin.xyz , cloth.xyz , vec3( cloth.w )), (skin.w  + cloth.w ));
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    vec4 xlat_retVal;
+    PS_INPUT xlat_temp_Input;
+    xlat_temp_Input.Texcoord = vec2( gl_TexCoord[0]);
+    xlat_temp_Input.Texcoord1 = vec2( gl_TexCoord[1]);
+    xlat_temp_Input.Texcoord2 = vec2( gl_TexCoord[2]);
+    xlat_temp_Input.Color = vec4( gl_TexCoord[3]);
+    xlat_temp_Input.SubColor = vec4( gl_TexCoord[4]);
+
+    xlat_retVal = ps_main( xlat_temp_Input);
+
+    gl_FragData[0] = vec4( xlat_retVal);
+}
+
+
+
\ No newline at end of file

Modified: modules/common/materials/programs/Torso_Vertex_Shader.material
===================================================================
--- modules/common/materials/programs/Torso_Vertex_Shader.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Torso_Vertex_Shader.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -22,16 +22,88 @@
 }
 
 
+fragment_program Torso_Pixel_Shader_glsl glsl
+{
+	source Torso_Pixel_Shader_glsl.source
+}
 
+fragment_program Torso_Pixel_Shader_2_glsl glsl
+{
+	source Torso_Pixel_Shader_2_glsl.source
+}
+
+vertex_program Torso_Vertex_Shader_glsl glsl
+{
+	source Torso_Vertex_Shader_glsl.source
+}
+
+
 material Torso_Vertex_Shader_Short
 {
-	technique
+	technique glsl
 	{
 		//Rendering Pass: Pass 0 (pass index: #0 )
 		pass
 		{
 			alpha_rejection greater 128
 			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Torso_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+				param_named clothMap int 1
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Torso_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0				
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				param_named subsurfcolor float4 0.8 0 0 1
+				param_named skincolor float4 0.5 0.5 0.5 1
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.25 0.25 0.25 1.0
+			}
+
+			texture_unit
+			{
+				texture_alias skin
+				//texture nat_felsen_01.dds 2d
+			}
+			
+			texture_unit
+			{
+				texture_alias cloth
+				//texture nat_felsen_01.dds 2d
+			}
+		}
+	}
+	
+	
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
 			fragment_program_ref Torso_Pixel_Shader
 			{
 			}

Added: modules/common/materials/programs/Torso_Vertex_Shader_glsl.source
===================================================================
--- modules/common/materials/programs/Torso_Vertex_Shader_glsl.source	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/common/materials/programs/Torso_Vertex_Shader_glsl.source	2007-08-07 09:21:23 UTC (rev 3670)
@@ -0,0 +1,167 @@
+//
+// Translator library functions
+//
+
+float xlat_lib_saturate( float x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec2 xlat_lib_saturate( vec2 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec3 xlat_lib_saturate( vec3 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+vec4 xlat_lib_saturate( vec4 x) {
+  return clamp( x, 0.0, 1.0);
+}
+
+mat2 xlat_lib_saturate(mat2 m) {
+  return mat2( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0));
+}
+
+mat3 xlat_lib_saturate(mat3 m) {
+  return mat3( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0));
+}
+
+mat4 xlat_lib_saturate(mat4 m) {
+  return mat4( clamp(m[0], 0.0, 1.0), clamp(m[1], 0.0, 1.0), clamp(m[2], 0.0, 1.0), clamp(m[3], 0.0, 1.0));
+}
+
+
+//
+// Structure definitions
+//
+
+struct VS_OUTPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec4 Color;
+    vec4 SubColor;
+};
+
+struct VS_INPUT {
+    vec4 Position;
+    vec2 Texcoord;
+    vec2 Texcoord1;
+    vec2 Texcoord2;
+    vec3 Normal;
+};
+
+
+//
+// Global variable definitions
+//
+
+uniform vec4 Light1_attenuation;
+uniform vec4 Light1_color;
+uniform vec4 Light1_position;
+uniform vec4 Light1_spec_power;
+uniform vec4 Light2_attenuation;
+uniform vec4 Light2_color;
+uniform vec4 Light2_position;
+uniform vec4 Light2_spec_power;
+uniform vec4 Light3_attenuation;
+uniform vec4 Light3_color;
+uniform vec4 Light3_position;
+uniform vec4 Light3_spec_power;
+uniform vec4 groundcolor;
+uniform mat4 matViewProjection;
+uniform vec4 skincolor;
+uniform vec4 skycolor;
+uniform vec4 subsurfcolor;
+uniform vec4 vViewPosition;
+
+//
+// Function declarations
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input );
+
+//
+// Function definitions
+//
+
+VS_OUTPUT vs_main( in VS_INPUT Input ) {
+    VS_OUTPUT Output;
+    vec3 LightDir;
+    float Dist;
+    float AngleAttn;
+    vec3 EyeVect;
+    vec3 HalfVect;
+    float SpecAttn;
+    float DistAttn;
+    float accDistAttn;
+    vec4 ambient;
+
+    Output.Color = vec4( 0.000000, 0.000000, 0.000000, 0.000000);
+    Output.Position = ( matViewProjection * Input.Position );
+    LightDir = vec3( (Light1_position - (Input.Position * Light1_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light1_color * Light1_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light1_attenuation.y  + (Light1_attenuation.z  * Dist)) + ((Light1_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light1_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn = DistAttn;
+    LightDir = vec3( (Light3_position - (Input.Position * Light3_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    EyeVect = vec3( normalize( (Input.Position - vViewPosition) ));
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light3_color * Light3_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light3_attenuation.y  + (Light3_attenuation.z  * Dist)) + ((Light3_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light3_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn += DistAttn;
+    LightDir = vec3( (Light2_position - (Input.Position * Light2_position.w )));
+    Dist = length( LightDir );
+    LightDir = (LightDir / Dist);
+    AngleAttn = xlat_lib_saturate( dot( Input.Normal, LightDir) );
+    HalfVect = normalize( (LightDir - EyeVect) );
+    SpecAttn = float( ((Light2_color * Light2_spec_power) * pow( clamp( dot( Input.Normal, HalfVect), 0.000000, 1.00000), 32.0000)));
+    DistAttn = clamp( (1.00000 / ((Light2_attenuation.y  + (Light2_attenuation.z  * Dist)) + ((Light2_attenuation.w  * Dist) * Dist))), 0.000000, 1.00000);
+    Output.Color += (((Light2_color * AngleAttn) + SpecAttn) * DistAttn);
+    accDistAttn += DistAttn;
+    Output.SubColor = mix( ((xlat_lib_saturate( accDistAttn ) * subsurfcolor) * Output.Color), Output.Color, xlat_lib_saturate( ((Output.Color * 3.00000) - 0.200000) ));
+    ambient = mix( skycolor, groundcolor, vec4( ((dot( Input.Normal, vec3( 0.000000, -1.00000, 0.000000)) + 1.00000) / 2.00000)));
+    Output.Color += ambient;
+    Output.SubColor += ambient;
+    Output.SubColor *= (skincolor + 0.500000);
+    Output.Texcoord = Input.Texcoord;
+    Output.Texcoord1 = Input.Texcoord1;
+    Output.Texcoord2 = Input.Texcoord2;
+    return Output;
+}
+
+
+//
+// Translator's entry point
+//
+void main() {
+    VS_OUTPUT xlat_retVal;
+    VS_INPUT xlat_temp_Input;
+    xlat_temp_Input.Position = vec4( gl_Vertex);
+    xlat_temp_Input.Texcoord = vec2( gl_MultiTexCoord0);
+    xlat_temp_Input.Texcoord1 = vec2( gl_MultiTexCoord1);
+    xlat_temp_Input.Texcoord2 = vec2( gl_MultiTexCoord2);
+    xlat_temp_Input.Normal = vec3( gl_Normal);
+
+    xlat_retVal = vs_main( xlat_temp_Input);
+
+    gl_Position = vec4( xlat_retVal.Position);
+    gl_TexCoord[0] = vec4( xlat_retVal.Texcoord, 0.0, 0.0);
+    gl_TexCoord[1] = vec4( xlat_retVal.Texcoord1, 0.0, 0.0);
+    gl_TexCoord[2] = vec4( xlat_retVal.Texcoord2, 0.0, 0.0);
+    gl_TexCoord[3] = vec4( xlat_retVal.Color);
+    gl_TexCoord[4] = vec4( xlat_retVal.SubColor);
+}
+
+
+
\ No newline at end of file

Modified: modules/ruchin/models/Ruchin_ground.material
===================================================================
--- modules/ruchin/models/Ruchin_ground.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/ruchin/models/Ruchin_ground.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -8,7 +8,8 @@
    set_texture_alias alpha       nat_steingrund_01.dds
    set_texture_alias Lightingmap Ligthingmap_default.png
    
-   technique
+   
+   technique glsl
    {
       pass
       {
@@ -37,4 +38,34 @@
          }
       }
    }
+   
+   technique hlsl
+   {
+      pass
+      {
+         fragment_program_ref
+         {
+            param_named scale_Detail4 float 0.050000 // Alpha
+         }
+
+         vertex_program_ref
+         {
+            param_named Light_Ambient float4 0.500000 0.500000 0.500000 1.000000
+
+            param_named scale_Texture0 float 0.58000 // Schwarz
+            param_named scale_Detail0 float 0.020000
+
+            param_named scale_Texture1 float 0.5700 // Rot
+            param_named scale_Detail1 float 1.00000
+
+            param_named scale_Texture2 float 0.28500 // Gruen
+            param_named scale_Detail2 float 0.60000
+
+            param_named scale_Texture3 float 0.88000 // Blau
+            param_named scale_Detail3 float 1.00000
+
+            param_named scale_Texture4 float 0.016000 // Alpha
+         }
+      }
+   }
 }

Modified: modules/ruchin/models/nat_grasplane_02.material
===================================================================
--- modules/ruchin/models/nat_grasplane_02.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/ruchin/models/nat_grasplane_02.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -1,64 +1,7 @@
 
 material nat_grasplanes_02: Basic_Vertex_Shader
 {
-	receive_shadows off
-	technique
-	{
-		//Rendering Pass: Pass 0 (pass index: #0 )
-		pass
-		{
-			alpha_rejection greater 128
-			//DirectX 9.0 HLSL Pixel Shader ps_2_0
-			fragment_program_ref Basic_Pixel_Shader
-			{
-			}
-			//DirectX 9.0 HLSL Vertex Shader vs_2_0
-			vertex_program_ref Basic_Vertex_Shader
-			{
-				// param_named_auto
 
-				param_named_auto Light1_attenuation light_attenuation 0
-				param_named_auto Light1_color light_diffuse_colour 0
-				param_named_auto Light1_position light_position_object_space 0
-				param_named Light1_spec_power float 0.3
-				
-				param_named_auto Light2_attenuation light_attenuation 1
-				param_named_auto Light2_color light_diffuse_colour 1
-				param_named_auto Light2_position light_position_object_space 1
-				param_named Light2_spec_power float 0.3
-				
-				param_named_auto Light3_attenuation light_attenuation 2
-				param_named_auto Light3_color light_diffuse_colour 2
-				param_named_auto Light3_position light_position_object_space 2
-				param_named Light3_spec_power float 0.3
-				
-				
-				param_named_auto matViewProjection worldviewproj_matrix
-				param_named_auto vViewPosition camera_position_object_space
-				
-				
-				param_named skycolor float4 1.0 1.0 1.0 1.0
-				param_named groundcolor float4 0.6 0.6 0.6 1.0
-			}
-			
-			texture_unit
-			{
-				texture gras_plane_02.dds
-
-			}
-		}
-	}
-
-	technique
-	{
-        pass
-        {
-            texture_unit
-            {
-                texture gras_plane_02.dds
-            }
-        }
-    }
+set_texture_alias diffuse gras_planes.dds
 }
-//set_texture_alias diffuse gras_planes.dds
 

Modified: modules/ruchin/models/ruchin_terrain.material
===================================================================
--- modules/ruchin/models/ruchin_terrain.material	2007-08-06 17:40:43 UTC (rev 3669)
+++ modules/ruchin/models/ruchin_terrain.material	2007-08-07 09:21:23 UTC (rev 3670)
@@ -9,7 +9,7 @@
    set_texture_alias alpha       nat_steingrund_01.dds
    set_texture_alias Lightingmap Ligthingmap_default.png
    
-   technique
+   technique glsl
    {
       pass
       {
@@ -38,4 +38,34 @@
          }
       }
    }
+   
+   technique hlsl
+   {
+      pass
+      {
+         fragment_program_ref
+         {
+            param_named scale_Detail4 float 0.050000 // Alpha
+         }
+
+         vertex_program_ref
+         {
+            param_named Light_Ambient float4 0.500000 0.500000 0.500000 1.000000
+
+            param_named scale_Texture0 float 0.018000 // Schwarz
+            param_named scale_Detail0 float 0.020000
+
+            param_named scale_Texture1 float 0.005700 // Rot
+            param_named scale_Detail1 float 0.100000
+
+            param_named scale_Texture2 float 0.028500 // Gruen
+            param_named scale_Detail2 float 0.060000
+
+            param_named scale_Texture3 float 0.008000 // Blau
+            param_named scale_Detail3 float 0.050000
+
+            param_named scale_Texture4 float 0.016000 // Alpha
+         }
+      }
+   }
 }
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000740.html">[Dsa-hl-svn] r3669 - rl/trunk/engine/core/src
</A></li>
	<LI>Next message: <A HREF="000742.html">[Dsa-hl-svn] r3671 - modules/common/materials/programs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#741">[ date ]</a>
              <a href="thread.html#741">[ thread ]</a>
              <a href="subject.html#741">[ subject ]</a>
              <a href="author.html#741">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
