<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r4008 - in rl/trunk/engine: common/include common/src	core/include core/src rules/src script/src script/swig ui	ui/include ui/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4008%20-%20in%20rl/trunk/engine%3A%20common/include%20common/src%0A%09core/include%20core/src%20rules/src%20script/src%20script/swig%20ui%0A%09ui/include%20ui/src&In-Reply-To=%3C200711241841.lAOIfF6f012668%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001078.html">
   <LINK REL="Next"  HREF="001080.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r4008 - in rl/trunk/engine: common/include common/src	core/include core/src rules/src script/src script/swig ui	ui/include ui/src</H1>
    <B>timm at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4008%20-%20in%20rl/trunk/engine%3A%20common/include%20common/src%0A%09core/include%20core/src%20rules/src%20script/src%20script/swig%20ui%0A%09ui/include%20ui/src&In-Reply-To=%3C200711241841.lAOIfF6f012668%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r4008 - in rl/trunk/engine: common/include common/src	core/include core/src rules/src script/src script/swig ui	ui/include ui/src">timm at mail.berlios.de
       </A><BR>
    <I>Sat Nov 24 19:41:15 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001078.html">[Dsa-hl-svn] r4007 - in modules/kanalisation: maps materials	materials/textures scripts
</A></li>
        <LI>Next message: <A HREF="001080.html">[Dsa-hl-svn] r4009 - in modules/common: gui/windows scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1079">[ date ]</a>
              <a href="thread.html#1079">[ thread ]</a>
              <a href="subject.html#1079">[ subject ]</a>
              <a href="author.html#1079">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: timm
Date: 2007-11-24 19:40:40 +0100 (Sat, 24 Nov 2007)
New Revision: 4008

Added:
   rl/trunk/engine/ui/include/GameSaveLoadWindow.h
   rl/trunk/engine/ui/include/MainMenuLoadWindow.h
   rl/trunk/engine/ui/src/GameSaveLoadWindow.cpp
   rl/trunk/engine/ui/src/MainMenuLoadWindow.cpp
Removed:
   rl/trunk/engine/ui/include/SaveLoadWindow.h
   rl/trunk/engine/ui/src/SaveLoadWindow.cpp
Modified:
   rl/trunk/engine/common/include/XmlPropertyReader.h
   rl/trunk/engine/common/src/XmlPropertyReader.cpp
   rl/trunk/engine/core/include/SaveGameManager.h
   rl/trunk/engine/core/src/SaveGameFileReader.cpp
   rl/trunk/engine/core/src/SaveGameManager.cpp
   rl/trunk/engine/rules/src/GameObjectManager.cpp
   rl/trunk/engine/rules/src/QuestBook.cpp
   rl/trunk/engine/script/src/TriggerFactory.cpp
   rl/trunk/engine/script/swig/RlUi.swig
   rl/trunk/engine/ui/RlUI2005.vcproj
   rl/trunk/engine/ui/include/MainMenuWindow.h
   rl/trunk/engine/ui/include/WindowFactory.h
   rl/trunk/engine/ui/src/MainMenuWindow.cpp
   rl/trunk/engine/ui/src/WindowFactory.cpp
Log:
- added load window to main menu
- in game mode: only the save games for the active module are shown

Modified: rl/trunk/engine/common/include/XmlPropertyReader.h
===================================================================
--- rl/trunk/engine/common/include/XmlPropertyReader.h	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/common/include/XmlPropertyReader.h	2007-11-24 18:40:40 UTC (rev 4008)
@@ -44,7 +44,7 @@
         PropertyEntry processProperty(XERCES_CPP_NAMESPACE::DOMElement* domElem) const;
 		PropertyEntry processProperty(XERCES_CPP_NAMESPACE::DOMAttr* domAttr) const;
 
-        virtual PropertyRecord getPropertiesAsSet(XERCES_CPP_NAMESPACE::DOMElement* parent);
+        virtual PropertyRecord getPropertiesAsRecord(XERCES_CPP_NAMESPACE::DOMElement* parent);
     private:
         std::vector&lt;PropertyRecord*&gt; mPropertyRecords;
 

Modified: rl/trunk/engine/common/src/XmlPropertyReader.cpp
===================================================================
--- rl/trunk/engine/common/src/XmlPropertyReader.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/common/src/XmlPropertyReader.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -241,7 +241,7 @@
     return std::make_pair(key, prop);
 }
 
-PropertyRecord XmlPropertyReader::getPropertiesAsSet(DOMElement *parent)
+PropertyRecord XmlPropertyReader::getPropertiesAsRecord(DOMElement *parent)
 {
     PropertyRecord ps;
 

Modified: rl/trunk/engine/core/include/SaveGameManager.h
===================================================================
--- rl/trunk/engine/core/include/SaveGameManager.h	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/core/include/SaveGameManager.h	2007-11-24 18:40:40 UTC (rev 4008)
@@ -36,13 +36,19 @@
         //Events
         RLMSG_SAVEGAME_LOADED     = 0x0300001,
         RLMSG_SAVEGAME_SAVED      = 0x0300002,
-        RLMSG_SAVEGAME_GOS_LOADED = 0x3000003
+        RLMSG_SAVEGAME_LOADING    = 0x0300003,
+        RLMSG_SAVEGAME_SAVING     = 0x0300004,
+        RLMSG_SAVEGAME_GOS_LOADED = 0x0300011       
     };
 
     typedef MessageType&lt;RLMSG_SAVEGAME_LOADED&gt; MessageType_SaveGameLoaded;
 
     typedef MessageType&lt;RLMSG_SAVEGAME_SAVED&gt; MessageType_SaveGameSaved;
 
+    typedef MessageType&lt;RLMSG_SAVEGAME_LOADING&gt; MessageType_SaveGameLoading;
+
+    typedef MessageType&lt;RLMSG_SAVEGAME_SAVING&gt; MessageType_SaveGameSaving;
+
     class _RlCoreExport SaveGameData
     {
     public:

Modified: rl/trunk/engine/core/src/SaveGameFileReader.cpp
===================================================================
--- rl/trunk/engine/core/src/SaveGameFileReader.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/core/src/SaveGameFileReader.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -76,7 +76,7 @@
                          }
                      }
                  }*/
-                 PropertyRecord set = getPropertiesAsSet(elem);
+                 PropertyRecord set = getPropertiesAsRecord(elem);
                  file-&gt;setProperties(&amp;set);
              }
         }

Modified: rl/trunk/engine/core/src/SaveGameManager.cpp
===================================================================
--- rl/trunk/engine/core/src/SaveGameManager.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/core/src/SaveGameManager.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -97,8 +97,8 @@
         time(&amp;rawTime);
         localTime = localtime(&amp;rawTime); 
         SaveGameFile* file = new SaveGameFile(name);
-        file-&gt;setProperty(&quot;Time&quot;, Property(printTimeAsString(localTime)));
-        file-&gt;setProperty(&quot;ModuleID&quot;, Property(CoreSubsystem::getSingleton().getActiveAdventureModule()-&gt;getName()));
+        file-&gt;setProperty(SaveGameFile::PROPERTY_TIME, Property(printTimeAsString(localTime)));
+        file-&gt;setProperty(SaveGameFile::PROPERTY_MODULEID, Property(CoreSubsystem::getSingleton().getActiveAdventureModule()-&gt;getName()));
 
         mSaveGames[name] = file;
 

Modified: rl/trunk/engine/rules/src/GameObjectManager.cpp
===================================================================
--- rl/trunk/engine/rules/src/GameObjectManager.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/rules/src/GameObjectManager.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -340,7 +340,7 @@
                         int ID = reader-&gt;getAttributeValueAsInteger(static_cast&lt;DOMElement*&gt;(xmlGameObject), &quot;ID&quot;);
                         Ogre::String classID = reader-&gt;getAttributeValueAsStdString(static_cast&lt;DOMElement*&gt;(xmlGameObject), &quot;ClassID&quot;);
                         GameObjectState state = (GameObjectState)reader-&gt;getAttributeValueAsInteger(static_cast&lt;DOMElement*&gt;(xmlGameObject), &quot;State&quot;);
-                        PropertyRecord properties = reader-&gt;getPropertiesAsSet(static_cast&lt;DOMElement*&gt;(xmlGameObject));
+                        PropertyRecord properties = reader-&gt;getPropertiesAsRecord(static_cast&lt;DOMElement*&gt;(xmlGameObject));
                         GameObject* object = createGameObject(classID, ID);
                         
                         applyProperties(object, &amp;properties); 

Modified: rl/trunk/engine/rules/src/QuestBook.cpp
===================================================================
--- rl/trunk/engine/rules/src/QuestBook.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/rules/src/QuestBook.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -289,7 +289,7 @@
         if(rootNodeList-&gt;getLength())
         {
             DOMNode* xmlQuestBook = rootNodeList-&gt;item(0);
-            PropertyRecord properties = reader-&gt;getPropertiesAsSet(static_cast&lt;DOMElement*&gt;(xmlQuestBook));
+            PropertyRecord properties = reader-&gt;getPropertiesAsRecord(static_cast&lt;DOMElement*&gt;(xmlQuestBook));
 
             setProperties(&amp;properties);
         }

Modified: rl/trunk/engine/script/src/TriggerFactory.cpp
===================================================================
--- rl/trunk/engine/script/src/TriggerFactory.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/script/src/TriggerFactory.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -116,7 +116,7 @@
                         Ogre::String name = reader-&gt;getAttributeValueAsStdString(static_cast&lt;DOMElement*&gt;(xmlTrigger), &quot;name&quot;);
                         Ogre::String zoneName = reader-&gt;getAttributeValueAsStdString(static_cast&lt;DOMElement*&gt;(xmlTrigger), &quot;zone&quot;);
 
-                        PropertyRecord properties = reader-&gt;getPropertiesAsSet(static_cast&lt;DOMElement*&gt;(xmlTrigger));
+                        PropertyRecord properties = reader-&gt;getPropertiesAsRecord(static_cast&lt;DOMElement*&gt;(xmlTrigger));
 
 
                         Trigger *trigger = createTrigger(classname, name);

Modified: rl/trunk/engine/script/swig/RlUi.swig
===================================================================
--- rl/trunk/engine/script/swig/RlUi.swig	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/script/swig/RlUi.swig	2007-11-24 18:40:40 UTC (rev 4008)
@@ -102,7 +102,7 @@
     void showContainerContent(rl::Container* container);
     void showDescriptionWindow(rl::GameObject* obj);
     void showPropertiesWindow(rl::GameObject* obj);
-    void showSaveLoadWindow();
+    void showGameSaveLoadWindow();
     void showExitConfirmation();
     void showJournalWindow();
     void showLogfiles();

Modified: rl/trunk/engine/ui/RlUI2005.vcproj
===================================================================
--- rl/trunk/engine/ui/RlUI2005.vcproj	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/RlUI2005.vcproj	2007-11-24 18:40:40 UTC (rev 4008)
@@ -464,6 +464,10 @@
 					&gt;
 				&lt;/File&gt;
 				&lt;File
+					RelativePath=&quot;.\include\GameSaveLoadWindow.h&quot;
+					&gt;
+				&lt;/File&gt;
+				&lt;File
 					RelativePath=&quot;.\include\GameSettings.h&quot;
 					&gt;
 				&lt;/File&gt;
@@ -508,6 +512,10 @@
 					&gt;
 				&lt;/File&gt;
 				&lt;File
+					RelativePath=&quot;.\include\MainMenuLoadWindow.h&quot;
+					&gt;
+				&lt;/File&gt;
+				&lt;File
 					RelativePath=&quot;.\include\MainMenuWindow.h&quot;
 					&gt;
 				&lt;/File&gt;
@@ -536,10 +544,6 @@
 					&gt;
 				&lt;/File&gt;
 				&lt;File
-					RelativePath=&quot;.\include\SaveLoadWindow.h&quot;
-					&gt;
-				&lt;/File&gt;
-				&lt;File
 					RelativePath=&quot;.\include\SoundConfig.h&quot;
 					&gt;
 				&lt;/File&gt;
@@ -693,6 +697,10 @@
 					&gt;
 				&lt;/File&gt;
 				&lt;File
+					RelativePath=&quot;.\src\GameSaveLoadWindow.cpp&quot;
+					&gt;
+				&lt;/File&gt;
+				&lt;File
 					RelativePath=&quot;.\src\GameSettings.cpp&quot;
 					&gt;
 				&lt;/File&gt;
@@ -737,6 +745,10 @@
 					&gt;
 				&lt;/File&gt;
 				&lt;File
+					RelativePath=&quot;.\src\MainMenuLoadWindow.cpp&quot;
+					&gt;
+				&lt;/File&gt;
+				&lt;File
 					RelativePath=&quot;.\src\MainMenuWindow.cpp&quot;
 					&gt;
 				&lt;/File&gt;
@@ -765,10 +777,6 @@
 					&gt;
 				&lt;/File&gt;
 				&lt;File
-					RelativePath=&quot;.\src\SaveLoadWindow.cpp&quot;
-					&gt;
-				&lt;/File&gt;
-				&lt;File
 					RelativePath=&quot;.\src\SoundConfig.cpp&quot;
 					&gt;
 				&lt;/File&gt;

Added: rl/trunk/engine/ui/include/GameSaveLoadWindow.h
===================================================================
--- rl/trunk/engine/ui/include/GameSaveLoadWindow.h	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/include/GameSaveLoadWindow.h	2007-11-24 18:40:40 UTC (rev 4008)
@@ -0,0 +1,70 @@
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2007 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ * 
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+
+/**
+ * \file GameSaveLoadWindow.h
+ *
+ * Declaration of the Save/Load dialog
+ */
+
+#ifndef __GameSaveLoadWindow_H__
+#define __GameSaveLoadWindow_H__
+
+#include &quot;UiPrerequisites.h&quot;
+#include &quot;AbstractWindow.h&quot;
+
+namespace rl {
+
+    /**
+     * The Save/Load window class
+     *
+     * This window is a dialog to save and load the game.
+     */
+    class _RlUiExport GameSaveLoadWindow : public AbstractWindow
+    {
+    public:
+
+        /**
+         * Constructor of the GameObject window
+         */
+        GameSaveLoadWindow();
+        
+        /**
+         * Destructor of the GameObject window
+         */
+        virtual ~GameSaveLoadWindow();
+
+        /**
+         * Initializes the window with the specified game object and
+         * fills the window with the properties of the GameObject.
+         *
+         * @param object The GameObject to be displayed
+         */
+        virtual void initialize();
+        
+    private:
+        bool handleLoadEvent();
+        bool handleSaveEvent();
+        bool handleDeleteEvent();
+
+        void listSaveGames();
+        
+        CEGUI::MultiColumnList     *mSaveGameTable;     //!&lt; SaveGame table
+        CEGUI::Editbox             *mFilename;         //!&lt; Filename for the savegame 
+    };
+}
+
+#endif

Added: rl/trunk/engine/ui/include/MainMenuLoadWindow.h
===================================================================
--- rl/trunk/engine/ui/include/MainMenuLoadWindow.h	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/include/MainMenuLoadWindow.h	2007-11-24 18:40:40 UTC (rev 4008)
@@ -0,0 +1,71 @@
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2007 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ * 
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+
+/**
+ * \file MainMenuLoadWindow.h
+ *
+ * Declaration of the Save/Load dialog
+ */
+
+#ifndef __MainMenuLoadWindow_H__
+#define __MainMenuLoadWindow_H__
+
+#include &quot;UiPrerequisites.h&quot;
+#include &quot;AbstractWindow.h&quot;
+
+namespace rl {
+
+    /**
+     * The Save/Load window class
+     *
+     * This window is a dialog to save and load the game.
+     */
+    class _RlUiExport MainMenuLoadWindow : public AbstractWindow
+    {
+    public:
+
+        /**
+         * Constructor of the GameObject window
+         */
+        MainMenuLoadWindow();
+        
+        /**
+         * Destructor of the GameObject window
+         */
+        virtual ~MainMenuLoadWindow();
+
+        /**
+         * Initializes the window with the specified game object and
+         * fills the window with the properties of the GameObject.
+         *
+         * @param object The GameObject to be displayed
+         */
+        virtual void initialize();
+        
+    private:
+        bool handleLoadEvent();
+        bool handleSaveEvent();
+        bool handleDeleteEvent();
+        bool handleSelectSaveGame();
+
+        void listSaveGames();
+        
+        CEGUI::MultiColumnList     *mSaveGameTable;     //!&lt; SaveGame table
+        CEGUI::Editbox             *mFilename;         //!&lt; Filename for the savegame 
+    };
+}
+
+#endif

Modified: rl/trunk/engine/ui/include/MainMenuWindow.h
===================================================================
--- rl/trunk/engine/ui/include/MainMenuWindow.h	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/include/MainMenuWindow.h	2007-11-24 18:40:40 UTC (rev 4008)
@@ -37,6 +37,7 @@
 	private:
 		bool handleChooseModule(CEGUI::MenuItem* it, ContentModule* module);
 		bool handleStart();
+        bool handleLoad();
 		bool handleQuit();
 		bool handleSettings();
 

Deleted: rl/trunk/engine/ui/include/SaveLoadWindow.h
===================================================================
--- rl/trunk/engine/ui/include/SaveLoadWindow.h	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/include/SaveLoadWindow.h	2007-11-24 18:40:40 UTC (rev 4008)
@@ -1,70 +0,0 @@
-/* This source file is part of Rastullahs Lockenpracht.
- * Copyright (C) 2003-2007 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
- * 
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the Clarified Artistic License.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  Clarified Artistic License for more details.
- *
- *  You should have received a copy of the Clarified Artistic License
- *  along with this program; if not you can get it here
- *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
- */
-
-/**
- * \file SaveLoadWindow.h
- *
- * Declaration of the Save/Load dialog
- */
-
-#ifndef __SaveLoadWindow_H__
-#define __SaveLoadWindow_H__
-
-#include &quot;UiPrerequisites.h&quot;
-#include &quot;AbstractWindow.h&quot;
-
-namespace rl {
-
-    /**
-     * The Save/Load window class
-     *
-     * This window is a dialog to save and load the game.
-     */
-    class _RlUiExport SaveLoadWindow : public AbstractWindow
-    {
-    public:
-
-        /**
-         * Constructor of the GameObject window
-         */
-        SaveLoadWindow();
-        
-        /**
-         * Destructor of the GameObject window
-         */
-        virtual ~SaveLoadWindow();
-
-        /**
-         * Initializes the window with the specified game object and
-         * fills the window with the properties of the GameObject.
-         *
-         * @param object The GameObject to be displayed
-         */
-        virtual void initialize();
-        
-    private:
-        bool handleLoadEvent();
-        bool handleSaveEvent();
-        bool handleDeleteEvent();
-
-        void listSaveGames();
-        
-        CEGUI::MultiColumnList     *mSaveGameTable;     //!&lt; SaveGame table
-        CEGUI::Editbox             *mFilename;         //!&lt; Filename for the savegame 
-    };
-}
-
-#endif

Modified: rl/trunk/engine/ui/include/WindowFactory.h
===================================================================
--- rl/trunk/engine/ui/include/WindowFactory.h	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/include/WindowFactory.h	2007-11-24 18:40:40 UTC (rev 4008)
@@ -54,7 +54,8 @@
     class MainMenuWindow;
     class ObjectDescriptionWindow;
     class Person;
-    class SaveLoadWindow;
+    class GameSaveLoadWindow;
+    class MainMenuLoadWindow;
     class WindowUpdater;
 
     class _RlUiExport WindowFactory : public Ogre::Singleton&lt;WindowFactory&gt;
@@ -88,7 +89,8 @@
         void showMainMenu();
         void showObjectDescription(GameObject* object);
         void showPlaylist();
-        void showSaveLoadWindow();
+        void showGameSaveLoadWindow();
+        void showMainMenuLoadWindow();
         void showPopupMessage(int popupTypes);
         /**
          * Creates a GameSettings object and displays its layout file on screen

Added: rl/trunk/engine/ui/src/GameSaveLoadWindow.cpp
===================================================================
--- rl/trunk/engine/ui/src/GameSaveLoadWindow.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/src/GameSaveLoadWindow.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -0,0 +1,184 @@
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2007 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+#include &quot;stdinc.h&quot; //precompiled header
+
+/**
+ * \file GameSaveLoadWindow.cpp
+ *
+ * Implementation of the Save/Load dialog
+ */
+
+#include &lt;boost/bind.hpp&gt;
+#include &lt;CEGUIWindowManager.h&gt;
+#include &lt;elements/CEGUIListboxTextItem.h&gt;
+#include &lt;Exception.h&gt;
+#include &lt;GameObjectManager.h&gt;
+#include &lt;GameObject.h&gt;
+#include &lt;Actor.h&gt;
+#include &lt;OgreResourceGroupManager.h&gt;
+
+#include &quot;GameSaveLoadWindow.h&quot;
+#include &quot;MessageWindow.h&quot;
+#include &quot;WindowFactory.h&quot;
+#include &quot;ConfigurationManager.h&quot;
+#include &quot;SaveGameManager.h&quot;
+#include &quot;CoreSubsystem.h&quot;
+#include &quot;ContentModule.h&quot;
+
+using namespace CEGUI;
+
+namespace rl {
+
+    //------------------------------------------------------- Constructor
+
+    GameSaveLoadWindow::GameSaveLoadWindow() :
+        AbstractWindow(&quot;gamesaveloadwindow.xml&quot;, WIT_MOUSE_INPUT | WIT_KEYBOARD_INPUT)
+    {
+        // Get a access to the filename edit box
+        mFilename = getEditbox(&quot;GameSaveLoadWindow/FileSheet/Filename&quot;);
+        RlAssert(mFilename != NULL, &quot;GameSaveLoadWindow/FileSheet/Filename is null&quot;);
+
+        mFilename-&gt;activate();
+
+        // Get a access to the savegame table
+        mSaveGameTable = getMultiColumnList(&quot;GameSaveLoadWindow/FileSheet/SaveGameTable&quot;);
+        RlAssert(mSaveGameTable != NULL, &quot;GameSaveLoadWindow/FileSheet/SaveGameTable is null&quot;);
+
+        mSaveGameTable-&gt;addColumn( (utf8*)&quot;Filename&quot;, 0, cegui_reldim(0.7));
+        mSaveGameTable-&gt;addColumn( (utf8*)&quot;Date&quot;, 1, cegui_reldim(0.3));
+
+        centerWindow();
+
+        getPushButton(&quot;GameSaveLoadWindow/ButtonSheet/LoadButton&quot;)-&gt;subscribeEvent(
+        CEGUI::Window::EventMouseClick,
+        boost::bind(
+            &amp;GameSaveLoadWindow::handleLoadEvent,
+            this
+        ));
+
+        getPushButton(&quot;GameSaveLoadWindow/ButtonSheet/SaveButton&quot;)-&gt;subscribeEvent(
+        CEGUI::Window::EventMouseClick,
+        boost::bind(
+            &amp;GameSaveLoadWindow::handleSaveEvent,
+            this
+        ));
+
+        getPushButton(&quot;GameSaveLoadWindow/ButtonSheet/DeleteButton&quot;)-&gt;subscribeEvent(
+        CEGUI::Window::EventMouseClick,
+        boost::bind(
+            &amp;GameSaveLoadWindow::handleDeleteEvent,
+            this
+        ));
+
+        bindDestroyWindowToXButton();
+        bindDestroyWindowToClick(getWindow(&quot;GameSaveLoadWindow/ButtonSheet/CancelButton&quot;));
+
+    }
+
+    //------------------------------------------------------- Destructor
+
+    GameSaveLoadWindow::~GameSaveLoadWindow()
+    {
+    }
+
+    //------------------------------------------------------- initialize
+
+    void GameSaveLoadWindow::initialize()
+    {
+        //mSaveGameTable-&gt;autoSizeColumnHeader(0);
+        //mSaveGameTable-&gt;autoSizeColumnHeader(1);
+        listSaveGames();
+    }
+
+    //------------------------------------------------------- LoadEvent
+
+    bool GameSaveLoadWindow::handleLoadEvent()
+    {
+        LOG_MESSAGE(Logger::UI, &quot;Load Button pressed&quot;);
+
+        CeGuiString filename = mFilename-&gt;getText();
+
+        if(filename != &quot;&quot;)
+        {
+
+            if(SaveGameManager::getSingleton().SaveGameFileExists(filename))
+                SaveGameManager::getSingleton().loadSaveGameFile(filename);
+            else
+            {
+                LOG_ERROR(Logger::UI, &quot;Save Game &quot; + filename + &quot; doesn't exist!&quot;);
+                WindowFactory::getSingleton().showMessageWindow(&quot;Der Spielstand existiert nicht&quot;);
+            }
+        }
+
+        return true;
+    }
+
+    //------------------------------------------------------- SaveEvent
+
+    bool GameSaveLoadWindow::handleSaveEvent()
+    {
+        LOG_MESSAGE(Logger::UI, &quot;Save Button pressed&quot;);
+
+        CeGuiString filename = mFilename-&gt;getText();
+
+        if(filename != &quot;&quot;)
+        {
+            LOG_MESSAGE(Logger::UI, &quot;Create a SaveGameFile&quot;);
+
+            SaveGameManager::getSingleton().saveSaveGameFile(filename);
+
+            LOG_MESSAGE(Logger::UI, &quot;Created save game&quot;);
+        }
+        else
+        {
+            WindowFactory::getSingleton().showMessageWindow(&quot;Bitte einen Namen f&#252;r den Spielstand eingeben&quot;);
+        }
+
+        listSaveGames();
+
+        return true;
+    }
+
+    //------------------------------------------------------- DeleteEvent
+
+    bool GameSaveLoadWindow::handleDeleteEvent()
+    {
+        LOG_MESSAGE(Logger::UI, &quot;Delete Button pressed&quot;);
+        return true;
+    }
+
+    void GameSaveLoadWindow::listSaveGames()
+    {
+        SaveGameEntryMap saveGames = SaveGameManager::getSingleton().listSaveGames(CoreSubsystem::getSingleton().getActiveAdventureModule()-&gt;getName());
+    
+        while(mSaveGameTable-&gt;getRowCount() &gt; saveGames.size())
+		    mSaveGameTable-&gt;removeRow(mSaveGameTable-&gt;getRowCount()-1);
+        while(mSaveGameTable-&gt;getRowCount() &lt; saveGames.size())
+		    mSaveGameTable-&gt;addRow();
+        
+        int saveGameNum = 0;
+
+        for(SaveGameEntryMap::iterator it = saveGames.begin(); it != saveGames.end(); it++)
+        {
+            mSaveGameTable-&gt;setItem(new CEGUI::ListboxTextItem(it-&gt;first), 0, saveGameNum);
+            mSaveGameTable-&gt;setItem(new CEGUI::ListboxTextItem(it-&gt;second-&gt;getProperty(SaveGameFile::PROPERTY_TIME)), 1, saveGameNum);
+            saveGameNum++;
+        }
+        //mSaveGameTable-&gt;autoSizeColumnHeader(0);
+        //mSaveGameTable-&gt;autoSizeColumnHeader(1);
+    }
+
+} // namespace rl

Added: rl/trunk/engine/ui/src/MainMenuLoadWindow.cpp
===================================================================
--- rl/trunk/engine/ui/src/MainMenuLoadWindow.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/src/MainMenuLoadWindow.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -0,0 +1,198 @@
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2007 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+#include &quot;stdinc.h&quot; //precompiled header
+
+/**
+ * \file MainMenuLoadWindow.cpp
+ *
+ * Implementation of the Save/Load dialog
+ */
+
+#include &lt;boost/bind.hpp&gt;
+#include &lt;CEGUIWindowManager.h&gt;
+#include &lt;elements/CEGUIListboxTextItem.h&gt;
+#include &lt;Exception.h&gt;
+#include &lt;GameObjectManager.h&gt;
+#include &lt;GameObject.h&gt;
+#include &lt;Actor.h&gt;
+#include &lt;OgreResourceGroupManager.h&gt;
+
+#include &quot;MainMenuLoadWindow.h&quot;
+#include &quot;MessageWindow.h&quot;
+#include &quot;WindowFactory.h&quot;
+#include &quot;ConfigurationManager.h&quot;
+#include &quot;SaveGameManager.h&quot;
+#include &quot;CoreSubsystem.h&quot;
+#include &quot;ContentModule.h&quot;
+
+using namespace CEGUI;
+
+namespace rl {
+
+    //------------------------------------------------------- Constructor
+
+    MainMenuLoadWindow::MainMenuLoadWindow() :
+        AbstractWindow(&quot;mainmenuloadwindow.xml&quot;, WIT_MOUSE_INPUT | WIT_KEYBOARD_INPUT)
+    {
+        // Get a access to the filename edit box
+        mFilename = getEditbox(&quot;MainMenuLoadWindow/FileSheet/Filename&quot;);
+        RlAssert(mFilename != NULL, &quot;MainMenuLoadWindow/FileSheet/Filename is null&quot;);
+
+        mFilename-&gt;activate();
+
+        // Get a access to the savegame table
+        mSaveGameTable = getMultiColumnList(&quot;MainMenuLoadWindow/FileSheet/SaveGameTable&quot;);
+        RlAssert(mSaveGameTable != NULL, &quot;MainMenuLoadWindow/FileSheet/SaveGameTable is null&quot;);
+
+        mSaveGameTable-&gt;addColumn( (utf8*)&quot;Filename&quot;, 0, cegui_reldim(0.6));
+        mSaveGameTable-&gt;addColumn( (utf8*)&quot;Module&quot;, 1, cegui_reldim(0.2));
+        mSaveGameTable-&gt;addColumn( (utf8*)&quot;Date&quot;, 2, cegui_reldim(0.2));
+
+        mSaveGameTable-&gt;setSelectionMode(MultiColumnList::RowSingle);
+        mSaveGameTable-&gt;subscribeEvent(MultiColumnList::EventSelectionChanged, boost::bind(&amp;MainMenuLoadWindow::handleSelectSaveGame, this));
+
+        centerWindow();
+
+        getPushButton(&quot;MainMenuLoadWindow/ButtonSheet/LoadButton&quot;)-&gt;subscribeEvent(
+        CEGUI::Window::EventMouseClick,
+        boost::bind(
+            &amp;MainMenuLoadWindow::handleLoadEvent,
+            this
+        ));
+
+        getPushButton(&quot;MainMenuLoadWindow/ButtonSheet/SaveButton&quot;)-&gt;subscribeEvent(
+        CEGUI::Window::EventMouseClick,
+        boost::bind(
+            &amp;MainMenuLoadWindow::handleSaveEvent,
+            this
+        ));
+
+        getPushButton(&quot;MainMenuLoadWindow/ButtonSheet/DeleteButton&quot;)-&gt;subscribeEvent(
+        CEGUI::Window::EventMouseClick,
+        boost::bind(
+            &amp;MainMenuLoadWindow::handleDeleteEvent,
+            this
+        ));
+
+        bindDestroyWindowToXButton();
+        bindDestroyWindowToClick(getWindow(&quot;MainMenuLoadWindow/ButtonSheet/CancelButton&quot;));
+
+    }
+
+    //------------------------------------------------------- Destructor
+
+    MainMenuLoadWindow::~MainMenuLoadWindow()
+    {
+    }
+
+    //------------------------------------------------------- initialize
+
+    void MainMenuLoadWindow::initialize()
+    {
+        //mSaveGameTable-&gt;autoSizeColumnHeader(0);
+        //mSaveGameTable-&gt;autoSizeColumnHeader(1);
+        listSaveGames();
+    }
+
+    //------------------------------------------------------- LoadEvent
+
+    bool MainMenuLoadWindow::handleLoadEvent()
+    {
+        LOG_MESSAGE(Logger::UI, &quot;Load Button pressed&quot;);
+
+        CeGuiString filename = mFilename-&gt;getText();
+
+        if(filename != &quot;&quot;)
+        {
+
+            if(SaveGameManager::getSingleton().SaveGameFileExists(filename))
+                SaveGameManager::getSingleton().loadSaveGameFile(filename);
+            else
+            {
+                LOG_ERROR(Logger::UI, &quot;Save Game &quot; + filename + &quot; doesn't exist!&quot;);
+                WindowFactory::getSingleton().showMessageWindow(&quot;Der Spielstand existiert nicht&quot;);
+            }
+        }
+
+        return true;
+    }
+
+    //------------------------------------------------------- SaveEvent
+
+    bool MainMenuLoadWindow::handleSaveEvent()
+    {
+        LOG_MESSAGE(Logger::UI, &quot;Save Button pressed&quot;);
+
+        CeGuiString filename = mFilename-&gt;getText();
+
+        if(filename != &quot;&quot;)
+        {
+            LOG_MESSAGE(Logger::UI, &quot;Create a SaveGameFile&quot;);
+
+            SaveGameManager::getSingleton().saveSaveGameFile(filename);
+
+            LOG_MESSAGE(Logger::UI, &quot;Created save game&quot;);
+        }
+        else
+        {
+            WindowFactory::getSingleton().showMessageWindow(&quot;Bitte einen Namen f&#252;r den Spielstand eingeben&quot;);
+        }
+
+        listSaveGames();
+
+        return true;
+    }
+
+    //------------------------------------------------------- DeleteEvent
+
+    bool MainMenuLoadWindow::handleDeleteEvent()
+    {
+        LOG_MESSAGE(Logger::UI, &quot;Delete Button pressed&quot;);
+        return true;
+    }
+
+    void MainMenuLoadWindow::listSaveGames()
+    {
+        SaveGameEntryMap saveGames = SaveGameManager::getSingleton().listSaveGames();
+
+        while(mSaveGameTable-&gt;getRowCount() &gt; saveGames.size())
+		    mSaveGameTable-&gt;removeRow(mSaveGameTable-&gt;getRowCount()-1);
+        while(mSaveGameTable-&gt;getRowCount() &lt; saveGames.size())
+		    mSaveGameTable-&gt;addRow();
+        
+        int saveGameNum = 0;
+
+        for(SaveGameEntryMap::iterator it = saveGames.begin(); it != saveGames.end(); it++)
+        {
+            mSaveGameTable-&gt;setItem(new CEGUI::ListboxTextItem(it-&gt;first), 0, saveGameNum);
+            mSaveGameTable-&gt;setItem(new CEGUI::ListboxTextItem(it-&gt;second-&gt;getProperty(SaveGameFile::PROPERTY_MODULEID).toString()), 1, saveGameNum);
+            LOG_MESSAGE(Logger::UI, &quot;Module ID: &quot; + it-&gt;second-&gt;getProperty(SaveGameFile::PROPERTY_MODULEID).toString());
+            mSaveGameTable-&gt;setItem(new CEGUI::ListboxTextItem(it-&gt;second-&gt;getProperty(SaveGameFile::PROPERTY_TIME).toString()), 2, saveGameNum);
+            saveGameNum++;
+        }
+        /*mSaveGameTable-&gt;autoSizeColumnHeader(0);
+        mSaveGameTable-&gt;autoSizeColumnHeader(1);
+        mSaveGameTable-&gt;autoSizeColumnHeader(2);*/
+    }
+
+    bool MainMenuLoadWindow::handleSelectSaveGame()
+    {
+        if(mSaveGameTable-&gt;getFirstSelectedItem())
+            mFilename-&gt;setText(mSaveGameTable-&gt;getFirstSelectedItem()-&gt;getText());
+        return true;
+    }
+
+} // namespace rl

Modified: rl/trunk/engine/ui/src/MainMenuWindow.cpp
===================================================================
--- rl/trunk/engine/ui/src/MainMenuWindow.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/src/MainMenuWindow.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -41,6 +41,10 @@
 			MenuItem::EventClicked,
 			boost::bind(&amp;MainMenuWindow::handleStart, this));
 
+        getWindow(&quot;MainMenu/Game/Load&quot;)-&gt;subscribeEvent(
+			MenuItem::EventClicked,
+			boost::bind(&amp;MainMenuWindow::handleLoad, this));
+
 		getWindow(&quot;MainMenu/Game/Quit&quot;)-&gt;subscribeEvent(
 			MenuItem::EventClicked,
 			boost::bind(&amp;MainMenuWindow::handleQuit, this));
@@ -120,11 +124,15 @@
 		setVisible(false);
 		destroyWindow();
 		CoreSubsystem::getSingleton().startAdventureModule(mActiveModule);
-
-        this-&gt;setVisible( false );
 		return true;
 	}
 
+    bool MainMenuWindow::handleLoad()
+    {
+        WindowFactory::getSingleton().showMainMenuLoadWindow();
+        return true;
+    }
+
 	bool MainMenuWindow::handleQuit()
 	{
 		WindowFactory::getSingleton().showExitConfirmation();

Deleted: rl/trunk/engine/ui/src/SaveLoadWindow.cpp
===================================================================
--- rl/trunk/engine/ui/src/SaveLoadWindow.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/src/SaveLoadWindow.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -1,182 +0,0 @@
-/* This source file is part of Rastullahs Lockenpracht.
- * Copyright (C) 2003-2007 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the Clarified Artistic License.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  Clarified Artistic License for more details.
- *
- *  You should have received a copy of the Clarified Artistic License
- *  along with this program; if not you can get it here
- *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
- */
-#include &quot;stdinc.h&quot; //precompiled header
-
-/**
- * \file SaveLoadWindow.cpp
- *
- * Implementation of the Save/Load dialog
- */
-
-#include &lt;boost/bind.hpp&gt;
-#include &lt;CEGUIWindowManager.h&gt;
-#include &lt;elements/CEGUIListboxTextItem.h&gt;
-#include &lt;Exception.h&gt;
-#include &lt;GameObjectManager.h&gt;
-#include &lt;GameObject.h&gt;
-#include &lt;Actor.h&gt;
-#include &lt;OgreResourceGroupManager.h&gt;
-
-#include &quot;SaveLoadWindow.h&quot;
-#include &quot;MessageWindow.h&quot;
-#include &quot;WindowFactory.h&quot;
-#include &quot;ConfigurationManager.h&quot;
-#include &quot;SaveGameManager.h&quot;
-
-using namespace CEGUI;
-
-namespace rl {
-
-    //------------------------------------------------------- Constructor
-
-    SaveLoadWindow::SaveLoadWindow() :
-        AbstractWindow(&quot;saveloadwindow.xml&quot;, WIT_MOUSE_INPUT | WIT_KEYBOARD_INPUT)
-    {
-        // Get a access to the filename edit box
-        mFilename = getEditbox(&quot;SaveLoadWindow/FileSheet/Filename&quot;);
-        RlAssert(mFilename != NULL, &quot;SaveLoadWindow/FileSheet/Filename is null&quot;);
-
-        mFilename-&gt;activate();
-
-        // Get a access to the savegame table
-        mSaveGameTable = getMultiColumnList(&quot;SaveLoadWindow/FileSheet/SaveGameTable&quot;);
-        RlAssert(mSaveGameTable != NULL, &quot;SaveLoadWindow/FileSheet/SaveGameTable is null&quot;);
-
-        mSaveGameTable-&gt;addColumn( (utf8*)&quot;Filename&quot;, 0, cegui_reldim(0.7));
-        mSaveGameTable-&gt;addColumn( (utf8*)&quot;Date&quot;, 1, cegui_reldim(0.3));
-
-        centerWindow();
-
-        getPushButton(&quot;SaveLoadWindow/ButtonSheet/LoadButton&quot;)-&gt;subscribeEvent(
-        CEGUI::Window::EventMouseClick,
-        boost::bind(
-            &amp;SaveLoadWindow::handleLoadEvent,
-            this
-        ));
-
-        getPushButton(&quot;SaveLoadWindow/ButtonSheet/SaveButton&quot;)-&gt;subscribeEvent(
-        CEGUI::Window::EventMouseClick,
-        boost::bind(
-            &amp;SaveLoadWindow::handleSaveEvent,
-            this
-        ));
-
-        getPushButton(&quot;SaveLoadWindow/ButtonSheet/DeleteButton&quot;)-&gt;subscribeEvent(
-        CEGUI::Window::EventMouseClick,
-        boost::bind(
-            &amp;SaveLoadWindow::handleDeleteEvent,
-            this
-        ));
-
-        bindDestroyWindowToXButton();
-        bindDestroyWindowToClick(getWindow(&quot;SaveLoadWindow/ButtonSheet/CancelButton&quot;));
-
-    }
-
-    //------------------------------------------------------- Destructor
-
-    SaveLoadWindow::~SaveLoadWindow()
-    {
-    }
-
-    //------------------------------------------------------- initialize
-
-    void SaveLoadWindow::initialize()
-    {
-        //mSaveGameTable-&gt;autoSizeColumnHeader(0);
-        //mSaveGameTable-&gt;autoSizeColumnHeader(1);
-        listSaveGames();
-    }
-
-    //------------------------------------------------------- LoadEvent
-
-    bool SaveLoadWindow::handleLoadEvent()
-    {
-        LOG_MESSAGE(Logger::UI, &quot;Load Button pressed&quot;);
-
-        CeGuiString filename = mFilename-&gt;getText();
-
-        if(filename != &quot;&quot;)
-        {
-
-            if(SaveGameManager::getSingleton().SaveGameFileExists(filename))
-                SaveGameManager::getSingleton().loadSaveGameFile(filename);
-            else
-            {
-                LOG_ERROR(Logger::UI, &quot;Save Game &quot; + filename + &quot; doesn't exist!&quot;);
-                WindowFactory::getSingleton().showMessageWindow(&quot;Der Spielstand existiert nicht&quot;);
-            }
-        }
-
-        return true;
-    }
-
-    //------------------------------------------------------- SaveEvent
-
-    bool SaveLoadWindow::handleSaveEvent()
-    {
-        LOG_MESSAGE(Logger::UI, &quot;Save Button pressed&quot;);
-
-        CeGuiString filename = mFilename-&gt;getText();
-
-        if(filename != &quot;&quot;)
-        {
-            LOG_MESSAGE(Logger::UI, &quot;Create a SaveGameFile&quot;);
-
-            SaveGameManager::getSingleton().saveSaveGameFile(filename);
-
-            LOG_MESSAGE(Logger::UI, &quot;Created save game&quot;);
-        }
-        else
-        {
-            WindowFactory::getSingleton().showMessageWindow(&quot;Bitte einen Namen f&#252;r den Spielstand eingeben&quot;);
-        }
-
-        listSaveGames();
-
-        return true;
-    }
-
-    //------------------------------------------------------- DeleteEvent
-
-    bool SaveLoadWindow::handleDeleteEvent()
-    {
-        LOG_MESSAGE(Logger::UI, &quot;Delete Button pressed&quot;);
-        return true;
-    }
-
-    void SaveLoadWindow::listSaveGames()
-    {
-        SaveGameEntryMap saveGames = SaveGameManager::getSingleton().listSaveGames();
-    
-        while(mSaveGameTable-&gt;getRowCount() &gt; saveGames.size())
-		    mSaveGameTable-&gt;removeRow(mSaveGameTable-&gt;getRowCount()-1);
-        while(mSaveGameTable-&gt;getRowCount() &lt; saveGames.size())
-		    mSaveGameTable-&gt;addRow();
-        
-        int saveGameNum = 0;
-
-        for(SaveGameEntryMap::iterator it = saveGames.begin(); it != saveGames.end(); it++)
-        {
-            mSaveGameTable-&gt;setItem(new CEGUI::ListboxTextItem(it-&gt;first), 0, saveGameNum);
-            mSaveGameTable-&gt;setItem(new CEGUI::ListboxTextItem(it-&gt;second-&gt;getProperty(&quot;time&quot;)), 1, saveGameNum);
-            saveGameNum++;
-        }
-        mSaveGameTable-&gt;autoSizeColumnHeader(0);
-        mSaveGameTable-&gt;autoSizeColumnHeader(1);
-    }
-
-} // namespace rl

Modified: rl/trunk/engine/ui/src/WindowFactory.cpp
===================================================================
--- rl/trunk/engine/ui/src/WindowFactory.cpp	2007-11-24 10:09:51 UTC (rev 4007)
+++ rl/trunk/engine/ui/src/WindowFactory.cpp	2007-11-24 18:40:40 UTC (rev 4008)
@@ -34,7 +34,8 @@
 #include &quot;GameObject.h&quot;
 #include &quot;GameObjectInfoWindow.h&quot;
 #include &quot;PropertiesWindow.h&quot;
-#include &quot;SaveLoadWindow.h&quot;
+#include &quot;GameSaveLoadWindow.h&quot;
+#include &quot;MainMenuLoadWindow.h&quot;
 #include &quot;GameSettings.h&quot;
 #include &quot;InfoPopup.h&quot;
 #include &quot;InGameMenuWindow.h&quot;
@@ -170,13 +171,20 @@
         wnd-&gt;setVisible(true);
     }
 
-    void WindowFactory::showSaveLoadWindow()
+    void WindowFactory::showGameSaveLoadWindow()
     {
-        SaveLoadWindow* wnd = new SaveLoadWindow();
+        GameSaveLoadWindow* wnd = new GameSaveLoadWindow();
         wnd-&gt;initialize();
         wnd-&gt;setVisible(true);
     }
 
+    void WindowFactory::showMainMenuLoadWindow()
+    {
+        MainMenuLoadWindow* wnd = new MainMenuLoadWindow();
+        wnd-&gt;initialize();
+        wnd-&gt;setVisible(true);
+    }
+
     void WindowFactory::toggleGameLogWindow()
     {
         mGameLogger-&gt;setVisible(!mGameLogger-&gt;isVisible());


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001078.html">[Dsa-hl-svn] r4007 - in modules/kanalisation: maps materials	materials/textures scripts
</A></li>
	<LI>Next message: <A HREF="001080.html">[Dsa-hl-svn] r4009 - in modules/common: gui/windows scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1079">[ date ]</a>
              <a href="thread.html#1079">[ thread ]</a>
              <a href="subject.html#1079">[ subject ]</a>
              <a href="author.html#1079">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
