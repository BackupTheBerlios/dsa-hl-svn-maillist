<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r4969 - modules modules/common/gui	rl/trunk/engine/ai/src rl/trunk/engine/common/src	rl/trunk/engine/core/include rl/trunk/engine/core/src	rl/trunk/engine/rules/src rl/trunk/engine/script/include	rl/trunk/engine/script/src rl/trunk/engine/startup/src	rl/trunk/engine/ui/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4969%20-%20modules%20modules/common/gui%0A%09rl/trunk/engine/ai/src%20rl/trunk/engine/common/src%0A%09rl/trunk/engine/core/include%20rl/trunk/engine/core/src%0A%09rl/trunk/engine/rules/src%20rl/trunk/engine/script/include%0A%09rl/trunk/engine/script/src%20rl/trunk/engine/startup/src%0A%09rl/trunk/engine/ui/src&In-Reply-To=%3C200911072322.nA7NMKE6019463%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002024.html">
   <LINK REL="Next"  HREF="002026.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r4969 - modules modules/common/gui	rl/trunk/engine/ai/src rl/trunk/engine/common/src	rl/trunk/engine/core/include rl/trunk/engine/core/src	rl/trunk/engine/rules/src rl/trunk/engine/script/include	rl/trunk/engine/script/src rl/trunk/engine/startup/src	rl/trunk/engine/ui/src</H1>
    <B>blakharaz at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4969%20-%20modules%20modules/common/gui%0A%09rl/trunk/engine/ai/src%20rl/trunk/engine/common/src%0A%09rl/trunk/engine/core/include%20rl/trunk/engine/core/src%0A%09rl/trunk/engine/rules/src%20rl/trunk/engine/script/include%0A%09rl/trunk/engine/script/src%20rl/trunk/engine/startup/src%0A%09rl/trunk/engine/ui/src&In-Reply-To=%3C200911072322.nA7NMKE6019463%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r4969 - modules modules/common/gui	rl/trunk/engine/ai/src rl/trunk/engine/common/src	rl/trunk/engine/core/include rl/trunk/engine/core/src	rl/trunk/engine/rules/src rl/trunk/engine/script/include	rl/trunk/engine/script/src rl/trunk/engine/startup/src	rl/trunk/engine/ui/src">blakharaz at mail.berlios.de
       </A><BR>
    <I>Sun Nov  8 00:22:20 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002024.html">[Dsa-hl-svn] r4968 - in rl/trunk/engine: common core rules script	startup ui
</A></li>
        <LI>Next message: <A HREF="002026.html">[Dsa-hl-svn] r4970 - in rl/trunk/engine: core/src ui/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2025">[ date ]</a>
              <a href="thread.html#2025">[ thread ]</a>
              <a href="subject.html#2025">[ subject ]</a>
              <a href="author.html#2025">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: blakharaz
Date: 2009-11-08 00:22:12 +0100 (Sun, 08 Nov 2009)
New Revision: 4969

Modified:
   modules/
   modules/common/gui/cegui.config
   rl/trunk/engine/ai/src/DialogLoaderImpl.cpp
   rl/trunk/engine/common/src/XmlProcessor.cpp
   rl/trunk/engine/core/include/ConfigurationManager.h
   rl/trunk/engine/core/src/ConfigurationManager.cpp
   rl/trunk/engine/rules/src/DsaDataLoader.cpp
   rl/trunk/engine/script/include/AbstractMapNodeProcessor.h
   rl/trunk/engine/script/include/EntityNodeProcessor.h
   rl/trunk/engine/script/include/EnvironmentProcessor.h
   rl/trunk/engine/script/include/GameObjectNodeProcessor.h
   rl/trunk/engine/script/include/LightNodeProcessor.h
   rl/trunk/engine/script/include/ParticleSystemNodeProcessor.h
   rl/trunk/engine/script/include/PlaneNodeProcessor.h
   rl/trunk/engine/script/include/SoundNodeProcessor.h
   rl/trunk/engine/script/include/WaypointProcessor.h
   rl/trunk/engine/script/include/ZoneProcessor.h
   rl/trunk/engine/script/src/EntityNodeProcessor.cpp
   rl/trunk/engine/script/src/EnvironmentProcessor.cpp
   rl/trunk/engine/script/src/GameObjectNodeProcessor.cpp
   rl/trunk/engine/script/src/LightNodeProcessor.cpp
   rl/trunk/engine/script/src/MapLoader.cpp
   rl/trunk/engine/script/src/ParticleSystemNodeProcessor.cpp
   rl/trunk/engine/script/src/PlaneNodeProcessor.cpp
   rl/trunk/engine/script/src/SoundNodeProcessor.cpp
   rl/trunk/engine/script/src/WaypointProcessor.cpp
   rl/trunk/engine/script/src/ZoneProcessor.cpp
   rl/trunk/engine/startup/src/RastullahMain.cpp
   rl/trunk/engine/ui/src/UiSubsystem.cpp
Log:
Made RL start again (fixed some bugs in the change to newer Ogre, CEGUI and to TinyXML)


Property changes on: modules
___________________________________________________________________
Name: svn:ignore
   - logs
dependencies
*.ncb
*.suo
rl_dist
*.obj
*.exp
*.lib
*.dll
*.idb
*.pdb
*.htm
*.ilk
*.asm

.settings

.project

   + logs
dependencies
*.ncb
*.suo
rl_dist
*.obj
*.exp
*.lib
*.dll
*.idb
*.pdb
*.htm
*.ilk
*.asm

.settings

.project
cache


Modified: modules/common/gui/cegui.config
===================================================================
--- modules/common/gui/cegui.config	2009-11-07 20:53:23 UTC (rev 4968)
+++ modules/common/gui/cegui.config	2009-11-07 23:22:12 UTC (rev 4969)
@@ -1,5 +1,6 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
-&lt;CEGUIConfig 
-    DefaultFont=&quot;DefaultFont&quot; 
-    Scheme=&quot;common/gui/schemes/RastullahLook.scheme&quot; 
-/&gt;
+&lt;CEGUIConfig&gt;
+	&lt;DefaultFont name=&quot;DefaultFont&quot; /&gt;
+	&lt;Logging level=&quot;Standard&quot;/&gt;
+	&lt;AutoLoad type=&quot;Scheme&quot; pattern=&quot;common/gui/schemes/RastullahLook.scheme&quot;/&gt;
+&lt;/CEGUIConfig&gt;

Modified: rl/trunk/engine/ai/src/DialogLoaderImpl.cpp
===================================================================
--- rl/trunk/engine/ai/src/DialogLoaderImpl.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/ai/src/DialogLoaderImpl.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -436,43 +436,49 @@
         CeGuiString id = getAttributeValueAsString(switchOptXml, &quot;id&quot;);
         DialogOptionSelection* option = dynamic_cast&lt;DialogOptionSelection*&gt;(dialogPrototype-&gt;getOption(id));
 
-        if (!option) Throw(IllegalArgumentException, CeGuiString(&quot;No switchoption with ID &quot;+ id).c_str());
+        if (!option)
+		{
+			Throw(IllegalArgumentException, CeGuiString(&quot;No switchoption with ID &quot;+ id).c_str());
+		}
 
-        for (const TiXmlNode* cur = switchOptXml-&gt;FirstChild(); cur != NULL; cur = cur-&gt;NextSibling())
+        for (const TiXmlNode* cur = switchOptXml-&gt;FirstChild(); cur; cur = cur-&gt;NextSibling())
         {
-            DialogVariable* variable = processVariableClasses(cur-&gt;ToElement());
-            if (variable != NULL)
-            {
-                option-&gt;setVariable(variable);
-            }
-            else if (hasNodeName(cur, &quot;case&quot;))
-            {
-                DialogCondition* condition = processCase(cur-&gt;ToElement());
-                for (const TiXmlNode* caseChild = cur-&gt;FirstChild(); caseChild != NULL; caseChild = caseChild-&gt;NextSibling())
-                {
-                    DialogOption* optionCase = processOptionClasses(caseChild, dialogPrototype);
-                    if (optionCase)
-                    {
-                        option-&gt;addElement(condition, optionCase);
-                        break;
-                    }
-                }
-            }
-            // process translations
-            else if (hasNodeName(cur, &quot;t&quot;))
-            {
-                const TiXmlElement* translation = cur-&gt;ToElement();
-                // check loca
-                if (getAttributeValueAsStdString(translation, &quot;language&quot;) ==
-                   ConfigurationManager::getSingleton().getStringSetting(&quot;Localization&quot;, &quot;language&quot;))
-                {
-                    std::string label = getAttributeValueAsStdString(translation, &quot;label&quot;);
-                    if (!label.empty())
-                    {
-                        option-&gt;setLabel(label);
-                    }
-                }
-            }
+			if (cur-&gt;Type() == TiXmlNode::ELEMENT)
+			{
+				DialogVariable* variable = processVariableClasses(cur-&gt;ToElement());
+				if (variable != NULL)
+				{
+					option-&gt;setVariable(variable);
+				}
+				else if (hasNodeName(cur, &quot;case&quot;))
+				{
+					DialogCondition* condition = processCase(cur-&gt;ToElement());
+					for (const TiXmlNode* caseChild = cur-&gt;FirstChild(); caseChild != NULL; caseChild = caseChild-&gt;NextSibling())
+					{
+						DialogOption* optionCase = processOptionClasses(caseChild, dialogPrototype);
+						if (optionCase)
+						{
+							option-&gt;addElement(condition, optionCase);
+							break;
+						}
+					}
+				}
+				// process translations
+				else if (hasNodeName(cur, &quot;t&quot;))
+				{
+					const TiXmlElement* translation = cur-&gt;ToElement();
+					// check loca
+					if (getAttributeValueAsStdString(translation, &quot;language&quot;) ==
+					   ConfigurationManager::getSingleton().getStringSetting(&quot;Localization&quot;, &quot;language&quot;))
+					{
+						std::string label = getAttributeValueAsStdString(translation, &quot;label&quot;);
+						if (!label.empty())
+						{
+							option-&gt;setLabel(label);
+						}
+					}
+				}
+			}
         }
 
         return option;

Modified: rl/trunk/engine/common/src/XmlProcessor.cpp
===================================================================
--- rl/trunk/engine/common/src/XmlProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/common/src/XmlProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -54,7 +54,7 @@
 
 	for (const TiXmlNode* cur = parent-&gt;FirstChild(); cur; cur = cur-&gt;NextSibling())
 	{
-		if (cur-&gt;Type() == TiXmlNode::ELEMENT &amp;&amp; cur-&gt;Value() == name)
+		if (cur-&gt;Type() == TiXmlNode::ELEMENT &amp;&amp; cur-&gt;ValueTStr() == name)
 		{
 			return cur-&gt;ToElement();
 		}
@@ -69,7 +69,7 @@
 
 	for (TiXmlNode* cur = parent-&gt;FirstChild(); cur; cur = cur-&gt;NextSibling())
 	{
-		if (cur-&gt;Type() == TiXmlNode::ELEMENT &amp;&amp; cur-&gt;Value() == name)
+		if (cur-&gt;Type() == TiXmlNode::ELEMENT &amp;&amp; cur-&gt;ValueTStr() == name)
 		{
 			return cur-&gt;ToElement();
 		}
@@ -128,7 +128,8 @@
 CeGuiString XmlProcessor::getValueAsString(const TiXmlElement* element) const
 {
     RlAssert(element != NULL, &quot;XmlProcessor::getValueAsString: Element must not be NULL&quot;);
-	return element-&gt;FirstChild()-&gt;Value();
+	const utf8* value = reinterpret_cast&lt;const utf8*&gt;(element-&gt;FirstChild()-&gt;Value());
+	return value ? CeGuiString(value) : CeGuiString();
 }
 
 std::string XmlProcessor::getValueAsStdString(const TiXmlElement* element) const
@@ -308,8 +309,8 @@
 CeGuiString XmlProcessor::getAttributeValueAsString(const TiXmlElement* element, const char* const name) const
 {
     RlAssert(element != NULL, &quot;XmlProcessor::getAttributeValueAsString: Element must not be NULL&quot;);
-	CeGuiString rVal(element-&gt;Attribute(name));
-	return rVal;
+	const utf8* value = reinterpret_cast&lt;const utf8*&gt;(element-&gt;Attribute(name));
+	return value ? CeGuiString(value) : CeGuiString();
 }
 
 void XmlProcessor::setAttributeValueAsStdString(TiXmlElement *element, const char *const name, const std::string &amp;value) const
@@ -321,7 +322,8 @@
 std::string XmlProcessor::getAttributeValueAsStdString(const TiXmlElement* element, const char* const name) const
 {
     RlAssert(element != NULL, &quot;XmlProcessor::getAttributeValueAsStdString: Element must not be NULL&quot;);
-	return element-&gt;Attribute(name);
+	const char* value = element-&gt;Attribute(name);
+	return value ? std::string(value) : std::string(&quot;&quot;);
 }
 
 void XmlProcessor::setAttributeValueAsBool(TiXmlElement *element, const char *const name, bool value) const

Modified: rl/trunk/engine/core/include/ConfigurationManager.h
===================================================================
--- rl/trunk/engine/core/include/ConfigurationManager.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/core/include/ConfigurationManager.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -216,11 +216,18 @@
              * Loads configuration files from the configuration directories
              *
              * Loads up to four configuration files (systemwide, user, current
-             * directory, module) and sets certain settings for the game
+             * directory) and sets certain settings for the game
              */
             void loadConfig();
 
             /**
+             * Loads module configuration files 
+             *
+			 * NOTE: run loadConfig() beforehand to get the path to that configuration file
+             */
+			void loadModulesConfig();
+
+            /**
              * Saves a configuration file in OS specific directory
              */
             void saveConfig() const;

Modified: rl/trunk/engine/core/src/ConfigurationManager.cpp
===================================================================
--- rl/trunk/engine/core/src/ConfigurationManager.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/core/src/ConfigurationManager.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -305,7 +305,10 @@
         addPlugin(&quot;Plugin_ParticleFX&quot;, mOgrePluginDirectory);
         addPlugin(&quot;Plugin_OctreeSceneManager&quot;, mOgrePluginDirectory);
 		addPlugin(&quot;Plugin_CgProgramManager&quot;, mOgrePluginDirectory);
+	}
 
+	void ConfigurationManager::loadModulesConfig()
+	{
         // Load the module list
         ConfigFile* configfile = new ConfigFile();
         configfile-&gt;load(fs::path(mModulesRootDirectory + &quot;/&quot; + mModulesCfgFile).native_directory_string());

Modified: rl/trunk/engine/rules/src/DsaDataLoader.cpp
===================================================================
--- rl/trunk/engine/rules/src/DsaDataLoader.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/rules/src/DsaDataLoader.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -77,6 +77,7 @@
             {
                 Talent* t = processTalent(gruppe, talenteXml[talentIdx]);
                 //numTalent++;
+				LOG_MESSAGE(&quot;DsaDataLoader&quot;, &quot;Found talent &quot; + t-&gt;getName());
 				DsaManager::getSingleton()._addTalent(t);
             }
 		}

Modified: rl/trunk/engine/script/include/AbstractMapNodeProcessor.h
===================================================================
--- rl/trunk/engine/script/include/AbstractMapNodeProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/AbstractMapNodeProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -30,7 +30,7 @@
     public:
         virtual ~AbstractMapNodeProcessor();
         
-        virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects) = 0;
+		virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects) = 0;
         
         void setRootSceneNode(Ogre::SceneNode* node);
 

Modified: rl/trunk/engine/script/include/EntityNodeProcessor.h
===================================================================
--- rl/trunk/engine/script/include/EntityNodeProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/EntityNodeProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -33,7 +33,7 @@
     public:
         EntityNodeProcessor(const Ogre::String&amp; resourcegroup);
 
-        virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+        virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
 
     private:
         Ogre::String mResourceGroup;

Modified: rl/trunk/engine/script/include/EnvironmentProcessor.h
===================================================================
--- rl/trunk/engine/script/include/EnvironmentProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/EnvironmentProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
 	class EnvironmentProcessor : private AbstractMapNodeProcessor
 	{
 	public:
-		virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+		virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
 		void processFogSettings(const TiXmlElement* fogElem);
 		void processSkySettings(const TiXmlElement* fogElem);
 	};

Modified: rl/trunk/engine/script/include/GameObjectNodeProcessor.h
===================================================================
--- rl/trunk/engine/script/include/GameObjectNodeProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/GameObjectNodeProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -24,7 +24,7 @@
     class GameObjectNodeProcessor : public AbstractMapNodeProcessor
     {
     public:
-        virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+        virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
     };
 }
 

Modified: rl/trunk/engine/script/include/LightNodeProcessor.h
===================================================================
--- rl/trunk/engine/script/include/LightNodeProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/LightNodeProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
     class LightNodeProcessor : public AbstractMapNodeProcessor
     {
     public:
-        virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+        virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
     };
 }
 

Modified: rl/trunk/engine/script/include/ParticleSystemNodeProcessor.h
===================================================================
--- rl/trunk/engine/script/include/ParticleSystemNodeProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/ParticleSystemNodeProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
     class ParticleSystemNodeProcessor : public AbstractMapNodeProcessor
     {
     public:
-        virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+        virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
     };
 }
 

Modified: rl/trunk/engine/script/include/PlaneNodeProcessor.h
===================================================================
--- rl/trunk/engine/script/include/PlaneNodeProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/PlaneNodeProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -36,7 +36,7 @@
     public:
         PlaneNodeProcessor();
 
-        virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+        virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
 
     private:
 

Modified: rl/trunk/engine/script/include/SoundNodeProcessor.h
===================================================================
--- rl/trunk/engine/script/include/SoundNodeProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/SoundNodeProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
     class SoundNodeProcessor : public AbstractMapNodeProcessor
     {
     public:
-        virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+        virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
     };
 }
 

Modified: rl/trunk/engine/script/include/WaypointProcessor.h
===================================================================
--- rl/trunk/engine/script/include/WaypointProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/WaypointProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
 	class WaypointProcessor : private AbstractMapNodeProcessor
 	{
 	public:
-		virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+		virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
 	};
 }
 

Modified: rl/trunk/engine/script/include/ZoneProcessor.h
===================================================================
--- rl/trunk/engine/script/include/ZoneProcessor.h	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/include/ZoneProcessor.h	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
 	class ZoneProcessor : private AbstractMapNodeProcessor
 	{
 	public:
-		virtual bool processNode(const TiXmlElement* nodeElem, bool loadGameObjects);
+		virtual bool processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects);
 	};
 }
 

Modified: rl/trunk/engine/script/src/EntityNodeProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/EntityNodeProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/EntityNodeProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -31,7 +31,7 @@
     {
     }
 
-    bool EntityNodeProcessor::processNode(const TiXmlElement* nodeElem, bool loadGameObjects)
+    bool EntityNodeProcessor::processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
     {
         if (!hasNodeName(nodeElem, &quot;entity&quot;))
         {

Modified: rl/trunk/engine/script/src/EnvironmentProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/EnvironmentProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/EnvironmentProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -26,7 +26,7 @@
 
 namespace rl
 {
-	bool EnvironmentProcessor::processNode(const TiXmlElement* nodeElem, bool loadGameObjects)
+	bool EnvironmentProcessor::processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
 	{
 		if (nodeElem)
 		{

Modified: rl/trunk/engine/script/src/GameObjectNodeProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/GameObjectNodeProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/GameObjectNodeProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -24,7 +24,7 @@
 
 namespace rl
 {
-    bool GameObjectNodeProcessor::processNode(const TiXmlElement* nodeElem, bool loadGameObjects)
+    bool GameObjectNodeProcessor::processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
     {
         if (!hasNodeName(nodeElem, &quot;gameobject&quot;))
         {

Modified: rl/trunk/engine/script/src/LightNodeProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/LightNodeProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/LightNodeProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -24,7 +24,7 @@
 
 namespace rl
 {
-    bool LightNodeProcessor::processNode(const TiXmlElement* nodeElem, bool loadGameObjects)
+    bool LightNodeProcessor::processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
     {
         if (!hasNodeName(nodeElem, &quot;light&quot;))
         {

Modified: rl/trunk/engine/script/src/MapLoader.cpp
===================================================================
--- rl/trunk/engine/script/src/MapLoader.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/MapLoader.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -147,13 +147,13 @@
                 processSceneNodes(getChildNamed(dataDocumentContent, &quot;nodes&quot;), loadGameObjects);
 
 			    ZoneProcessor zp;
-			    zp.processNode(getChildNamed(dataDocumentContent, &quot;zones&quot;), loadGameObjects);
+				zp.processNode(getChildNamed(dataDocumentContent, &quot;zones&quot;), mResourceGroup, loadGameObjects);
 
 			    EnvironmentProcessor ep;
-			    ep.processNode(getChildNamed(dataDocumentContent, &quot;environment&quot;), loadGameObjects);
+			    ep.processNode(getChildNamed(dataDocumentContent, &quot;environment&quot;), mResourceGroup, loadGameObjects);
 
 			    WaypointProcessor wp;
-			    wp.processNode(getChildNamed(dataDocumentContent, &quot;waypoints&quot;), loadGameObjects);
+			    wp.processNode(getChildNamed(dataDocumentContent, &quot;waypoints&quot;), mResourceGroup, loadGameObjects);
 
                 LOG_MESSAGE(Logger::SCRIPT, &quot;Map &quot; + mapresource + &quot; loaded&quot;);
 
@@ -271,7 +271,7 @@
             	const TiXmlElement* curElem = cur-&gt;ToElement();
 
                 std::list&lt;AbstractMapNodeProcessor*&gt;::iterator it = mNodeProcessors.begin();
-                while (it != mNodeProcessors.end() &amp;&amp; !(*it)-&gt;processNode(curElem, loadGameObjects))
+                while (it != mNodeProcessors.end() &amp;&amp; !(*it)-&gt;processNode(curElem, mResourceGroup, loadGameObjects))
                 {
                     ++it;
                 }

Modified: rl/trunk/engine/script/src/ParticleSystemNodeProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/ParticleSystemNodeProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/ParticleSystemNodeProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
 
 namespace rl
 {
-    bool ParticleSystemNodeProcessor::processNode(const TiXmlElement* nodeElem, bool loadGameObjects)
+    bool ParticleSystemNodeProcessor::processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
     {
 		if (!hasNodeName(nodeElem, &quot;particlesystem&quot;))
 		{

Modified: rl/trunk/engine/script/src/PlaneNodeProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/PlaneNodeProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/PlaneNodeProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -31,7 +31,7 @@
 	{
 	}
 
-	bool PlaneNodeProcessor::processNode(const TiXmlElement *nodeElem, bool loadGameObjects)
+	bool PlaneNodeProcessor::processNode(const TiXmlElement *nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
 	{
 		if (!hasNodeName(nodeElem, &quot;plane&quot;))
         {
@@ -93,7 +93,7 @@
 		plane-&gt;d = 0;
 		plane-&gt;normal = Vector3::UNIT_Y;
 
-		MeshManager::getSingleton().createPlane(entName + &quot;Mesh&quot;, &quot;custom&quot;, *plane, scale.x, scale.y, 10, 10, true, 1, 1, 1, Vector3::UNIT_Z);
+		MeshManager::getSingleton().createPlane(entName + &quot;Mesh&quot;, resourceGroup, *plane, scale.x, scale.y, 10, 10, true, 1, 1, 1, Vector3::UNIT_Z);
 
 		Entity* ent = CoreSubsystem::getSingleton().getWorld()-&gt;getSceneManager()-&gt;createEntity(entName, entName + &quot;Mesh&quot;);
 

Modified: rl/trunk/engine/script/src/SoundNodeProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/SoundNodeProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/SoundNodeProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -21,7 +21,7 @@
 
 namespace rl
 {
-    bool SoundNodeProcessor::processNode(const TiXmlElement* nodeElem, bool loadGameObjects)
+    bool SoundNodeProcessor::processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
     {
         if (!hasNodeName(nodeElem, &quot;sound&quot;))
         {

Modified: rl/trunk/engine/script/src/WaypointProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/WaypointProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/WaypointProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -25,7 +25,7 @@
 
 namespace rl
 {
-	bool WaypointProcessor::processNode(const TiXmlElement* nodeElem, bool loadGameObjects)
+	bool WaypointProcessor::processNode(const TiXmlElement* nodeElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
 	{
 		if (nodeElem == NULL)
 		{

Modified: rl/trunk/engine/script/src/ZoneProcessor.cpp
===================================================================
--- rl/trunk/engine/script/src/ZoneProcessor.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/script/src/ZoneProcessor.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -30,7 +30,7 @@
 namespace rl
 {
 
-	bool ZoneProcessor::processNode(const TiXmlElement* zonesElem, bool loadGameObjects)
+	bool ZoneProcessor::processNode(const TiXmlElement* zonesElem, const Ogre::String&amp; resourceGroup, bool loadGameObjects)
 	{
 		if (zonesElem == NULL)
 		{

Modified: rl/trunk/engine/startup/src/RastullahMain.cpp
===================================================================
--- rl/trunk/engine/startup/src/RastullahMain.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/startup/src/RastullahMain.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -54,13 +54,14 @@
         Ogre::String ogreLogFile = rl::ConfigurationManager::getSingleton().getOgreLogFile();
         Ogre::String rlLogFile = rl::ConfigurationManager::getSingleton().getRastullahLogFile();
 
-
         logger = new rl::Logger(logDir, ogreLogFile, rlLogFile);
         // @todo in ConfigDatei auslagern/ oder auch Parameter
 
         rl::Logger::getSingleton().setLogDetail(
             rl::ConfigurationManager::getSingleton().getLogLevel());
 
+        rl::ConfigurationManager::getSingleton().loadModulesConfig();
+
         core = new rl::CoreSubsystem();
         core-&gt;setDeveloperMode(developerMode);
         LOG_MESSAGE_SHORT(&quot;CoreSubsystem gestartet&quot;);

Modified: rl/trunk/engine/ui/src/UiSubsystem.cpp
===================================================================
--- rl/trunk/engine/ui/src/UiSubsystem.cpp	2009-11-07 20:53:23 UTC (rev 4968)
+++ rl/trunk/engine/ui/src/UiSubsystem.cpp	2009-11-07 23:22:12 UTC (rev 4969)
@@ -118,7 +118,7 @@
 
         LOG_MESSAGE2(Logger::UI,
             &quot;Initializing CEGUI Renderer.&quot;, &quot;UiSubsystem::initializeUiSubsystem&quot;);
-		mGuiRenderer = &amp;OgreRenderer::bootstrapSystem(*CoreSubsystem::getSingleton().getRenderWindow());
+		mGuiRenderer = &amp;OgreRenderer::create(*CoreSubsystem::getSingleton().getRenderWindow());
 
         LOG_MESSAGE2(Logger::UI,
             &quot;Initializing CEGUI System.&quot;, &quot;UiSubsystem::initializeUiSubsystem&quot;);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002024.html">[Dsa-hl-svn] r4968 - in rl/trunk/engine: common core rules script	startup ui
</A></li>
	<LI>Next message: <A HREF="002026.html">[Dsa-hl-svn] r4970 - in rl/trunk/engine: core/src ui/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2025">[ date ]</a>
              <a href="thread.html#2025">[ thread ]</a>
              <a href="subject.html#2025">[ subject ]</a>
              <a href="author.html#2025">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
