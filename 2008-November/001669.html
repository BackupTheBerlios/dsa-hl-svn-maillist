<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r4612 - in rl/trunk/engine/ui: include src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4612%20-%20in%20rl/trunk/engine/ui%3A%20include%20src&In-Reply-To=%3C200811261907.mAQJ7OQS019323%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001668.html">
   <LINK REL="Next"  HREF="001670.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r4612 - in rl/trunk/engine/ui: include src</H1>
    <B>blakharaz at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4612%20-%20in%20rl/trunk/engine/ui%3A%20include%20src&In-Reply-To=%3C200811261907.mAQJ7OQS019323%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r4612 - in rl/trunk/engine/ui: include src">blakharaz at mail.berlios.de
       </A><BR>
    <I>Wed Nov 26 20:07:24 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001668.html">[Dsa-hl-svn] r4611 - in rl/trunk: . cmake plugins	plugins/fmod4driver
</A></li>
        <LI>Next message: <A HREF="001670.html">[Dsa-hl-svn] r4613 - in rl/branches/persistence: core/src	rules/include rules/src script/swig ui ui/include ui/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1669">[ date ]</a>
              <a href="thread.html#1669">[ thread ]</a>
              <a href="subject.html#1669">[ subject ]</a>
              <a href="author.html#1669">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: blakharaz
Date: 2008-11-26 20:07:20 +0100 (Wed, 26 Nov 2008)
New Revision: 4612

Added:
   rl/trunk/engine/ui/include/CharacterSelectionWindow.h
   rl/trunk/engine/ui/src/CharacterSelectionWindow.cpp
Modified:
   rl/trunk/engine/ui/include/AbstractWindow.h
   rl/trunk/engine/ui/include/GameSettings.h
   rl/trunk/engine/ui/src/AbstractWindow.cpp
   rl/trunk/engine/ui/src/GameSettings.cpp
   rl/trunk/engine/ui/src/InventoryWindow.cpp
Log:
Forgot the CharacterSelectionWindow files

Modified: rl/trunk/engine/ui/include/AbstractWindow.h
===================================================================
--- rl/trunk/engine/ui/include/AbstractWindow.h	2008-11-26 13:52:22 UTC (rev 4611)
+++ rl/trunk/engine/ui/include/AbstractWindow.h	2008-11-26 19:07:20 UTC (rev 4612)
@@ -1,140 +1,142 @@
-/* This source file is part of Rastullahs Lockenpracht.
- * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
- * 
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the Clarified Artistic License.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  Clarified Artistic License for more details.
- *
- *  You should have received a copy of the Clarified Artistic License
- *  along with this program; if not you can get it here
- *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
- */
-
-#ifndef __AbstractWindow_H__
-#define __AbstractWindow_H__
-
-#include &quot;UiPrerequisites.h&quot;
-
-
-#include &lt;CEGUIWindow.h&gt;
-#include &lt;elements/CEGUIEditbox.h&gt;
-#include &lt;elements/CEGUIListbox.h&gt;
-#include &lt;elements/CEGUIMultiColumnList.h&gt;
-#include &lt;elements/CEGUIMultiLineEditbox.h&gt;
-#include &lt;elements/CEGUIProgressBar.h&gt;
-#include &lt;elements/CEGUIMenuBase.h&gt;
-#include &lt;elements/CEGUIMenuItem.h&gt;
-#include &lt;elements/CEGUIPushButton.h&gt;
-#include &lt;elements/CEGUICombobox.h&gt;
-#include &lt;elements/CEGUIComboDropList.h&gt;
-#include &lt;elements/CEGUIScrollablePane.h&gt;
-#include &lt;elements/CEGUISlider.h&gt;
-#include &lt;elements/CEGUITabControl.h&gt;
-
-namespace rl {
-
-	class WindowUpdateTask;
-
-	/**
-	 * This is the base class for all UI windows
-	 */
-	class _RlUiExport AbstractWindow
-	{
-	public:
-
-		enum WindowInputType
-		{
-			WIT_NONE = 0x00,
-			WIT_MOUSE_INPUT = 0x01,
-			WIT_KEYBOARD_INPUT = 0x02
-		};
-
-		virtual ~AbstractWindow();	
-
-		/// creates a CEGUI window from an XML file, should only be used to load window parts (e.g. buttons)
-		static CEGUI::Window* loadWindow(const CeGuiString&amp; xmlfile);
-
-		/// creates a CEGUI window from an XML file, should only be used to load window parts (e.g. buttons)
-		static CEGUI::Window* loadWindow(const CeGuiString&amp; xmlfile, CeGuiString&amp; prefix);
-
-		/// gets the CEGUI root
-		static CEGUI::Window* getRoot();
-
-		/// gets the wrapped CEGUI window
-		CEGUI::Window* getWindow();
-
-		CEGUI::Window* getWindow(const char* name, const char* requiredClass = NULL);
-		CEGUI::Editbox* getEditbox(const char* name);
-		CEGUI::Listbox* getListbox(const char* name);
-		CEGUI::MultiColumnList* getMultiColumnList(const char* name);
-		CEGUI::MultiLineEditbox* getMultiLineEditbox(const char* name);
-		CEGUI::ProgressBar* getProgressBar(const char* name);
-		CEGUI::MenuBase* getMenu(const char* name);
-		CEGUI::MenuItem* getMenuItem(const char* name);
-		CEGUI::PushButton* getPushButton(const char* name);
-		CEGUI::Combobox* getCombobox(const char* name);
-		CEGUI::ComboDropList* getComboDropList(const char* name);
-        CEGUI::ScrollablePane* getScrollablePane(const char* name);
-		CEGUI::Slider* getSlider(const char* name);
-		CEGUI::TabControl* getTabControl(const char* name);
-
-		int getWindowInputType();
-
-        virtual bool isVisible();
-        virtual void setVisible(bool visible, bool destroyAfterHide = false);
-
-		bool isModal();
-		bool isClosingOnEscape();
-
-		const CeGuiString&amp; getName() const;
-		const Ogre::Real&amp; getNormalAlpha() const;
-
-		virtual void windowHid();
-
-        // return true, if the specified key should be repeated if pressed down
-        virtual bool wantsKeyToRepeat(const int &amp;key) {return false;}
-
-	protected:
-		AbstractWindow(
-			const CeGuiString&amp; xmlfile, 
-			int inputType, 
-			bool closeOnEscape = true,
-			bool modal = false);
-
-		const CeGuiString&amp; getNamePrefix() const;
-		
-		void centerWindow();
-		bool destroyWindow();		
-		bool hideWindow();
-
-		void bindDestroyWindowToClick(CEGUI::Window* button);
-        void bindHideWindowToClick(CEGUI::Window* button);
-		void bindDestroyWindowToXButton();
-		void bindHideWindowToXButton();
-
-		const CeGuiString&amp; getUserDataType(CEGUI::Window* window) const;
-		void setUserDataType(CEGUI::Window* window, const CeGuiString&amp; typeDescription) const;
-
-		CEGUI::Window* mWindow;
-		bool mVisible;
-
-	private:
-		
-		int mWindowInputType;
-		CeGuiString mNamePrefix;
-		CeGuiString mName;
-		bool mModal;
-		bool mCloseOnEscape;
-		Ogre::Real mNormalAlpha;
-
-		static int sNumAbstractWindows;
-
-	};
-
-}
-
-#endif
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ * 
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+
+#ifndef __AbstractWindow_H__
+#define __AbstractWindow_H__
+
+#include &quot;UiPrerequisites.h&quot;
+
+
+#include &lt;CEGUIWindow.h&gt;
+#include &lt;elements/CEGUICheckbox.h&gt;
+#include &lt;elements/CEGUIEditbox.h&gt;
+#include &lt;elements/CEGUIListbox.h&gt;
+#include &lt;elements/CEGUIMultiColumnList.h&gt;
+#include &lt;elements/CEGUIMultiLineEditbox.h&gt;
+#include &lt;elements/CEGUIProgressBar.h&gt;
+#include &lt;elements/CEGUIMenuBase.h&gt;
+#include &lt;elements/CEGUIMenuItem.h&gt;
+#include &lt;elements/CEGUIPushButton.h&gt;
+#include &lt;elements/CEGUICombobox.h&gt;
+#include &lt;elements/CEGUIComboDropList.h&gt;
+#include &lt;elements/CEGUIScrollablePane.h&gt;
+#include &lt;elements/CEGUISlider.h&gt;
+#include &lt;elements/CEGUITabControl.h&gt;
+
+namespace rl {
+
+	class WindowUpdateTask;
+
+	/**
+	 * This is the base class for all UI windows
+	 */
+	class _RlUiExport AbstractWindow
+	{
+	public:
+
+		enum WindowInputType
+		{
+			WIT_NONE = 0x00,
+			WIT_MOUSE_INPUT = 0x01,
+			WIT_KEYBOARD_INPUT = 0x02
+		};
+
+		virtual ~AbstractWindow();	
+
+		/// creates a CEGUI window from an XML file, should only be used to load window parts (e.g. buttons)
+		static CEGUI::Window* loadWindow(const CeGuiString&amp; xmlfile);
+
+		/// creates a CEGUI window from an XML file, should only be used to load window parts (e.g. buttons)
+		static CEGUI::Window* loadWindow(const CeGuiString&amp; xmlfile, CeGuiString&amp; prefix);
+
+		/// gets the CEGUI root
+		static CEGUI::Window* getRoot();
+
+		/// gets the wrapped CEGUI window
+		CEGUI::Window* getWindow();
+
+		CEGUI::Window* getWindow(const char* name, const char* requiredClass = NULL);
+		CEGUI::Editbox* getEditbox(const char* name);
+		CEGUI::Listbox* getListbox(const char* name);
+		CEGUI::MultiColumnList* getMultiColumnList(const char* name);
+		CEGUI::MultiLineEditbox* getMultiLineEditbox(const char* name);
+		CEGUI::ProgressBar* getProgressBar(const char* name);
+		CEGUI::MenuBase* getMenu(const char* name);
+		CEGUI::MenuItem* getMenuItem(const char* name);
+		CEGUI::PushButton* getPushButton(const char* name);
+		CEGUI::Combobox* getCombobox(const char* name);
+		CEGUI::ComboDropList* getComboDropList(const char* name);
+        CEGUI::ScrollablePane* getScrollablePane(const char* name);
+		CEGUI::Slider* getSlider(const char* name);
+		CEGUI::TabControl* getTabControl(const char* name);
+        CEGUI::Checkbox* getCheckbox(const char* name);
+
+		int getWindowInputType();
+
+        virtual bool isVisible();
+        virtual void setVisible(bool visible, bool destroyAfterHide = false);
+
+		bool isModal();
+		bool isClosingOnEscape();
+
+		const CeGuiString&amp; getName() const;
+		const Ogre::Real&amp; getNormalAlpha() const;
+
+		virtual void windowHid();
+
+        // return true, if the specified key should be repeated if pressed down
+        virtual bool wantsKeyToRepeat(const int &amp;key) {return false;}
+
+	protected:
+		AbstractWindow(
+			const CeGuiString&amp; xmlfile, 
+			int inputType, 
+			bool closeOnEscape = true,
+			bool modal = false);
+
+		const CeGuiString&amp; getNamePrefix() const;
+		
+		void centerWindow();
+		bool destroyWindow();		
+		bool hideWindow();
+
+		void bindDestroyWindowToClick(CEGUI::Window* button);
+        void bindHideWindowToClick(CEGUI::Window* button);
+		void bindDestroyWindowToXButton();
+		void bindHideWindowToXButton();
+
+		const CeGuiString&amp; getUserDataType(CEGUI::Window* window) const;
+		void setUserDataType(CEGUI::Window* window, const CeGuiString&amp; typeDescription) const;
+
+		CEGUI::Window* mWindow;
+		bool mVisible;
+
+	private:
+		
+		int mWindowInputType;
+		CeGuiString mNamePrefix;
+		CeGuiString mName;
+		bool mModal;
+		bool mCloseOnEscape;
+		Ogre::Real mNormalAlpha;
+
+		static int sNumAbstractWindows;
+
+	};
+
+}
+
+#endif

Added: rl/trunk/engine/ui/include/CharacterSelectionWindow.h
===================================================================
--- rl/trunk/engine/ui/include/CharacterSelectionWindow.h	2008-11-26 13:52:22 UTC (rev 4611)
+++ rl/trunk/engine/ui/include/CharacterSelectionWindow.h	2008-11-26 19:07:20 UTC (rev 4612)
@@ -0,0 +1,70 @@
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+#ifndef __CharacterSelectionWindow_H__
+#define __CharacterSelectionWindow_H__
+
+#include &quot;UiPrerequisites.h&quot;
+
+#include &quot;AbstractWindow.h&quot;
+#include &quot;MessagePump.h&quot;
+#include &quot;ObjectStateChangeListener.h&quot;
+
+namespace rl
+{
+    class Creature;
+    
+    class CharacterSelectionWindow : public AbstractWindow
+    {
+    public:
+        CharacterSelectionWindow();
+        virtual ~CharacterSelectionWindow();
+        
+        bool update();
+        
+    private:
+        
+        class Element : public AbstractWindow, public ObjectStateChangeListener
+        {
+        public:
+            Element(CharacterSelectionWindow* parent);
+            virtual ~Element();
+            
+            void setCreature(Creature* creature);
+            void objectStateChanged(ObjectStateChangeEvent* evt);
+        
+        private:
+            CharacterSelectionWindow* mParent;
+            Creature* mCreature;
+            CEGUI::Window* mTextName;
+            CEGUI::Window* mPortrait;
+            CEGUI::ProgressBar* mLP;
+            
+            void update();
+        };
+        
+        std::vector&lt;Element*&gt; mCharacterWindows;
+        CEGUI::Window* mCharacterWindow;
+
+        bool handleClickOnCharacter(size_t index);
+        CEGUI::Window* createCharacterWindow();
+        void removeCharacterWindow(CEGUI::Window* window);
+        
+        MessagePump::ScopedConnection mCharacterAddedConnection;
+        MessagePump::ScopedConnection mCharacterRemovedConnection;
+    };
+}
+
+#endif // __CharacterSelectionWindow_H__

Modified: rl/trunk/engine/ui/include/GameSettings.h
===================================================================
--- rl/trunk/engine/ui/include/GameSettings.h	2008-11-26 13:52:22 UTC (rev 4611)
+++ rl/trunk/engine/ui/include/GameSettings.h	2008-11-26 19:07:20 UTC (rev 4612)
@@ -82,11 +82,17 @@
 		 * configuration section.
 		 */
 		bool onRenderSystemChanged();
+        
+        void update();
 
 		std::list&lt;SoundDriverConfigComponent*&gt; mSoundDriverConfigs;   //!&lt; List of registered sounddriver configuration components
 		SoundDriverConfigComponent* mCurrentSoundDriverConfig;        //!&lt; Configuration component of currently selected sound driver
 		std::list&lt;RenderSystemConfigComponent*&gt; mRenderSystemConfigs; //!&lt; List of registered rendersystem configuration components
 		RenderSystemConfigComponent* mCurrentRenderSystemConfig;      //!&lt; Configuration component of currently selected rendersystem
+        
+        CEGUI::Combobox* mVideoRenderer;
+        CEGUI::Combobox* mVideoResolution;
+        CEGUI::Checkbox* mVideoFullscreen;
 	};
 }
 

Modified: rl/trunk/engine/ui/src/AbstractWindow.cpp
===================================================================
--- rl/trunk/engine/ui/src/AbstractWindow.cpp	2008-11-26 13:52:22 UTC (rev 4611)
+++ rl/trunk/engine/ui/src/AbstractWindow.cpp	2008-11-26 19:07:20 UTC (rev 4612)
@@ -1,319 +1,325 @@
-/* This source file is part of Rastullahs Lockenpracht.
- * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the Clarified Artistic License.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  Clarified Artistic License for more details.
- *
- *  You should have received a copy of the Clarified Artistic License
- *  along with this program; if not you can get it here
- *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
- */
-#include &quot;stdinc.h&quot; //precompiled header
-
-#include &lt;boost/bind.hpp&gt;
-#include &lt;CEGUIWindowManager.h&gt;
-#include &lt;elements/CEGUIFrameWindow.h&gt;
-
-#include &quot;UiPrerequisites.h&quot;
-#include &quot;Exception.h&quot;
-
-#include &quot;UiSubsystem.h&quot;
-#include &quot;AbstractWindow.h&quot;
-#include &quot;CeGuiHelper.h&quot;
-#include &quot;WindowManager.h&quot;
-#include &quot;WindowFadeJob.h&quot;
-#include &quot;JobScheduler.h&quot;
-
-using namespace std;
-using namespace CEGUI;
-using namespace Ogre;
-
-namespace rl
-{
-
-	int AbstractWindow::sNumAbstractWindows = 0;
-
-	AbstractWindow::AbstractWindow(const CeGuiString&amp; xmlfile, int inputType, bool closeOnEscape, bool modal)
-	: mVisible(false),
-		mModal(modal),
-		mWindowInputType(inputType),
-		mCloseOnEscape(closeOnEscape)
-	{
-        LOG_MESSAGE(Logger::UI,
-		    &quot;Lade Fenster '&quot; + Ogre::String(xmlfile.c_str()) + &quot;'&quot;);
-   		mWindow = AbstractWindow::loadWindow(xmlfile, mNamePrefix);
-		if (mWindow == NULL)
-		{
-			Throw(rl::IllegalStateException, Ogre::String(&quot;Could not load window '&quot;)+xmlfile.c_str()+&quot;'.&quot;);
-		}
-
-		getRoot()-&gt;addChildWindow(mWindow);
-
-        if (modal)
-		{
-			mWindow-&gt;setModalState(true);
-			mWindow-&gt;setAlwaysOnTop(true);
-            mWindow-&gt;moveToFront();
-            mWindow-&gt;show();
-		}
-        else
-        {
-       		mWindow-&gt;hide();
-        }
-
-		mNormalAlpha = mWindow-&gt;getAlpha();
-		mName = mWindow-&gt;getName();
-		WindowManager::getSingleton().registerWindow(this);
-		mWindow-&gt;subscribeEvent(Window::EventActivated,
-			boost::bind(
-				&amp;rl::WindowManager::handleMovedToFront,
-				rl::WindowManager::getSingletonPtr(),
-				this));
-	}
-
-	AbstractWindow::~AbstractWindow()
-	{
-		mWindow-&gt;hide();
-		mWindow-&gt;removeAllEvents();
-		WindowManager::getSingleton().unregisterWindow(this);
-		getRoot()-&gt;removeChildWindow(mWindow);
-		CEGUI::WindowManager::getSingleton().destroyWindow(mWindow);
-	}
-
-	CEGUI::Window* AbstractWindow::loadWindow(const CeGuiString&amp; xmlfile)
-	{
-		CeGuiString prefix = &quot;&quot;;
-		return loadWindow(xmlfile, prefix);
-	}
-
-
-	CEGUI::Window* AbstractWindow::loadWindow(const CeGuiString&amp; xmlfile, CeGuiString&amp; prefix)
-	{
-		CeGuiString namePrefix;
-		if (prefix == &quot;&quot;)
-			prefix.assign(StringConverter::toString(sNumAbstractWindows));
-		sNumAbstractWindows++;
-
-		CEGUI::Window* window = NULL;
-		try
-		{
-			window = CEGUI::WindowManager::getSingleton().loadWindowLayout(xmlfile, prefix);
-		}
-		catch(...)
-		{
-		}
-
-		return window;
-	}
-
-	bool AbstractWindow::isVisible()
-	{
-		return mVisible;
-	}
-
-	void AbstractWindow::setVisible(bool visible, bool destroy)
-	{
-		if(mVisible != visible)
-		{
-			if (visible)
-			{
-                JobScheduler::getSingleton().addJob(
-                    new WindowFadeJob(this, WindowFadeJob::FADE_IN, mNormalAlpha));
-			}
-			else
-			{
-                JobScheduler::getSingleton().addJob(
-                    new WindowFadeJob(this,
-                    destroy ? WindowFadeJob::FADE_OUT_AND_DESTROY : WindowFadeJob::FADE_OUT,
-                    0.0f));
-			}
-            WindowManager::getSingleton()._visiblityChanged(this, visible);
-            mVisible = visible;
-		}
-	}
-
-	const Ogre::Real&amp; AbstractWindow::getNormalAlpha() const
-	{
-		return mNormalAlpha;
-	}
-
-	bool AbstractWindow::isModal()
-	{
-		return mModal;
-	}
-
-	bool AbstractWindow::isClosingOnEscape()
-	{
-		return mCloseOnEscape;
-	}
-
-	int AbstractWindow::getWindowInputType()
-	{
-		return mWindowInputType;
-	}
-
-	CEGUI::Window* AbstractWindow::getRoot()
-	{
-		return CEGUI::WindowManager::getSingleton().getWindow(
-			(utf8*)UiSubsystem::CEGUI_ROOT);
-	}
-
-	Window* AbstractWindow::getWindow(const char* name, const char* requiredClass)
-	{
-		CEGUI::Window* wnd =
-			CEGUI::WindowManager::getSingleton().getWindow(
-				mNamePrefix + (utf8*)name);
-
-		if (wnd == NULL)
-			Throw(
-				rl::NullPointerException,
-				&quot;Window &quot;
-				+ Ogre::String(name)
-				+ &quot; is NULL&quot;);
-
-		if (requiredClass != NULL &amp;&amp; !wnd-&gt;testClassName(requiredClass))
-			Throw(
-				rl::NullPointerException,
-				&quot;Window &quot;
-				+ Ogre::String(name)
-				+ &quot; has not the required class &quot;
-				+ Ogre::String(requiredClass));
-
-		return wnd;
-	}
-
-	Editbox* AbstractWindow::getEditbox(const char* name)
-	{
-		return static_cast&lt;Editbox*&gt;(getWindow(name, &quot;Editbox&quot;));
-	}
-
-	Listbox* AbstractWindow::getListbox(const char* name)
-	{
-		return static_cast&lt;Listbox*&gt;(getWindow(name, &quot;Listbox&quot;));
-	}
-
-	MultiColumnList* AbstractWindow::getMultiColumnList(const char* name)
-	{
-		return static_cast&lt;MultiColumnList*&gt;(getWindow(name, &quot;MultiColumnList&quot;));
-	}
-
-	MultiLineEditbox* AbstractWindow::getMultiLineEditbox(const char* name)
-	{
-		return static_cast&lt;MultiLineEditbox*&gt;(getWindow(name, &quot;MultiLineEditbox&quot;));
-	}
-
-	ProgressBar* AbstractWindow::getProgressBar(const char* name)
-	{
-		return static_cast&lt;ProgressBar*&gt;(getWindow(name, &quot;ProgressBar&quot;));
-	}
-
-	MenuBase* AbstractWindow::getMenu(const char* name)
-	{
-		return static_cast&lt;MenuBase*&gt;(getWindow(name, &quot;MenuBase&quot;));
-	}
-
-	MenuItem* AbstractWindow::getMenuItem(const char* name)
-	{
-		return static_cast&lt;MenuItem*&gt;(getWindow(name, &quot;MenuItem&quot;));
-	}
-
-	PushButton* AbstractWindow::getPushButton(const char* name)
-	{
-		return static_cast&lt;PushButton*&gt;(getWindow(name, &quot;PushButton&quot;));
-	}
-
-	Combobox* AbstractWindow::getCombobox(const char* name)
-	{
-		return static_cast&lt;Combobox*&gt;(getWindow(name, &quot;Combobox&quot;));
-	}
-
-	ComboDropList* AbstractWindow::getComboDropList(const char* name)
-	{
-		return static_cast&lt;ComboDropList*&gt;(getWindow(name, &quot;ComboDropList&quot;));
-	}
-
-    ScrollablePane* AbstractWindow::getScrollablePane(const char* name)
-    {
-		return static_cast&lt;ScrollablePane*&gt;(getWindow(name, &quot;ScrollablePane&quot;));
-    }
-
-	Slider* AbstractWindow::getSlider(const char* name)
-	{
-		return static_cast&lt;Slider*&gt;(getWindow(name, &quot;Slider&quot;));
-	}
-
-	TabControl* AbstractWindow::getTabControl(const char* name)
-	{
-		return static_cast&lt;TabControl*&gt;(getWindow(name, &quot;TabControl&quot;));
-	}
-
-	const CeGuiString&amp; AbstractWindow::getName() const
-	{
-		return mName;
-	}
-
-	void AbstractWindow::centerWindow()
-	{
-		CEGUI::Size screenSize = System::getSingleton().getRenderer()-&gt;getSize();
-		CEGUI::Size windowSize = mWindow-&gt;getPixelSize();
-		float x = 0.5f * (screenSize.d_width - windowSize.d_width);
-		float y = 0.5f * (screenSize.d_height - windowSize.d_height);
-		mWindow-&gt;setPosition(CeGuiHelper::asAbsolute(CEGUI::Vector2(x, y)));
-	}
-
-	void AbstractWindow::bindDestroyWindowToClick(CEGUI::Window* button)
-	{
-		button-&gt;subscribeEvent(Window::EventMouseClick,
-			boost::bind(&amp;AbstractWindow::destroyWindow, this));
-	}
-
-    void AbstractWindow::bindHideWindowToClick(CEGUI::Window* button)
-	{
-		button-&gt;subscribeEvent(Window::EventMouseClick,
-			boost::bind(&amp;AbstractWindow::hideWindow, this));
-	}
-
-	void AbstractWindow::bindDestroyWindowToXButton()
-	{
-		mWindow-&gt;subscribeEvent(FrameWindow::EventCloseClicked,
-			boost::bind(&amp;AbstractWindow::destroyWindow, this));
-	}
-
-	void AbstractWindow::bindHideWindowToXButton()
-	{
-		mWindow-&gt;subscribeEvent(FrameWindow::EventCloseClicked,
-			boost::bind(&amp;AbstractWindow::hideWindow, this));
-	}
-
-	bool AbstractWindow::destroyWindow()
-	{
-		setVisible(false, true);
-		return true;
-	}
-
-	bool AbstractWindow::hideWindow()
-	{
-		setVisible(false);
-		return true;
-	}
-
-	CEGUI::Window* AbstractWindow::getWindow()
-	{
-		return mWindow;
-	}
-
-	const CeGuiString&amp; AbstractWindow::getNamePrefix() const
-	{
-		return mNamePrefix;
-	}
-
-	void AbstractWindow::windowHid()
-	{
-	}
-
-}
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+#include &quot;stdinc.h&quot; //precompiled header
+
+#include &lt;boost/bind.hpp&gt;
+#include &lt;CEGUIWindowManager.h&gt;
+#include &lt;elements/CEGUIFrameWindow.h&gt;
+
+#include &quot;UiPrerequisites.h&quot;
+#include &quot;Exception.h&quot;
+
+#include &quot;UiSubsystem.h&quot;
+#include &quot;AbstractWindow.h&quot;
+#include &quot;CeGuiHelper.h&quot;
+#include &quot;WindowManager.h&quot;
+#include &quot;WindowFadeJob.h&quot;
+#include &quot;JobScheduler.h&quot;
+
+using namespace std;
+using namespace CEGUI;
+using namespace Ogre;
+
+namespace rl
+{
+
+	int AbstractWindow::sNumAbstractWindows = 0;
+
+	AbstractWindow::AbstractWindow(const CeGuiString&amp; xmlfile, int inputType, bool closeOnEscape, bool modal)
+	: mVisible(false),
+		mModal(modal),
+		mWindowInputType(inputType),
+		mCloseOnEscape(closeOnEscape)
+	{
+        LOG_MESSAGE(Logger::UI,
+		    &quot;Lade Fenster '&quot; + Ogre::String(xmlfile.c_str()) + &quot;'&quot;);
+   		mWindow = AbstractWindow::loadWindow(xmlfile, mNamePrefix);
+		if (mWindow == NULL)
+		{
+			Throw(rl::IllegalStateException, Ogre::String(&quot;Could not load window '&quot;)+xmlfile.c_str()+&quot;'.&quot;);
+		}
+
+		getRoot()-&gt;addChildWindow(mWindow);
+
+        if (modal)
+		{
+			mWindow-&gt;setModalState(true);
+			mWindow-&gt;setAlwaysOnTop(true);
+            mWindow-&gt;moveToFront();
+            mWindow-&gt;show();
+		}
+        else
+        {
+       		mWindow-&gt;hide();
+        }
+
+		mNormalAlpha = mWindow-&gt;getAlpha();
+		mName = mWindow-&gt;getName();
+		WindowManager::getSingleton().registerWindow(this);
+		mWindow-&gt;subscribeEvent(Window::EventActivated,
+			boost::bind(
+				&amp;rl::WindowManager::handleMovedToFront,
+				rl::WindowManager::getSingletonPtr(),
+				this));
+	}
+
+	AbstractWindow::~AbstractWindow()
+	{
+		mWindow-&gt;hide();
+		mWindow-&gt;removeAllEvents();
+		WindowManager::getSingleton().unregisterWindow(this);
+		getRoot()-&gt;removeChildWindow(mWindow);
+		CEGUI::WindowManager::getSingleton().destroyWindow(mWindow);
+	}
+
+	CEGUI::Window* AbstractWindow::loadWindow(const CeGuiString&amp; xmlfile)
+	{
+		CeGuiString prefix = &quot;&quot;;
+		return loadWindow(xmlfile, prefix);
+	}
+
+
+	CEGUI::Window* AbstractWindow::loadWindow(const CeGuiString&amp; xmlfile, CeGuiString&amp; prefix)
+	{
+		CeGuiString namePrefix;
+		if (prefix == &quot;&quot;)
+			prefix.assign(StringConverter::toString(sNumAbstractWindows));
+		sNumAbstractWindows++;
+
+		CEGUI::Window* window = NULL;
+		try
+		{
+			window = CEGUI::WindowManager::getSingleton().loadWindowLayout(xmlfile, prefix);
+		}
+		catch(...)
+		{
+		}
+
+		return window;
+	}
+
+	bool AbstractWindow::isVisible()
+	{
+		return mVisible;
+	}
+
+	void AbstractWindow::setVisible(bool visible, bool destroy)
+	{
+		if(mVisible != visible)
+		{
+			if (visible)
+			{
+                JobScheduler::getSingleton().addJob(
+                    new WindowFadeJob(this, WindowFadeJob::FADE_IN, mNormalAlpha));
+			}
+			else
+			{
+                JobScheduler::getSingleton().addJob(
+                    new WindowFadeJob(this,
+                    destroy ? WindowFadeJob::FADE_OUT_AND_DESTROY : WindowFadeJob::FADE_OUT,
+                    0.0f));
+			}
+            WindowManager::getSingleton()._visiblityChanged(this, visible);
+            mVisible = visible;
+		}
+	}
+
+	const Ogre::Real&amp; AbstractWindow::getNormalAlpha() const
+	{
+		return mNormalAlpha;
+	}
+
+	bool AbstractWindow::isModal()
+	{
+		return mModal;
+	}
+
+	bool AbstractWindow::isClosingOnEscape()
+	{
+		return mCloseOnEscape;
+	}
+
+	int AbstractWindow::getWindowInputType()
+	{
+		return mWindowInputType;
+	}
+
+	CEGUI::Window* AbstractWindow::getRoot()
+	{
+		return CEGUI::WindowManager::getSingleton().getWindow(
+			(utf8*)UiSubsystem::CEGUI_ROOT);
+	}
+
+	Window* AbstractWindow::getWindow(const char* name, const char* requiredClass)
+	{
+		CEGUI::Window* wnd =
+			CEGUI::WindowManager::getSingleton().getWindow(
+				mNamePrefix + (utf8*)name);
+
+		if (wnd == NULL)
+			Throw(
+				rl::NullPointerException,
+				&quot;Window &quot;
+				+ Ogre::String(name)
+				+ &quot; is NULL&quot;);
+
+		if (requiredClass != NULL &amp;&amp; !wnd-&gt;testClassName(requiredClass)) {
+            Throw(
+				rl::NullPointerException,
+				&quot;Window &quot;
+				+ Ogre::String(name)
+				+ &quot; has not the required class &quot;
+				+ Ogre::String(requiredClass));
+        }
+
+		return wnd;
+	}
+
+	Editbox* AbstractWindow::getEditbox(const char* name)
+	{
+		return static_cast&lt;Editbox*&gt;(getWindow(name, &quot;Editbox&quot;));
+	}
+    
+	Checkbox* AbstractWindow::getCheckbox(const char* name)
+	{
+		return static_cast&lt;Checkbox*&gt;(getWindow(name, &quot;Checkbox&quot;));
+	}
+    
+	Listbox* AbstractWindow::getListbox(const char* name)
+	{
+		return static_cast&lt;Listbox*&gt;(getWindow(name, &quot;Listbox&quot;));
+	}
+
+	MultiColumnList* AbstractWindow::getMultiColumnList(const char* name)
+	{
+		return static_cast&lt;MultiColumnList*&gt;(getWindow(name, &quot;MultiColumnList&quot;));
+	}
+
+	MultiLineEditbox* AbstractWindow::getMultiLineEditbox(const char* name)
+	{
+		return static_cast&lt;MultiLineEditbox*&gt;(getWindow(name, &quot;MultiLineEditbox&quot;));
+	}
+
+	ProgressBar* AbstractWindow::getProgressBar(const char* name)
+	{
+		return static_cast&lt;ProgressBar*&gt;(getWindow(name, &quot;ProgressBar&quot;));
+	}
+
+	MenuBase* AbstractWindow::getMenu(const char* name)
+	{
+		return static_cast&lt;MenuBase*&gt;(getWindow(name, &quot;MenuBase&quot;));
+	}
+
+	MenuItem* AbstractWindow::getMenuItem(const char* name)
+	{
+		return static_cast&lt;MenuItem*&gt;(getWindow(name, &quot;MenuItem&quot;));
+	}
+
+	PushButton* AbstractWindow::getPushButton(const char* name)
+	{
+		return static_cast&lt;PushButton*&gt;(getWindow(name, &quot;PushButton&quot;));
+	}
+
+	Combobox* AbstractWindow::getCombobox(const char* name)
+	{
+		return static_cast&lt;Combobox*&gt;(getWindow(name, &quot;Combobox&quot;));
+	}
+
+	ComboDropList* AbstractWindow::getComboDropList(const char* name)
+	{
+		return static_cast&lt;ComboDropList*&gt;(getWindow(name, &quot;ComboDropList&quot;));
+	}
+
+    ScrollablePane* AbstractWindow::getScrollablePane(const char* name)
+    {
+		return static_cast&lt;ScrollablePane*&gt;(getWindow(name, &quot;ScrollablePane&quot;));
+    }
+
+	Slider* AbstractWindow::getSlider(const char* name)
+	{
+		return static_cast&lt;Slider*&gt;(getWindow(name, &quot;Slider&quot;));
+	}
+
+	TabControl* AbstractWindow::getTabControl(const char* name)
+	{
+		return static_cast&lt;TabControl*&gt;(getWindow(name, &quot;TabControl&quot;));
+	}
+
+	const CeGuiString&amp; AbstractWindow::getName() const
+	{
+		return mName;
+	}
+
+	void AbstractWindow::centerWindow()
+	{
+		CEGUI::Size screenSize = System::getSingleton().getRenderer()-&gt;getSize();
+		CEGUI::Size windowSize = mWindow-&gt;getPixelSize();
+		float x = 0.5f * (screenSize.d_width - windowSize.d_width);
+		float y = 0.5f * (screenSize.d_height - windowSize.d_height);
+		mWindow-&gt;setPosition(CeGuiHelper::asAbsolute(CEGUI::Vector2(x, y)));
+	}
+
+	void AbstractWindow::bindDestroyWindowToClick(CEGUI::Window* button)
+	{
+		button-&gt;subscribeEvent(Window::EventMouseClick,
+			boost::bind(&amp;AbstractWindow::destroyWindow, this));
+	}
+
+    void AbstractWindow::bindHideWindowToClick(CEGUI::Window* button)
+	{
+		button-&gt;subscribeEvent(Window::EventMouseClick,
+			boost::bind(&amp;AbstractWindow::hideWindow, this));
+	}
+
+	void AbstractWindow::bindDestroyWindowToXButton()
+	{
+		mWindow-&gt;subscribeEvent(FrameWindow::EventCloseClicked,
+			boost::bind(&amp;AbstractWindow::destroyWindow, this));
+	}
+
+	void AbstractWindow::bindHideWindowToXButton()
+	{
+		mWindow-&gt;subscribeEvent(FrameWindow::EventCloseClicked,
+			boost::bind(&amp;AbstractWindow::hideWindow, this));
+	}
+
+	bool AbstractWindow::destroyWindow()
+	{
+		setVisible(false, true);
+		return true;
+	}
+
+	bool AbstractWindow::hideWindow()
+	{
+		setVisible(false);
+		return true;
+	}
+
+	CEGUI::Window* AbstractWindow::getWindow()
+	{
+		return mWindow;
+	}
+
+	const CeGuiString&amp; AbstractWindow::getNamePrefix() const
+	{
+		return mNamePrefix;
+	}
+
+	void AbstractWindow::windowHid()
+	{
+	}
+
+}

Added: rl/trunk/engine/ui/src/CharacterSelectionWindow.cpp
===================================================================
--- rl/trunk/engine/ui/src/CharacterSelectionWindow.cpp	2008-11-26 13:52:22 UTC (rev 4611)
+++ rl/trunk/engine/ui/src/CharacterSelectionWindow.cpp	2008-11-26 19:07:20 UTC (rev 4612)
@@ -0,0 +1,149 @@
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+#include &quot;stdinc.h&quot;
+
+#include &quot;CharacterSelectionWindow.h&quot;
+
+#include &quot;Creature.h&quot;
+#include &quot;PartyManager.h&quot;
+#include &quot;RulesMessages.h&quot;
+
+using namespace CEGUI;
+
+namespace rl
+{
+    CharacterSelectionWindow::CharacterSelectionWindow()
+    : AbstractWindow(&quot;characterselectionwindow.xml&quot;, WIT_MOUSE_INPUT, false)
+    {
+        mCharacterWindow = getWindow(&quot;CharacterSelectionWindow/Characters&quot;);
+        mCharacterAddedConnection = MessagePump::getSingleton().
+            addMessageHandler&lt;MessageType_PlayerCharAdded&gt;(boost::bind(&amp;CharacterSelectionWindow::update, this));
+        mCharacterRemovedConnection = MessagePump::getSingleton().
+            addMessageHandler&lt;MessageType_PlayerCharRemoved&gt;(boost::bind(&amp;CharacterSelectionWindow::update, this));
+    }
+    
+    CharacterSelectionWindow::~CharacterSelectionWindow()
+    {
+        while (0 &gt; mCharacterWindows.size())
+        {
+            Element* elem = mCharacterWindows.back();
+            mCharacterWindows.pop_back();
+            mCharacterWindow-&gt;removeChildWindow(elem-&gt;getWindow());
+            delete elem;
+        }        
+    }
+    
+    bool CharacterSelectionWindow::update()
+    {
+        Party party = PartyManager::getSingleton().getCharacters();
+        
+        while (party.size() &gt; mCharacterWindows.size())
+        {
+            Element* elem = new Element(this);
+            mCharacterWindow-&gt;addChildWindow(elem-&gt;getWindow());
+            CEGUI::Rect size = elem-&gt;getWindow()-&gt;getPixelRect();
+            size_t windowNum = mCharacterWindows.size();
+            elem-&gt;getWindow()-&gt;setPosition(UVector2(UDim(0, 0), UDim(0, windowNum * size.getHeight())));
+            elem-&gt;setVisible(true);
+            elem-&gt;getWindow()-&gt;subscribeEvent(
+                 Window::EventMouseClick,
+                 boost::bind(&amp;CharacterSelectionWindow::handleClickOnCharacter, this, windowNum));
+            
+            mCharacterWindows.push_back(elem);
+        }
+        
+        while (party.size() &lt; mCharacterWindows.size())
+        {
+            Element* elem = mCharacterWindows.back();
+            mCharacterWindows.pop_back();
+            mCharacterWindow-&gt;removeChildWindow(elem-&gt;getWindow());
+            delete elem;
+        }
+        
+        for (int i = 0; i &lt; party.size(); ++i)
+        {
+            mCharacterWindows[i]-&gt;setCreature(party[i]);
+        }
+        
+        return true;
+    }
+    
+    bool CharacterSelectionWindow::handleClickOnCharacter(size_t index)
+    {
+        Party party = PartyManager::getSingleton().getCharacters();
+        PartyManager::getSingleton().setActiveCharacter(party[index]);
+        return true;
+    }
+
+    CharacterSelectionWindow::Element::Element(CharacterSelectionWindow* parent)
+    :  AbstractWindow(&quot;characterselectionwindow_character.xml&quot;, WIT_NONE, false), 
+       mParent(parent),
+       mCreature(NULL),
+       mTextName(NULL)
+    {
+        mTextName = getWindow(&quot;CharacterSelectionWindow/Character/Name&quot;);
+        mPortrait = getWindow(&quot;CharacterSelectionWindow/Character/Picture&quot;);
+        mLP = getProgressBar(&quot;CharacterSelectionWindow/Character/LP&quot;);
+    }
+    
+    CharacterSelectionWindow::Element::~Element()
+    {
+        setCreature(NULL);
+    }
+    
+    void CharacterSelectionWindow::Element::setCreature(Creature* creature)
+    {
+        if (mCreature)
+        {
+            mCreature-&gt;removeObjectStateChangeListener(this);
+        }
+
+        
+        if (creature) 
+        {
+            creature-&gt;addObjectStateChangeListener(this);
+            mTextName-&gt;setText(creature-&gt;getName());
+            mPortrait-&gt;setProperty(&quot;Image&quot;, creature-&gt;getImageName());
+        }
+        else 
+        {
+            mTextName-&gt;setText(&quot;&quot;);
+        }
+
+        mCreature = creature;
+        update();            
+    }
+    
+    void CharacterSelectionWindow::Element::objectStateChanged(ObjectStateChangeEvent* evt)
+    {
+        update();
+    }
+    
+    
+    void CharacterSelectionWindow::Element::update()
+    {
+        float lep;
+        if (!mCreature || mCreature-&gt;getLeMax() &lt;= 0)
+        {
+            lep = 0.0;        
+        }
+        else
+        {
+            lep = (float)mCreature-&gt;getLe() / (float)mCreature-&gt;getLeMax();        
+        }
+        mLP-&gt;setProgress(lep);
+    }
+}

Modified: rl/trunk/engine/ui/src/GameSettings.cpp
===================================================================
--- rl/trunk/engine/ui/src/GameSettings.cpp	2008-11-26 13:52:22 UTC (rev 4611)
+++ rl/trunk/engine/ui/src/GameSettings.cpp	2008-11-26 19:07:20 UTC (rev 4612)
@@ -25,6 +25,8 @@
 #include &quot;SoundManager.h&quot;
 #include &quot;SoundDriver.h&quot;
 
+using namespace Ogre;
+
 namespace rl
 {
     GameSettings::GameSettings()
@@ -46,8 +48,12 @@
         getWindow()-&gt;subscribeEvent(CEGUI::FrameWindow::EventCloseClicked,
                                     boost::bind(&amp;GameSettings::onCancel, this));
 
+        mVideoRenderer = getCombobox(&quot;GameOptionsWindow/Video/Renderer&quot;);
+        mVideoResolution = getCombobox(&quot;GameOptionsWindow/Video/Resolution&quot;);
+        mVideoFullscreen = getCheckbox(&quot;GameOptionsWindow/Video/Fullscreen&quot;);
         centerWindow();
         setVisible(false);
+        update();
     }
 
     GameSettings::~GameSettings()
@@ -127,4 +133,54 @@
     {
         return true;
     }
+    
+    void GameSettings::update()
+    {
+        Root* root = Ogre::Root::getSingletonPtr();
+        RenderSystem* renderer = root-&gt;getRenderSystem();
+        
+        ConfigOptionMap config = renderer-&gt;getConfigOptions();
+        
+		ConfigOptionMap::iterator cfi;
+		
+		cfi = config.find( &quot;Full Screen&quot; );
+		if( cfi != config.end() )
+		{
+			mVideoFullscreen-&gt;setSelected(cfi-&gt;second.currentValue == &quot;Yes&quot;);
+		}
+        
+/*		cfi = config.find( &quot;FSAA&quot; );
+		if( cfi != config.end() )
+		{
+			if( cfi-&gt;second.currentValue == &quot;0&quot; )
+			{
+				SetControlValue( iFSAARef, 1 );
+			}
+			else if( cfi-&gt;second.currentValue == &quot;2&quot; )
+			{
+				SetControlValue( iFSAARef, 2 );
+			}
+			else if( cfi-&gt;second.currentValue == &quot;4&quot; )
+			{
+				SetControlValue( iFSAARef, 3 );
+			}
+			else if( cfi-&gt;second.currentValue == &quot;6&quot; )
+			{
+				SetControlValue( iFSAARef, 4 );
+			}
+		}
+        
+		cfi = config.find( &quot;Colour Depth&quot; );
+		if( cfi != config.end() )
+		{
+			if( cfi-&gt;second.currentValue == &quot;32&quot; )
+			{
+				SetControlValue( iColorDepthRef, 1 );
+			}
+			else
+			{
+				SetControlValue( iColorDepthRef, 2 );
+			}
+		}*/
+    }
 }

Modified: rl/trunk/engine/ui/src/InventoryWindow.cpp
===================================================================
--- rl/trunk/engine/ui/src/InventoryWindow.cpp	2008-11-26 13:52:22 UTC (rev 4611)
+++ rl/trunk/engine/ui/src/InventoryWindow.cpp	2008-11-26 19:07:20 UTC (rev 4612)
@@ -174,7 +174,6 @@
     ItemDragContainer* InventoryWindow::getItemDragContainer(const Item* item, bool description)
     {
 		CeGuiString dragContainerName = getDragContainerNameFromItem(item, description);
-		ItemDragContainer* itemhandler = NULL;
 
 		DndContainerMap::iterator iter = mWorldDragContainers.find(dragContainerName);
         if( iter != mWorldDragContainers.end() )


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001668.html">[Dsa-hl-svn] r4611 - in rl/trunk: . cmake plugins	plugins/fmod4driver
</A></li>
	<LI>Next message: <A HREF="001670.html">[Dsa-hl-svn] r4613 - in rl/branches/persistence: core/src	rules/include rules/src script/swig ui ui/include ui/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1669">[ date ]</a>
              <a href="thread.html#1669">[ thread ]</a>
              <a href="subject.html#1669">[ subject ]</a>
              <a href="author.html#1669">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
