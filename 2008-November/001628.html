<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r4571 - in rl/branches/newton20: editors/Lockenwickler	editors/Lockenwickler/src editors/Lockenwickler/src/media/icons	editors/Lockenwickler/ui files engine/ui/include engine/ui/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4571%20-%20in%20rl/branches/newton20%3A%20editors/Lockenwickler%0A%09editors/Lockenwickler/src%20editors/Lockenwickler/src/media/icons%0A%09editors/Lockenwickler/ui%20files%20engine/ui/include%20engine/ui/src&In-Reply-To=%3C200811031550.mA3Fo4XT004499%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="001629.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r4571 - in rl/branches/newton20: editors/Lockenwickler	editors/Lockenwickler/src editors/Lockenwickler/src/media/icons	editors/Lockenwickler/ui files engine/ui/include engine/ui/src</H1>
    <B>melven at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4571%20-%20in%20rl/branches/newton20%3A%20editors/Lockenwickler%0A%09editors/Lockenwickler/src%20editors/Lockenwickler/src/media/icons%0A%09editors/Lockenwickler/ui%20files%20engine/ui/include%20engine/ui/src&In-Reply-To=%3C200811031550.mA3Fo4XT004499%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r4571 - in rl/branches/newton20: editors/Lockenwickler	editors/Lockenwickler/src editors/Lockenwickler/src/media/icons	editors/Lockenwickler/ui files engine/ui/include engine/ui/src">melven at mail.berlios.de
       </A><BR>
    <I>Mon Nov  3 16:50:04 CET 2008</I>
    <P><UL>
        
        <LI>Next message: <A HREF="001629.html">[Dsa-hl-svn] r4572 - in rl/trunk/editors/Lockenwickler/src: . media	media/icons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1628">[ date ]</a>
              <a href="thread.html#1628">[ thread ]</a>
              <a href="subject.html#1628">[ subject ]</a>
              <a href="author.html#1628">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: melven
Date: 2008-11-03 16:49:51 +0100 (Mon, 03 Nov 2008)
New Revision: 4571

Added:
   rl/branches/newton20/editors/Lockenwickler/src/GOStringEditor.py
   rl/branches/newton20/editors/Lockenwickler/src/GameObjectClass.py
   rl/branches/newton20/editors/Lockenwickler/src/GameObjectClassManager.py
   rl/branches/newton20/editors/Lockenwickler/src/GameObjectClassView.py
   rl/branches/newton20/editors/Lockenwickler/src/MyRaySceneQueryListener.py
   rl/branches/newton20/editors/Lockenwickler/src/Ui_GOPropertyEditorDialogSTRING.py
   rl/branches/newton20/editors/Lockenwickler/src/media/icons/agt_games.png
   rl/branches/newton20/editors/Lockenwickler/src/media/icons/agt_multimedia.png
   rl/branches/newton20/editors/Lockenwickler/src/media/icons/lockenwickler_provisorium.png
   rl/branches/newton20/editors/Lockenwickler/src/media/icons/lockenwickler_provisorium_small.png
   rl/branches/newton20/editors/Lockenwickler/src/media/icons/multirow.png
   rl/branches/newton20/editors/Lockenwickler/ui files/GOPropertyEditorDialogINT.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/GOPropertyEditorDialogSTRING.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/PropertyEditorDialog.ui
Removed:
   rl/branches/newton20/editors/Lockenwickler/ui files/FourPanelView.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/batch_convert_ui.py
   rl/branches/newton20/editors/Lockenwickler/ui files/console_window.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/lockewickler.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/model_preview.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/object_property.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/preferences_dialog.ui
   rl/branches/newton20/editors/Lockenwickler/ui files/ui_ConsoleWindow.py
   rl/branches/newton20/editors/Lockenwickler/ui files/ui_FourPanelView.py
   rl/branches/newton20/editors/Lockenwickler/ui files/ui_lw.py
   rl/branches/newton20/editors/Lockenwickler/ui files/ui_model_prev.py
   rl/branches/newton20/editors/Lockenwickler/ui files/ui_obj_prop.py
   rl/branches/newton20/editors/Lockenwickler/ui files/ui_pref_dialog.py
Modified:
   rl/branches/newton20/editors/Lockenwickler/Lockenwickler.e4p
   rl/branches/newton20/editors/Lockenwickler/src/ConsoleWindow.py
   rl/branches/newton20/editors/Lockenwickler/src/Lockenwickler.py
   rl/branches/newton20/editors/Lockenwickler/src/ModelSelectionDialog.py
   rl/branches/newton20/editors/Lockenwickler/src/ModuleManager.py
   rl/branches/newton20/editors/Lockenwickler/src/OgreMainWindow.py
   rl/branches/newton20/editors/Lockenwickler/src/Plugins-linux.cfg
   rl/branches/newton20/editors/Lockenwickler/src/PreferencesDialog.py
   rl/branches/newton20/engine/ui/include/CombatControlState.h
   rl/branches/newton20/engine/ui/src/CombatControlState.cpp
   rl/branches/newton20/engine/ui/src/CombatGui.cpp
Log:
-merged changes from trunk (Lockenwickler)
-implemented camera-movement with third-person view (if zooming in) in the combat-control-state,
 (works, but needs still some improvements to make it look nicer!)


Modified: rl/branches/newton20/editors/Lockenwickler/Lockenwickler.e4p
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/Lockenwickler.e4p	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/Lockenwickler.e4p	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,7 +1,7 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
 &lt;!DOCTYPE Project SYSTEM &quot;Project-4.5.dtd&quot;&gt;
 &lt;!-- eric4 project file for project Lockenwickler --&gt;
-&lt;!-- Saved: 2008-10-16, 19:21:23 --&gt;
+&lt;!-- Saved: 2008-10-31, 11:20:58 --&gt;
 &lt;!-- Copyright (C) 2008 Stefan Stammberger, <A HREF="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">sstammberger at web.de</A> --&gt;
 &lt;Project version=&quot;4.5&quot;&gt;
   &lt;ProgLanguage mixed=&quot;0&quot;&gt;Python&lt;/ProgLanguage&gt;
@@ -23,25 +23,20 @@
     &lt;Source&gt;src/PythonOgreConfig.py&lt;/Source&gt;
     &lt;Source&gt;src/ui_ConsoleWindow.py&lt;/Source&gt;
     &lt;Source&gt;src/ui_pref_dialog.py&lt;/Source&gt;
-    &lt;Source&gt;ui files/batch_convert_ui.py&lt;/Source&gt;
-    &lt;Source&gt;ui files/ui_ConsoleWindow.py&lt;/Source&gt;
-    &lt;Source&gt;ui files/ui_FourPanelView.py&lt;/Source&gt;
-    &lt;Source&gt;ui files/ui_lw.py&lt;/Source&gt;
-    &lt;Source&gt;ui files/ui_model_prev.py&lt;/Source&gt;
-    &lt;Source&gt;ui files/ui_obj_prop.py&lt;/Source&gt;
-    &lt;Source&gt;ui files/ui_pref_dialog.py&lt;/Source&gt;
     &lt;Source&gt;src/SceneExplorer.py&lt;/Source&gt;
     &lt;Source&gt;src/Property.py&lt;/Source&gt;
     &lt;Source&gt;src/ViewportGrid.py&lt;/Source&gt;
     &lt;Source&gt;src/ObjectPropertyModel.py&lt;/Source&gt;
+    &lt;Source&gt;src/GameObjectClass.py&lt;/Source&gt;
+    &lt;Source&gt;src/GameObjectClassManager.py&lt;/Source&gt;
+    &lt;Source&gt;src/setup.py&lt;/Source&gt;
+    &lt;Source&gt;src/GameObjectClassView.py&lt;/Source&gt;
+    &lt;Source&gt;src/MyRaySceneQueryListener.py&lt;/Source&gt;
+    &lt;Source&gt;src/GOStringEditor.py&lt;/Source&gt;
   &lt;/Sources&gt;
   &lt;Forms&gt;
-    &lt;Form&gt;ui files/console_window.ui&lt;/Form&gt;
-    &lt;Form&gt;ui files/FourPanelView.ui&lt;/Form&gt;
-    &lt;Form&gt;ui files/lockewickler.ui&lt;/Form&gt;
-    &lt;Form&gt;ui files/model_preview.ui&lt;/Form&gt;
-    &lt;Form&gt;ui files/object_property.ui&lt;/Form&gt;
-    &lt;Form&gt;ui files/preferences_dialog.ui&lt;/Form&gt;
+    &lt;Form&gt;ui files/GOPropertyEditorDialogINT.ui&lt;/Form&gt;
+    &lt;Form&gt;ui files/GOPropertyEditorDialogSTRING.ui&lt;/Form&gt;
   &lt;/Forms&gt;
   &lt;Translations&gt;
   &lt;/Translations&gt;

Modified: rl/branches/newton20/editors/Lockenwickler/src/ConsoleWindow.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/src/ConsoleWindow.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/src/ConsoleWindow.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,74 +1,74 @@
-#################################################
- # Copyright (C) 2008  Stefan Stammberger
- #
- # This library is free software; you can redistribute it and/or
- # modify it under the terms of the GNU Lesser General Public
- # License as published by the Free Software Foundation; either
- # version 2.1 of the License, or (at your option) any later version.
- #
- # This library is distributed in the hope that it will be useful,
- # but WITHOUT ANY WARRANTY; without even the implied warranty of
- # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- # Lesser General Public License for more details.
- #
- # You should have received a copy of the GNU Lesser General Public
- # License along with this library; if not, write to the Free Software
- # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
- #################################################
-
-
-import sys
-from PyQt4.QtCore import *
-from PyQt4.QtGui import *
-
-from ui_ConsoleWindow import *
-import ogre.renderer.OGRE as og
-
-
-
-class LockenLog(og.LogListener):
-    def __init__(self, logFunction):
-        og.LogListener.__init__(self)
-        self.logFunction = logFunction
-
-    def messageLogged(self, message, level, debug, logName):
-        self.logFunction(str(message))
-
-class ConsoleWindow(QtGui.QDialog):
-    def __init__(self, filterLog, parent=None):
-        QtGui.QDialog.__init__(self, parent)
-        self.filterLog = filterLog
-
-        self.consoleWindow = Ui_ConsoleWindow()
-        self.consoleWindow.setupUi(self)
-        self.consoleWindow.textEdit.setReadOnly(True)
-        self.lockenLog = LockenLog(self.write)
-
-        sys.stdout = self
-        sys.stderr = self
-
-        clearAction= QAction(&quot;Clear Window&quot;,  self)
-        self.consoleWindow.textEdit.addAction(clearAction)
-        self.consoleWindow.textEdit.setContextMenuPolicy(Qt.ActionsContextMenu)
-        clearAction.setShortcut(&quot;Ctrl + R&quot;)
-        self.connect(clearAction, SIGNAL(&quot;triggered()&quot;), self.consoleWindow.textEdit.clear)
-
-
-    def write(self, text):
-        if self.filterLog:
-            if text.isspace():
-                return
-            elif text.startswith(&quot;Error&quot;):
-                self.consoleWindow.textEdit.append(text)
-                return
-            elif text.startswith(&quot;OGRE EXCEPTION&quot;):
-                self.consoleWindow.textEdit.append(text)
-                return
-            elif text.startswith(&quot;dbg:&quot;):
-                self.consoleWindow.textEdit.append(text)
-                return
-        else:
-            self.consoleWindow.textEdit.append(text)
-
-    def clear(self):
-        self.consoleWindow.textEdit.clear()
+#################################################
+ # Copyright (C) 2008  Stefan Stammberger
+ #
+ # This library is free software; you can redistribute it and/or
+ # modify it under the terms of the GNU Lesser General Public
+ # License as published by the Free Software Foundation; either
+ # version 2.1 of the License, or (at your option) any later version.
+ #
+ # This library is distributed in the hope that it will be useful,
+ # but WITHOUT ANY WARRANTY; without even the implied warranty of
+ # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ # Lesser General Public License for more details.
+ #
+ # You should have received a copy of the GNU Lesser General Public
+ # License along with this library; if not, write to the Free Software
+ # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ #################################################
+
+
+import sys
+from PyQt4.QtCore import *
+from PyQt4.QtGui import *
+
+from ui_ConsoleWindow import *
+import ogre.renderer.OGRE as og
+
+
+
+class LockenLog(og.LogListener):
+    def __init__(self, logFunction):
+        og.LogListener.__init__(self)
+        self.logFunction = logFunction
+
+    def messageLogged(self, message, level, debug, logName):
+        self.logFunction(str(message))
+
+class ConsoleWindow(QtGui.QDialog):
+    def __init__(self, filterLog, parent=None):
+        QtGui.QDialog.__init__(self, parent)
+        self.filterLog = filterLog
+
+        self.consoleWindow = Ui_ConsoleWindow()
+        self.consoleWindow.setupUi(self)
+        self.consoleWindow.textEdit.setReadOnly(True)
+        self.lockenLog = LockenLog(self.write)
+
+        sys.stdout = self
+        sys.stderr = self
+
+        clearAction= QAction(&quot;Clear Window&quot;,  self)
+        self.consoleWindow.textEdit.addAction(clearAction)
+        self.consoleWindow.textEdit.setContextMenuPolicy(Qt.ActionsContextMenu)
+        clearAction.setShortcut(&quot;Ctrl + R&quot;)
+        self.connect(clearAction, SIGNAL(&quot;triggered()&quot;), self.consoleWindow.textEdit.clear)
+
+
+    def write(self, text):
+        if self.filterLog:
+            if text.isspace():
+                return
+            elif text.startswith(&quot;Error&quot;):
+                self.consoleWindow.textEdit.append(text)
+                return
+            elif text.startswith(&quot;OGRE EXCEPTION&quot;):
+                self.consoleWindow.textEdit.append(text)
+                return
+            elif text.startswith(&quot;dbg:&quot;):
+                self.consoleWindow.textEdit.append(text)
+                return
+        else:
+            self.consoleWindow.textEdit.append(text)
+
+    def clear(self):
+        self.consoleWindow.textEdit.clear()

Copied: rl/branches/newton20/editors/Lockenwickler/src/GOStringEditor.py (from rev 4567, rl/trunk/editors/Lockenwickler/src/GOStringEditor.py)

Copied: rl/branches/newton20/editors/Lockenwickler/src/GameObjectClass.py (from rev 4567, rl/trunk/editors/Lockenwickler/src/GameObjectClass.py)
===================================================================
--- rl/trunk/editors/Lockenwickler/src/GameObjectClass.py	2008-10-27 20:25:20 UTC (rev 4567)
+++ rl/branches/newton20/editors/Lockenwickler/src/GameObjectClass.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -0,0 +1,176 @@
+#################################################
+ # Copyright (C) 2008  Stefan Stammberger
+ #
+ # This library is free software; you can redistribute it and/or
+ # modify it under the terms of the GNU Lesser General Public
+ # License as published by the Free Software Foundation; either
+ # version 2.1 of the License, or (at your option) any later version.
+ #
+ # This library is distributed in the hope that it will be useful,
+ # but WITHOUT ANY WARRANTY; without even the implied warranty of
+ # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ # Lesser General Public License for more details.
+ #
+ # You should have received a copy of the GNU Lesser General Public
+ # License along with this library; if not, write to the Free Software
+ # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ #################################################
+
+from elementtree.ElementTree import *
+
+from PyQt4.QtCore import *
+from PyQt4.QtGui import *
+
+from GOStringEditor import *
+
+class GOCStringProperty():
+    def __init__(self, name, data):
+        self.name = name
+        self.data = data
+
+    def getType(self):
+        return &quot;STRING&quot;
+
+    def openEditor(self, row, parent = None):
+        dlg = GOStringEditor(parent)
+        dlg.nameEdit.setText(self.name)
+        dlg.dataEdit.setText(self.data)
+        result = dlg.exec_()
+        if result:
+            self.name = dlg.nameEdit.text()
+            self.data = dlg.dataEdit.toPlainText()
+
+        return result
+
+class GOCRealProperty():
+    def __init__(self, name, data):
+        self.name = name
+        self.data = data
+
+    def getType(self):
+        return &quot;REAL&quot;
+
+class GOCBoolProperty():
+    def __init__(self, name, data):
+        self.name = name
+        self.data = data
+
+    def getType(self):
+        return &quot;BOOL&quot;
+
+class GOCIntProperty():
+    def __init__(self, name, data):
+        self.name = name
+        self.data = data
+
+    def getType(self):
+        return &quot;INT&quot;
+
+class GOCIntPairProperty():
+    def __init__(self, name, data):
+        self.name = name
+        self.data = data
+
+    def getType(self):
+        return &quot;INTPAIR&quot;
+
+class GOCIntTripleProperty():
+    def __init__(self, name, data):
+        self.name = name
+        self.data = data
+
+    def getType(self):
+        return &quot;INTTRIPPLE&quot;
+
+class GOCMapProperty():
+    def __init__(self, name):
+        self.name = name
+        self.childProperties = []
+
+    def getType(self):
+        return &quot;MAP&quot;
+
+class GameObjectRepresentation():
+    def __init__(self, inWorldId, gameObjectClass, node, meshFile = None):
+        self.inWorldId = inWorldId
+        self.goc = gameObjectClass
+        self.node = node
+        self.meshFile = meshFile
+
+    def setPosition(self, pos):
+        self.node.setPosition(pos)
+
+
+class GameObjectClass():
+    def __init__(self,  parentElement):
+        self.classid = parentElement.get(&quot;classid&quot;)
+        self.baseclass = parentElement.get(&quot;baseclass&quot;)
+
+        self.meshFile = None
+
+        self.properties = []
+
+        for property in parentElement:#.getiterator(&quot;property&quot;):
+            if property.get(&quot;type&quot;) == &quot;ARRAY&quot;:
+                pass
+            elif property.get(&quot;type&quot;) == &quot;MAP&quot;:
+                self.properties.append(self.createPropertyMap(property))
+            else:
+                self.properties.append(self.createProperty(property))
+
+    def getType(self):
+        return &quot;GAME_OBJECT&quot;
+
+    def createPropertyMap(self, property):
+        propMap = GOCMapProperty(property.get(&quot;name&quot;))
+        for subProperty in property:
+            if subProperty.get(&quot;type&quot;) == &quot;MAP&quot;:
+                propMap.childProperties.append(self.createPropertyMap(property))
+            else:
+                for subProperty1 in property:
+                    propMap.childProperties.append(self.createProperty(subProperty1))
+
+        return propMap
+
+    def getMeshFileName(self):
+        if self.meshFile is None:
+            for prop in self.properties:
+                if prop.getType() == &quot;STRING&quot;:
+                    if prop.name == &quot;meshfile&quot;:
+                        self.meshFile = prop.data
+                        return self.meshFile
+            return None
+        else:
+            return self.meshFile
+
+
+    def createProperty(self, property):
+        if property.get(&quot;type&quot;) == &quot;STRING&quot;:
+            name = property.get(&quot;name&quot;)
+            data = property.get(&quot;data&quot;)
+            return GOCStringProperty(name, data)
+        elif property.get(&quot;type&quot;) == &quot;REAL&quot;:
+            name = property.get(&quot;name&quot;)
+            data = property.get(&quot;data&quot;)
+            return GOCRealProperty(name, data)
+        elif property.get(&quot;type&quot;) == &quot;BOOL&quot;:
+            name = property.get(&quot;name&quot;)
+            data = property.get(&quot;data&quot;)
+            return GOCBoolProperty(name, data)
+        elif property.get(&quot;type&quot;) == &quot;INT&quot;:
+            name = property.get(&quot;name&quot;)
+            data = property.get(&quot;data&quot;)
+            return GOCIntProperty(name, data)
+        elif property.get(&quot;type&quot;) == &quot;INTPAIR&quot;:
+            name = property.get(&quot;name&quot;)
+            data = property.get(&quot;data&quot;)
+            return GOCIntPairProperty(name, data)
+        elif property.get(&quot;type&quot;) == &quot;INTTRIPLE&quot;:
+            name = property.get(&quot;name&quot;)
+            data = property.get(&quot;data&quot;)
+            return GOCIntTripleProperty(name, data)
+        else:
+            print property.get(&quot;type&quot;)
+
+
+

Copied: rl/branches/newton20/editors/Lockenwickler/src/GameObjectClassManager.py (from rev 4567, rl/trunk/editors/Lockenwickler/src/GameObjectClassManager.py)
===================================================================
--- rl/trunk/editors/Lockenwickler/src/GameObjectClassManager.py	2008-10-27 20:25:20 UTC (rev 4567)
+++ rl/branches/newton20/editors/Lockenwickler/src/GameObjectClassManager.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -0,0 +1,52 @@
+#################################################
+ # Copyright (C) 2008  Stefan Stammberger
+ #
+ # This library is free software; you can redistribute it and/or
+ # modify it under the terms of the GNU Lesser General Public
+ # License as published by the Free Software Foundation; either
+ # version 2.1 of the License, or (at your option) any later version.
+ #
+ # This library is distributed in the hope that it will be useful,
+ # but WITHOUT ANY WARRANTY; without even the implied warranty of
+ # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ # Lesser General Public License for more details.
+ #
+ # You should have received a copy of the GNU Lesser General Public
+ # License along with this library; if not, write to the Free Software
+ # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ #################################################
+
+from elementtree.ElementTree import parse
+
+from GameObjectClass import *
+
+class GameObjectClassManager():
+    def __init__(self):
+        self.fileDict = {}
+        self.callback = None
+
+    def parseGOFFiles(self, filePaths):
+        for filePath in filePaths:
+            tree = parse(filePath)
+            gocList = []
+            for parent in tree.getiterator(&quot;gameobjectclass&quot;): # return all allements with the &quot;gameobjectclass&quot; tag
+                go = GameObjectClass(parent)
+                gocList.append(go)
+
+            self.fileDict[filePath] = gocList
+
+        if self.callback is not None:
+            self.callback(self.fileDict)
+
+    def getGameObjectWithClassId(self, id):
+        for key in self.fileDict:
+            for go in self.fileDict[key]:
+                if go.classid == id:
+                    return go
+
+        return None
+
+        # whenever a gameobject changes outside of the view, the view has to update itself wth the new values
+    def setGameObjectsViewUpdateCallback(self, callback):
+        self.callback = callback
+

Copied: rl/branches/newton20/editors/Lockenwickler/src/GameObjectClassView.py (from rev 4567, rl/trunk/editors/Lockenwickler/src/GameObjectClassView.py)
===================================================================
--- rl/trunk/editors/Lockenwickler/src/GameObjectClassView.py	2008-10-27 20:25:20 UTC (rev 4567)
+++ rl/branches/newton20/editors/Lockenwickler/src/GameObjectClassView.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -0,0 +1,139 @@
+#################################################
+ # Copyright (C) 2008  Stefan Stammberger
+ #
+ # This library is free software; you can redistribute it and/or
+ # modify it under the terms of the GNU Lesser General Public
+ # License as published by the Free Software Foundation; either
+ # version 2.1 of the License, or (at your option) any later version.
+ #
+ # This library is distributed in the hope that it will be useful,
+ # but WITHOUT ANY WARRANTY; without even the implied warranty of
+ # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ # Lesser General Public License for more details.
+ #
+ # You should have received a copy of the GNU Lesser General Public
+ # License along with this library; if not, write to the Free Software
+ # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ #################################################
+
+
+from PyQt4.QtCore import *
+from PyQt4.QtGui import *
+
+from GameObjectClass import *
+
+# The drag events are processed in ObgreMainWindow.py
+
+class GoTreeWidget(QTreeWidget):
+    def __init__(self, parent = None):
+        super(GoTreeWidget, self).__init__(parent)
+        self.setDragEnabled(True)
+
+    def startDrag(self,  dropActions):
+        data = QByteArray()
+        stream = QDataStream(data,  QIODevice.WriteOnly)
+        stream &lt;&lt; self.currentItem().text(0)
+        mimeData = QMimeData()
+        mimeData.setData(&quot;application/x-game_object&quot;, data)
+        drag = QDrag(self)
+        drag.setMimeData(mimeData)
+        drag.start(Qt.CopyAction)
+
+class GameObjectClassView(QWidget):
+    def __init__(self, gocManager, parent = None):
+        super(GameObjectClassView, self).__init__(parent)
+        self.gocManager = gocManager
+        self.gocManager.setGameObjectsViewUpdateCallback(self.updateObjectList)
+
+        self.gameObjectDict = {}
+
+        self.setupUi()
+
+    def addItemToDict(self, property, item):
+        self.gameObjectDict[item] = property
+
+    def setupUi(self):
+        self.setObjectName(&quot;gameObjectClassView&quot;)
+        self.resize(QSize(QRect(0,0,272,744).size()).expandedTo(self.minimumSizeHint()))
+
+        self.gridlayout = QGridLayout(self)
+        self.gridlayout.setObjectName(&quot;gridlayout&quot;)
+
+        self.treeWidget = GoTreeWidget()
+        self.treeWidget.setColumnCount(3)
+        self.treeWidget.setObjectName(&quot;ObjectTreeView&quot;)
+
+        self.gridlayout.addWidget(self.treeWidget , 1, 0, 1, 1)
+
+        self.setWindowTitle(QApplication.translate(&quot;objectPreviewDialog&quot;, &quot;Dialog&quot;, None, QApplication.UnicodeUTF8))
+        self.connect(self.treeWidget, SIGNAL(&quot;itemDoubleClicked (QTreeWidgetItem *,int)&quot;), self.onDoubleClick)
+        QMetaObject.connectSlotsByName(self)
+
+    def onDoubleClick(self, item,  row):
+        if self.gameObjectDict[item].getType() == &quot;MAP&quot; or self.gameObjectDict[item].getType() == &quot;ARRAY&quot;or self.gameObjectDict[item].getType() == &quot;GAME_OBJECT&quot;:
+            print &quot;NOT YET :)&quot;
+        else:
+            if self.gameObjectDict[item].openEditor(row, self):
+                item.setText(0, str(self.gameObjectDict[item].name))
+                item.setText(2, str(self.gameObjectDict[item].data))
+
+
+
+    def createPropertyMapItem(self, property, parentItem):
+        for subProperty in property.childProperties:
+            if subProperty is not None:
+                if subProperty.getType() == &quot;MAP&quot;:
+                    item = QTreeWidgetItem(parentItem)
+                    self.addItemToDict(subProperty, item)
+                    item.setText(0, subProperty.name)
+                    item.setText(1, subProperty.getType())
+                    self.createPropertyMapItem(property, item)
+                else:
+                    item = QTreeWidgetItem(parentItem)
+                    self.addItemToDict(subProperty, item)
+                    item.setText(0, subProperty.name)
+                    item.setText(1, subProperty.getType())
+                    if not subProperty.getType() == &quot;ARRAY&quot;:
+                        item.setText(2, subProperty.data)
+
+
+    def updateObjectList(self,  objectsDict):
+        for key in objectsDict:
+            changeColor = True
+            file = objectsDict[key]
+            fileItem = QTreeWidgetItem(self.treeWidget)
+            fileItem.setText(0, str(key))
+            fileItem.setIcon(0, QIcon(&quot;media/icons/filenew.png&quot;))
+
+            for go in file:
+                goItem = QTreeWidgetItem(fileItem)
+                self.addItemToDict(go, goItem)
+                goItem.setIcon(0, QIcon(&quot;media/icons/agt_games.png&quot;))
+                if changeColor:
+                    goItem.setBackgroundColor(0, QColor(&quot;lightGray&quot;))
+                    goItem.setBackgroundColor(1, QColor(&quot;lightGray&quot;))
+                    goItem.setBackgroundColor(2, QColor(&quot;lightGray&quot;))
+                goItem.setText(0, str(go.classid))
+                goItem.setText(1, str(go.baseclass))
+                changeColor = not changeColor
+
+                changeColor2 = False
+                for prop in go.properties:
+                    item1 = QTreeWidgetItem(goItem) #the property item, needs to be created regardless the type
+                    self.addItemToDict(prop, item1)
+                    if changeColor:
+                        item1.setBackgroundColor(0, QColor(&quot;lightGray&quot;))
+                        item1.setBackgroundColor(1, QColor(&quot;lightGray&quot;))
+                        item1.setBackgroundColor(2, QColor(&quot;lightGray&quot;))
+                    item1.setIcon(0, QIcon(&quot;media/icons/agt_multimedia.png&quot;))
+                    item1.setText(0, str(prop.name))
+                    item1.setText(1, prop.getType())
+                    if prop.getType() is &quot;MAP&quot;:
+                        self.createPropertyMapItem(prop, item1)
+                    elif prop.getType() is &quot;ARRAY&quot;:
+                        pass
+                    else:
+                        item1.setText(2, unicode(prop.data))
+
+                    changeColor2 = not changeColor
+

Modified: rl/branches/newton20/editors/Lockenwickler/src/Lockenwickler.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/src/Lockenwickler.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/src/Lockenwickler.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -21,8 +21,8 @@
 import sys
 import platform
 
-sys.path.insert(0,'..')
-import PythonOgreConfig
+#sys.path.insert(0,'..')
+#import PythonOgreConfig
 
 from random import randint
 from os.path import isfile
@@ -31,6 +31,7 @@
 from PreferencesDialog import *
 from ObjectPropertyWin import *
 from ModelSelectionDialog import *
+from GameObjectClassView import *
 from ConsoleWindow import *
 from ModuleManager import *
 from SceneExplorer import *
@@ -42,9 +43,15 @@
     def __init__(self, parent=None):
         QtGui.QWidget.__init__(self, parent)
 
+        pixmap = QPixmap(&quot;media/icons/lockenwickler_provisorium.png&quot;)
+        splash = QSplashScreen(pixmap, Qt.WindowStaysOnTopHint)
+        splash.setMask(pixmap.mask())
+        splash.showMessage(&quot;Starting...&quot;)
+        splash.show()
+
         self.setupUi()
 
-        self.consoleWindow = ConsoleWindow(True,  self)
+        self.consoleWindow = ConsoleWindow(False,  self)
 
         self.setupOgre()
 
@@ -52,6 +59,7 @@
         self.objectPropertyWin = ObjectPropertyWin(self)
         self.sceneExplorerWin = SceneExplorer(self)
         self.modelSelectionDialog = ModelSelectionDialog(self.ogreRoot, self)
+        self.gameObjectClassView = GameObjectClassView(self.moduleManager.gocManager)
 
         self.createDockWindows()
 
@@ -63,6 +71,7 @@
         self.restoreGeometry(settings.value(&quot;MainWindow/Geometry&quot;).toByteArray())
         self.restoreState(settings.value(&quot;MainWindow/DockWindows&quot;).toByteArray())
 
+        self.setWindowIcon(QIcon(&quot;media/icons/lockenwickler_provisorium_small.png&quot;))
         self.setWindowTitle(&quot;Rastullahs Lockenwickler&quot;)
 #        # Import Psyco if available
 #        try:
@@ -75,6 +84,8 @@
 
         #QtGui.QApplication.setKeyboardInputInterval(5000)
 
+        splash.finish(self)
+
     def createAction(self, text, slot=None, shortcut=None, icon=None, tip=None, checkable=False, signal=&quot;triggered()&quot;):
         action = QtGui.QAction(text, self)
         if icon is not None:
@@ -174,6 +185,9 @@
         self.actionObject_Selection = self.createAction(&quot;&amp;Model Preview Window&quot;,  self.toggleModelPreviewWindow,  &quot;Alt + O&quot;,  &quot;tux.png&quot;,  &quot;Model Preview&quot;)
         self.actionObject_Selection.setObjectName(&quot;actionObject_Selection&quot;)
 
+        self.actionGameObjectClass_Selection = self.createAction(&quot;&amp;Game Object Class Preview Window&quot;,  self.toggleGameObjectViewWindow,  &quot;Alt + G&quot;,  &quot;multirow.png&quot;,  &quot;GameObjectClass Preview&quot;)
+        self.actionGameObjectClass_Selection.setObjectName(&quot;actionObject_Selection&quot;)
+
         self.actionConsole_Window = self.createAction(&quot;&amp;Console Window&quot;,  self.toggleConsoleWindow,  &quot;Alt + C&quot;,  &quot;console.png&quot;,  &quot;Console Window&quot;)
         self.actionConsole_Window.setObjectName(&quot;actionConsole_Window&quot;)
 
@@ -197,6 +211,7 @@
         self.menuView.addAction(self.actionPreferences)
         self.menuView.addAction(self.actionProperty_Window)
         self.menuView.addAction(self.actionObject_Selection)
+        self.menuView.addAction(self.actionGameObjectClass_Selection)
         self.menuView.addAction(self.actionConsole_Window)
         self.menubar.addAction(self.menuFile.menuAction())
         self.menubar.addAction(self.menuEdit.menuAction())
@@ -299,6 +314,12 @@
         else:
             self.modelSelectionDock.hide()
 
+    def toggleGameObjectViewWindow(self):
+        if self.gameObjectClassViewDock.isHidden():
+            self.gameObjectClassViewDock.show()
+        else:
+            self.gameObjectClassViewDock.hide()
+
     def toggleSceneExplorer(self):
         if self.sceneExplorerDock.isHidden():
             self.sceneExplorerDock.show()
@@ -338,7 +359,7 @@
             pass
 
         self.mapFiles = [] # a list in case the module has more than one map file
-
+        self.gofFiles = [] # gof File list
         for line in f:
             lStripped = line.strip() #strip the whitespace away, not needed here
 
@@ -364,11 +385,19 @@
             self.mapFiles.append(mf)
 
         command = (os.path.join(self.workingDir,  &quot;maps&quot;) + &quot;/*.scene&quot;)
-        for mf in glob.glob(command): # search for all xml files in the maps directory and add them
+        for mf in glob.glob(command): # search for all .scene files in the maps directory and add them
             self.mapFiles.append(mf)
 
-        self.moduleManager.load(moduleName,  self.mapFiles)
+        command = (os.path.join(self.workingDir,  &quot;dsa&quot;) + &quot;/*.gof&quot;)
+        for gf in glob.glob(command): # search for all .gof files in the dsa directory in the module dir
+            self.gofFiles.append(gf)
 
+        command = (os.path.join(self.workingDirCommon,  &quot;dsa&quot;) + &quot;/*.gof&quot;)
+        for gf in glob.glob(command): # search for all .gof files in the dsa directory in the common module dir
+            self.gofFiles.append(gf)
+
+        self.moduleManager.load(moduleName,  self.mapFiles,  self.gofFiles)
+
     def setResourcePaths(self, path, moduleName):
         for file in os.listdir(path):
             curFile = path + &quot;/&quot; + file
@@ -395,6 +424,12 @@
         self.modelSelectionDock.setWidget(self.modelSelectionDialog)
         self.addDockWidget(QtCore.Qt.RightDockWidgetArea, self.modelSelectionDock)
 
+        self.gameObjectClassViewDock = QtGui.QDockWidget(self.tr(&quot;GameObjectClasses&quot;), self)
+        self.gameObjectClassViewDock.setObjectName(&quot;GameObjectClassView&quot;)
+        self.gameObjectClassViewDock.setAllowedAreas(QtCore.Qt.LeftDockWidgetArea | QtCore.Qt.RightDockWidgetArea)
+        self.gameObjectClassViewDock.setWidget(self.gameObjectClassView)
+        self.addDockWidget(QtCore.Qt.RightDockWidgetArea, self.gameObjectClassViewDock)
+
         self.sceneExplorerDock = QtGui.QDockWidget(self.tr(&quot;Scene Explorer&quot;), self)
         self.sceneExplorerDock.setObjectName(&quot;SceneExplorerDockWindow&quot;)
         self.sceneExplorerDock.setAllowedAreas(QtCore.Qt.LeftDockWidgetArea | QtCore.Qt.RightDockWidgetArea)

Modified: rl/branches/newton20/editors/Lockenwickler/src/ModelSelectionDialog.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/src/ModelSelectionDialog.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/src/ModelSelectionDialog.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -28,6 +28,7 @@
 import OgreWidget
 import ogre.renderer.OGRE as og
 
+# The drag events are processed in ObgreMainWindow.py
 
 class MyListWidget(QListWidget):
     def __init__(self,  parent):
@@ -39,7 +40,7 @@
         stream = QDataStream(data,  QIODevice.WriteOnly)
         stream &lt;&lt; self.currentItem().text()
         mimeData = QMimeData()
-        mimeData.setData(&quot;application/x-text&quot;, data)
+        mimeData.setData(&quot;application/x-static_model&quot;, data)
         drag = QDrag(self)
         drag.setMimeData(mimeData)
         drag.start(Qt.CopyAction)

Modified: rl/branches/newton20/editors/Lockenwickler/src/ModuleManager.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/src/ModuleManager.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/src/ModuleManager.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,603 +1,360 @@
-#################################################
- # Copyright (C) 2008  Stefan Stammberger
- #
- # This library is free software; you can redistribute it and/or
- # modify it under the terms of the GNU Lesser General Public
- # License as published by the Free Software Foundation; either
- # version 2.1 of the License, or (at your option) any later version.
- #
- # This library is distributed in the hope that it will be useful,
- # but WITHOUT ANY WARRANTY; without even the implied warranty of
- # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- # Lesser General Public License for more details.
- #
- # You should have received a copy of the GNU Lesser General Public
- # License along with this library; if not, write to the Free Software
- # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
- #################################################
-
-import sys
-import xml.dom.minidom as xml
-
-import ctypes
-import ogre.renderer.OGRE as og
-
-from MovePivot import *
-
-# a class to store information about a object that got selected
-class SelectionObject():
-    def __init__(self,  entity,  distance):
-        self.entityName = entity.getName()
-        self.entity = entity #the selected entity
-        self.distance = distance # the distance from camera at the time of selection
-        self.isPivot = False
-
-    #if True this instance will show its bounding box else it will hide it
-    def setSelected(self,  selected):
-        if selected == True:
-            self.entity.getParentNode().showBoundingBox(True)
-        else:
-            self.entity.getParentNode().showBoundingBox(False)
-
-    def __eq__(self, other):
-        return self.entity.getName() == other.entity.getName()
-
-    def __ne__(self, other):
-        return self.entity.getName() != other.entity.getName()
-
-class MyRaySceneQueryListener ( og.RaySceneQueryListener ):
-    def __init__( self ):
-        super ( MyRaySceneQueryListener, self ).__init__()
-        self.previouseSelection = None
-        self.selectionList = []
-        self.previousSelected = -1
-        self.currentSelected = -1
-
-        self.mNormalList = []
-        self.mVertexList = []
-        self.mIndexList = []
-
-        self.currentRay = None
-        self.lastRay = None
-
-    # sort algorithm for the selection list
-    def sortCompareImp(self,  x,  y):
-        if x.distance &gt; y.distance:
-            return 1
-        elif x.distance == y.distance:
-            return 0
-        else: # x&lt;y
-            return -1
-
-    def queryResult ( self, entity, distance ):
-        #print &quot;dbg: &quot; + entity.getName()
-        if distance == 0.0: #camera is in the bounding box, ignore this selection
-            return True
-#        elif entity.getName() == &quot;rayLine&quot; :
-#            return True
-        elif entity.getName() == &quot;OgreMainWin::0::ViewportGrid&quot;:
-            return True
-        elif entity.isVisible() and entity.getName() == &quot;EditorXArrow&quot;:
-            so = SelectionObject(entity,  distance)
-            so.isPivot = True
-            self.selectionList.append(so)
-            return False
-        elif entity.isVisible() and entity.getName() == &quot;EditorYArrow&quot;:
-            so = SelectionObject(entity,  distance)
-            so.isPivot = True
-            self.selectionList.append(so)
-            return False
-        elif entity.isVisible() and entity.getName() == &quot;EditorZArrow&quot;:
-            so = SelectionObject(entity,  distance)
-            so.isPivot = True
-            self.selectionList.append(so)
-            return False
-        elif entity.isVisible() and entity.getName() == &quot;EditorFreeMover&quot;:
-            return True
-        elif entity.getName() == &quot;EditorXRotator&quot; or entity.getName() == &quot;EditorYRotator&quot; or entity.getName() == &quot;EditorZRotator&quot;:
-            if entity.isVisible() and self.rayCastToPolygonLevelOnSingleMesh(self.currentRay,  entity):
-                so = SelectionObject(entity,  distance)
-                so.isPivot = True
-                self.selectionList.append(so)
-                return False
-            else:
-                return True
-        else:
-            so = SelectionObject(entity,  distance)
-            self.selectionList.append(so)
-
-        self.selectionList.sort(self.sortCompareImp)
-
-        return True
-
-    def reset(self):
-        self.previousSelected = -1
-        self.currentSelected = -1
-        del self.selectionList[:]
-        #self.selectionList = []
-
-#    def iterateEntityUnderMouse(self):
-#        self.previousSelected = self.currentSelected
-#        if len(self.selectionList) &gt;= self.currentSelected: # would mean we are out of bounds
-#            self.selectionList[self.currentSelected].setSelected(False)
-#
-#        self.currentSelected += 1
-#
-#        if len(self.selectionList) == self.currentSelected: # means we are out of bounds and reached the end of the list, reset it to zero
-#            self.currentSelected = 0
-#
-#        if len(self.selectionList) &gt;= self.currentSelected: # would mean we are out of bounds
-#            #print str(self.selectionList[self.currentSelected].distance) + &quot; &quot;  + self.selectionList[self.currentSelected].entity.getName()
-#            if self.rayCastToPolygonLevelOnCurrentSelection():
-#                self.selectionList[self.currentSelected].setSelected(True)
-#                return self.selectionList[self.currentSelected]
-
-
-    def getMeshInformation(self,  entity):
-        numVertices = 0
-        numIndices = 0
-        useSharedVertices = False
-
-        if not entity:
-            return False
-
-        pMesh = entity.getMesh()
-
-        pos =    entity.getParentNode().getWorldPosition()
-        orient = entity.getParentNode().getWorldOrientation()
-        scale =  entity.getParentNode().getScale()
-
-        for i in range ( pMesh.getNumSubMeshes() ):
-            pSubMesh = pMesh.getSubMesh(i)
-            if pSubMesh.useSharedVertices:
-                useSharedVertices = True
-            else:
-                numVertices += pSubMesh.vertexData.vertexCount
-            numIndices += pSubMesh.indexData.indexCount
-
-        if useSharedVertices:
-            numVertices += pMesh.sharedVertexData.vertexCount
-
-            storageclass = ctypes.c_float * 3
-            test=storageclass(0.0,  0.0,  0.0)
-#         mVertexList = new Point[numVertices];
-#         mIndexList = new unsigned int[numIndices];
-
-        self.mVertexList = []
-        self.mIndexList = []
-
-        ## Count the number of vertices and incides so we can Set them
-        indexCount = 0
-        vertListCount = 0
-
-        if useSharedVertices:
-            ## Real* pVertices (x, y, z order x numVertices)
-            elem = pMesh.sharedVertexData.vertexDeclaration.findElementBySemantic(og.VES_POSITION)
-
-            if not elem:
-                ogre.Except(Exception.ERR_ITEM_NOT_FOUND, &quot;Can't find position elements in the &quot;
-                    &quot;mesh to be written!&quot;, &quot;MeshSerializerImpl.writeGeometry&quot;)
-
-            vbuf = pMesh.sharedVertexData.vertexBufferBinding.getBuffer(elem.getSource())
-
-            ## need space for the 3 verticies
-            storageclass = ctypes.c_float * 3
-            test=storageclass(0.0,  0.0,  0.0)
-
-            for j in range ( pMesh.sharedVertexData.vertexCount ):
-                vbuf.readData(j * vbuf.getVertexSize(), 3 * ctype.sizeof(ctype.c_float), ctype.addressof(test))
-                self.mVertexList.append( og.Vector3(test[0], test[1], test[2]) )
-                vertListCount+=1
-
-        for i in range ( pMesh.getNumSubMeshes() ):
-            pSubMesh = pMesh.getSubMesh(i)
-            if not pSubMesh.useSharedVertices:
-                ## Real* pVertices (x, y, z order x numVertices)
-                elem = pSubMesh.vertexData.vertexDeclaration.findElementBySemantic(og.VES_POSITION)
-
-                if not elem:
-                    og.Except(Exception.ERR_ITEM_NOT_FOUND, &quot;Can't find position elements in the &quot;
-                        &quot;mesh to be written!&quot;, &quot;MeshSerializerImpl.writeGeometry&quot;)
-
-                vbuf = pSubMesh.vertexData.vertexBufferBinding.getBuffer(elem.getSource())
-
-                ## need space for the verticies
-                storageclass = ctypes.c_float * (pSubMesh.vertexData.vertexCount * 6)
-                test=storageclass(0.0)
-
-                vbuf.readData(0, pSubMesh.vertexData.vertexCount * 6 * ctypes.sizeof(ctypes.c_float), ctypes.addressof(test))
-
-                for j in range ( 0,  pSubMesh.vertexData.vertexCount * 6,  6):
-                    #print j
-                    p = og.Vector3(test[j], test[j+1], test[j+2])
-                    p /= scale
-                    p += pos
-                    p = orient * p
-                    self.mVertexList.append( p )
-                    vertListCount += 1
-
-            ibuf = pSubMesh.indexData.indexBuffer
-            ## need space for the verticies
-            storageclass = ctypes.c_ushort * pSubMesh.indexData.indexCount
-            test2=storageclass()
-
-
-            ibuf.readData(0, ibuf.getSizeInBytes(), ctypes.addressof(test2))
-            for j in range ( pSubMesh.indexData.indexCount ):
-                self.mIndexList.append (test2[j])   # unsigned short
-                indexCount += 1
-
-            ih = 0
-            for blah in self.mVertexList:
-                #print str(ih) + &quot;: &quot;  +  str(blah)
-                ih += 1
-
-#            for blah in self.mIndexList:
-#                print blah
-
-
-    # used when a new selection is made, meaning when not iterationg through the selected objects
-    def rayCastToPolygonLevel(self,  ray):
-        self.lastRay = ray
-
-        for so in self.selectionList:
-            if so.isPivot:
-                return so
-
-        if len(self.selectionList) &gt;= 1:
-            for so in self.selectionList:
-                if self.rayCastToPolygonLevelOnSingleMesh(ray,  so.entity):
-                    return so
-
-
-    def rayCastToPolygonLevelOnSingleMesh(self,  ray,  entity):
-        return True
-        self.getMeshInformation(entity)
-        name = entity.getName()
-        print &quot;dbg: &quot; + name
-
-        temp = []
-        for vec in self.mVertexList:
-            temp.append(vec.x)
-            temp.append(vec.y)
-            temp.append(vec.z)
-
-        globalPosition = entity.getParentNode().getWorldPosition()
-        globalOrientation = entity.getParentNode().getWorldOrientation()
-
-
-        i = 0
-        while i &lt;= (len(self.mIndexList) - 3):
-            verta = globalPosition + self.mVertexList[self.mIndexList[i]]
-            vertb = globalPosition + self.mVertexList[self.mIndexList[i+1]]
-            vertc = globalPosition + self.mVertexList[self.mIndexList[i+2]]
-
-            verta = globalOrientation * verta
-            vertb = globalOrientation * vertb
-            vertc = globalOrientation * vertc
-            normal = og.Math.calculateBasicFaceNormal(verta, vertb, vertc)
-
-            result = og.Math.intersects(ray, verta, vertb, vertc, True, True)
-            #result = og.Math.intersects(ray, globalPosition + self.mVertexList[self.mIndexList[i]], globalPosition + self.mVertexList[self.mIndexList[i+1]],
-            #                                                                                                                                              globalPosition + self.mVertexList[self.mIndexList[i+2]], normal,  True, True)
-
-            if result.first:
-                print &quot;dbg: Treffer!!!!!!!!!&quot;
-                return True
-
-            i += 3
-
-        return False
-
-    def rayCastToPolygonLevelOnCurrentSelection(self):
-        if len(self.selectionList) &gt;= 1:
-            self.getMeshInformation(self.selectionList[self.currentSelected].entity)
-
-            i = 0
-            while i &lt;= (len(self.mIndexList) - 3):
-                globalPosition = self.selectionList[self.currentSelected].entity.getParentNode().getPosition()
-                result = og.Math.intersects(self.lastRay, globalPosition + self.mVertexList[self.mIndexList[i]], globalPosition + self.mVertexList[self.mIndexList[i+1]],
-                                                                                                                                                          globalPosition + self.mVertexList[self.mIndexList[i+2]], True, True)
-
-                if result.first:
-                   return True
-
-                i += 3
-            return False
-
-class ModuleManager(object):
-    def __init__(self,  ogreRoot,  sceneManager):
-        self.sceneManager = sceneManager
-        self.ogreRoot = ogreRoot
-        self.raySceneQuery = self.sceneManager.createRayQuery(og.Ray())
-
-        self.userSelectionList = []
-        self.cutList = [] # selection objects that has been cut out and wait to be pasted again
-        self.cutListPreviousNodes = [] # contains the nodes they where copnnected to before the cut
-
-        self.listenerDings = MyRaySceneQueryListener()
-
-        self.lastRay = None
-#        self.rayLine = None
-
-        self.pivot = None
-        self.movingPivot = False
-
-        self.leftMouseDown = False
-        self.middleMouseDown = False
-        self.rightMouseDown = False
-
-        self.dropCount = 0
-        self.dropNode = None
-        self.dropEntity = None
-        self.dropCollisionPlane = og.Plane(og.Vector3.UNIT_Y, og.Vector3.ZERO)
-
-        self.numerOfCopys = 0 #everytime a copy is made this numer is increased to generate unique node and mesh names
-
-    def load(self,  moduleName,  mapFiles):
-        self.moduleName = moduleName
-        self.mapFiles = mapFiles
-
-        for a in self.mapFiles:
-            doc = xml.parse(a)
-            node = doc.getElementsByTagName(&quot;entity&quot;)
-            if node != None:
-                self.parseSceneNodes(node)
-
-        self.pivot = Pivot(self.sceneManager)
-        self.pivot.hide()
-
-    def parseSceneNodes(self,  nodeList):
-        for ent in nodeList:
-            entityName = ent.attributes[&quot;name&quot;].nodeValue # get the name of the ent
-            meshFile = ent.attributes[&quot;meshfile&quot;].nodeValue # meshfile
-            nodePosition = None
-            nodeRotation = None
-            nodeScale = None
-
-            for cn in ent.childNodes:
-                if cn.nodeType == cn.ELEMENT_NODE:
-                    if cn.localName == &quot;position&quot;:
-                        px = float(cn.attributes[&quot;x&quot;].nodeValue)
-                        py = float(cn.attributes[&quot;y&quot;].nodeValue)
-                        pz = float(cn.attributes[&quot;z&quot;].nodeValue)
-                        nodePosition = og.Vector3(px, py, pz)
-                        continue
-
-                    if cn.localName == &quot;rotation&quot;:
-                        qw = float(cn.attributes[&quot;qw&quot;].nodeValue)
-                        qx = float(cn.attributes[&quot;qx&quot;].nodeValue)
-                        qy = float(cn.attributes[&quot;qy&quot;].nodeValue)
-                        qz = float(cn.attributes[&quot;qz&quot;].nodeValue)
-                        nodeRotation = og.Quaternion(qw,  qx, qy, qz)
-                        continue
-
-                    if cn.localName == &quot;scale&quot;:
-                        px = float(cn.attributes[&quot;x&quot;].nodeValue)
-                        py = float(cn.attributes[&quot;y&quot;].nodeValue)
-                        pz = float(cn.attributes[&quot;z&quot;].nodeValue)
-                        nodeScale = og.Vector3(px, py, pz)
-                        continue
-
-            try:
-                e = self.sceneManager.createEntity(entityName, meshFile)
-            except:
-                print &quot;Warning: Meshfile &quot; + meshFile + &quot; could not be found.&quot;
-                return
-
-            n = self.sceneManager.getRootSceneNode().createChild(entityName + &quot;_node&quot;)
-            n.attachObject(e)
-            n.setPosition(nodePosition)
-            #n.setOrientation(nodeRotation)
-            n.setScale(nodeScale)
-
-        pass
-
-    # called when a click into Main Ogre Window occurs
-    def selectionClick(self,  ray,  controlDown=False,  shiftDown=False):
-        self.listenerDings.reset()
-        self.lastRay = ray
-        self.listenerDings.currentRay = ray
-        self.raySceneQuery.Ray = ray
-        self.raySceneQuery.execute(self.listenerDings)
-
-        so = self.listenerDings.rayCastToPolygonLevel(ray)
-        if so is not None:
-            if not so.isPivot:
-                if self.pivot is not None:
-                    self.pivot.show()
-                if not controlDown and not shiftDown:
-                    self.resetSelection()
-                    so.setSelected(True)
-                    self.userSelectionList.append(so)
-                    self.updatePivots()
-                elif controlDown and not shiftDown:
-                    so.setSelected(True)
-
-                    for soFromList in self.userSelectionList:
-                        if soFromList == so:
-                            return # object already selected
-
-                    self.userSelectionList.append(so)
-                    self.updatePivots()
-
-
-                elif not controlDown and shiftDown:
-                    for selo in self.userSelectionList:
-                        if so == selo:
-                            so.setSelected(False)
-                            self.userSelectionList.remove(selo)
-                    self.updatePivots()
-            else:
-                #so.entity is the pivot direction that was clicked
-                self.pivot.startTransforming(so.entity,  self.userSelectionList)
-        else:
-            self.resetSelection() # click in empty space, deselect everything
-            if self.pivot is not None:
-                self.pivot.hide()
-
-#        if self.rayLine == None:
-#            self.rayLine = self.sceneManager.createManualObject(&quot;rayLine&quot;)
-#            self.rayLine.setDynamic(True)
-#            self.sceneManager.getRootSceneNode().createChildSceneNode(&quot;raynode&quot;).attachObject(self.rayLine)
-#
-#            self.rayLine.begin(&quot;BaseWhiteNoLighting&quot;, og.RenderOperation.OT_LINE_STRIP)
-#
-#            self.rayLine.position(ray.getOrigin())
-#            self.rayLine.position( ray.getPoint(10000))
-#
-#            self.rayLine.end()
-#
-#        else:
-#            self.rayLine.beginUpdate(0)
-#
-#            self.rayLine.position(ray.getOrigin())
-#            self.rayLine.position( ray.getPoint(10000))
-#
-#            self.rayLine.end()
-
-    def deleteObjects(self):
-        if len(self.userSelectionList) &lt; 1:
-            return
-
-        self.pivot.hide()
-
-        for so in self.userSelectionList:
-            self.sceneManager.destroySceneNode(so.entity.getParentNode().getName())
-            del so
-
-        self.userSelectionList = []
-
-    def incrementNameSuffixNumber(self, name):
-        newName = &quot;&quot;
-        split = name.split(&quot;_&quot;)
-        lastPart = len(split)-1
-        newName = name.rstrip(split[lastPart])
-        newName = newName + str(self.numerOfCopys)
-
-#        if split[lastPart].isdigit() and not split[lastPart].startswith(&quot;0&quot;):
-#            num = int(split[lastPart])
-#            num = num + 1
-#            newName = name.rstrip(split[lastPart])
-#            newName = newName + str(num)
-#        else:
-#            newName = name + &quot;_1&quot;
-
-        self.numerOfCopys = self.numerOfCopys + 1
-        return newName
-
-    def copyObjects(self):
-        if len(self.userSelectionList) &lt; 1:
-            return
-
-        newSelectionList = []
-        print &quot;dbg: &quot;
-        for so in self.userSelectionList:
-            nodeName = self.incrementNameSuffixNumber(so.entity.getParentNode().getName())
-            newNode = self.sceneManager.getRootSceneNode().createChild(nodeName)
-
-            entityName = self.incrementNameSuffixNumber(so.entity.getName())
-            newEntity = self.sceneManager.createEntity(entityName, so.entity.getMesh().getName())
-
-            newNode.attachObject(newEntity)
-            newNode.setPosition(so.entity.getParentNode().getPosition())
-            newNode.setOrientation(so.entity.getParentNode().getOrientation())
-            newNode.setScale(so.entity.getParentNode().getScale())
-
-            newSO = SelectionObject(newEntity, so.distance)
-            newSO.setSelected(True)
-            newSelectionList.append(newSO)
-
-        self.resetSelection()
-        self.userSelectionList = newSelectionList
-
-    def cutObjects(self):
-        if len(self.userSelectionList) &lt; 1:
-            return
-
-        self.cutList = []
-        for so in self.userSelectionList:
-            self.cutListPreviousNodes.append(so.entity.getParentNode().getParent())
-            so.entity.getParentNode().getParent().removeChild(so.entity.getParentNode())
-            # set the &quot;point of gravity&quot; of all the cutted nodes to world origin at 0,0,0
-            # so we only have to translate them to their new destination when they get pasted
-            # the position of the pivot point is considered as the center of gravity
-            so.entity.getParentNode().setPosition(so.entity.getParentNode().getPosition() - self.pivot.getPosition())
-            self.cutList.append(so)
-        self.resetSelection()
-    def pasteObjects(self,  ray):
-        if len(self.cutList) &lt; 1:
-            return
-
-        result = og.Math.intersects(ray, self.dropCollisionPlane)
-        if result.first == True:
-            i=0
-            while i &lt; len(self.cutList):
-                self.cutListPreviousNodes[i].addChild(self.cutList[i].entity.getParentNode())
-                self.cutList[i].entity.getParentNode().translate(ray.getPoint(result.second))
-                i = i+1
-        else:
-            i=0
-            while i &lt; len(self.cutList):
-                self.cutListPreviousNodes[i].addChild(self.cutList[i].entity.getParentNode())
-                self.cutList[i].entity.getParentNode().translate(ray.getPoint(100.0))
-                i = i+1
-        self.cutList = []
-
-    def leftMouseUp(self):
-        if self.pivot is not None and self.pivot.isTransforming:
-            self.pivot.stopTransforming()
-
-#    def iterateEntityUnderMouse(self):
-#        self.listenerDings.iterateEntityUnderMouse()
-#
-#        pass
-
-    def resetSelection(self):
-        for so in self.userSelectionList:
-            so.setSelected(False)
-
-        self.userSelectionList = []
-
-        self.listenerDings.reset()
-        pass
-
-
-    def updatePivots(self):
-        newPivotPosition = og.Vector3(0, 0, 0)
-
-        for so in self.userSelectionList:
-            newPivotPosition += so.entity.getParentNode().getPosition()
-        if self.pivot is not None:
-            self.pivot.setPosition(newPivotPosition / len(self.userSelectionList))
-
-    def unload(self,  saveOnUnload=True):
-        pass
-
-    def save(self):
-        pass
-
-    def startDropModelAction(self, meshFile, ray):
-        self.dropEntity = self.sceneManager.createEntity(&quot;dropMesh&quot; + str(self.dropCount), str(meshFile))
-        self.dropNode = self.sceneManager.getRootSceneNode().createChild(&quot;dropNode&quot; + str(self.dropCount))
-        self.dropNode.attachObject(self.dropEntity)
-
-        result = og.Math.intersects(ray, self.dropCollisionPlane)
-        if result.first == True:
-            self.dropNode.setPosition(ray.getPoint(result.second))
-        else:
-            self.dropNode.setPosition(ray.getPoint(50))
-
-        self.dropCount += 1
-
-    def moveDropModelAction(self, ray):
-        result = og.Math.intersects(ray, self.dropCollisionPlane)
-        if result.first == True:
-            self.dropNode.setPosition(ray.getPoint(result.second))
-        else:
-            self.dropNode.setPosition(ray.getPoint(50))
-
-
-    def stopDropModelAction(self, ray):
-        pass
-
+#################################################
+ # Copyright (C) 2008  Stefan Stammberger
+ #
+ # This library is free software; you can redistribute it and/or
+ # modify it under the terms of the GNU Lesser General Public
+ # License as published by the Free Software Foundation; either
+ # version 2.1 of the License, or (at your option) any later version.
+ #
+ # This library is distributed in the hope that it will be useful,
+ # but WITHOUT ANY WARRANTY; without even the implied warranty of
+ # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ # Lesser General Public License for more details.
+ #
+ # You should have received a copy of the GNU Lesser General Public
+ # License along with this library; if not, write to the Free Software
+ # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ #################################################
+
+import sys
+import xml.dom.minidom as xml
+
+import ctypes
+import ogre.renderer.OGRE as og
+
+from MovePivot import *
+from GameObjectClassManager import *
+from MyRaySceneQueryListener import *
+
+class ModuleManager(object):
+    def __init__(self,  ogreRoot,  sceneManager):
+        self.sceneManager = sceneManager
+        self.ogreRoot = ogreRoot
+        self.raySceneQuery = self.sceneManager.createRayQuery(og.Ray())
+
+        self.gocManager = GameObjectClassManager()
+
+        self.userSelectionList = []
+        self.cutList = [] # selection objects that has been cut out and wait to be pasted again
+        self.cutListPreviousNodes = [] # contains the nodes they where copnnected to before the cut
+
+        self.listenerDings = MyRaySceneQueryListener()
+
+        self.lastRay = None
+#        self.rayLine = None
+
+        self.pivot = None
+        self.movingPivot = False
+
+        self.leftMouseDown = False
+        self.middleMouseDown = False
+        self.rightMouseDown = False
+
+        self.dropCount = 0
+        self.dropNode = None
+        self.dropEntity = None
+        self.dropCollisionPlane = og.Plane(og.Vector3.UNIT_Y, og.Vector3.ZERO)
+
+        self.numerOfCopys = 0 #everytime a copy is made this numer is increased to generate unique node and mesh names
+
+    def load(self,  moduleName,  mapFiles,  gofFiles):
+        self.moduleName = moduleName
+        self.mapFiles = mapFiles
+        self.gofFiles = gofFiles
+
+        self.gocManager.parseGOFFiles(self.gofFiles)
+
+        for a in self.mapFiles:
+            doc = xml.parse(a)
+            node = doc.getElementsByTagName(&quot;entity&quot;)
+            if node != None:
+                self.parseSceneNodes(node)
+
+        self.pivot = Pivot(self.sceneManager)
+        self.pivot.hide()
+
+    def parseSceneNodes(self,  nodeList):
+        for ent in nodeList:
+            entityName = ent.attributes[&quot;name&quot;].nodeValue # get the name of the ent
+            meshFile = ent.attributes[&quot;meshfile&quot;].nodeValue # meshfile
+            nodePosition = None
+            nodeRotation = None
+            nodeScale = None
+
+            for cn in ent.childNodes:
+                if cn.nodeType == cn.ELEMENT_NODE:
+                    if cn.localName == &quot;position&quot;:
+                        px = float(cn.attributes[&quot;x&quot;].nodeValue)
+                        py = float(cn.attributes[&quot;y&quot;].nodeValue)
+                        pz = float(cn.attributes[&quot;z&quot;].nodeValue)
+                        nodePosition = og.Vector3(px, py, pz)
+                        continue
+
+                    if cn.localName == &quot;rotation&quot;:
+                        qw = float(cn.attributes[&quot;qw&quot;].nodeValue)
+                        qx = float(cn.attributes[&quot;qx&quot;].nodeValue)
+                        qy = float(cn.attributes[&quot;qy&quot;].nodeValue)
+                        qz = float(cn.attributes[&quot;qz&quot;].nodeValue)
+                        nodeRotation = og.Quaternion(qw,  qx, qy, qz)
+                        continue
+
+                    if cn.localName == &quot;scale&quot;:
+                        px = float(cn.attributes[&quot;x&quot;].nodeValue)
+                        py = float(cn.attributes[&quot;y&quot;].nodeValue)
+                        pz = float(cn.attributes[&quot;z&quot;].nodeValue)
+                        nodeScale = og.Vector3(px, py, pz)
+                        continue
+
+            try:
+                e = self.sceneManager.createEntity(entityName, meshFile)
+            except:
+                print &quot;Warning: Meshfile &quot; + meshFile + &quot; could not be found.&quot;
+                return
+
+            n = self.sceneManager.getRootSceneNode().createChild(entityName + &quot;_node&quot;)
+            n.attachObject(e)
+            n.setPosition(nodePosition)
+            #n.setOrientation(nodeRotation)
+            n.setScale(nodeScale)
+
+        pass
+
+    # called when a click into Main Ogre Window occurs
+    def selectionClick(self,  ray,  controlDown=False,  shiftDown=False):
+        self.listenerDings.reset()
+        self.lastRay = ray
+        self.listenerDings.currentRay = ray
+        self.raySceneQuery.Ray = ray
+        self.raySceneQuery.execute(self.listenerDings)
+
+        so = self.listenerDings.rayCastToPolygonLevel(ray)
+        if so is not None:
+            if not so.isPivot:
+                if self.pivot is not None:
+                    self.pivot.show()
+                if not controlDown and not shiftDown:
+                    self.resetSelection()
+                    so.setSelected(True)
+                    self.userSelectionList.append(so)
+                    self.updatePivots()
+                elif controlDown and not shiftDown:
+                    so.setSelected(True)
+
+                    for soFromList in self.userSelectionList:
+                        if soFromList == so:
+                            return # object already selected
+
+                    self.userSelectionList.append(so)
+                    self.updatePivots()
+
+
+                elif not controlDown and shiftDown:
+                    for selo in self.userSelectionList:
+                        if so == selo:
+                            so.setSelected(False)
+                            self.userSelectionList.remove(selo)
+                    self.updatePivots()
+            else:
+                #so.entity is the pivot direction that was clicked
+                self.pivot.startTransforming(so.entity,  self.userSelectionList)
+        else:
+            self.resetSelection() # click in empty space, deselect everything
+            if self.pivot is not None:
+                self.pivot.hide()
+
+#        if self.rayLine == None:
+#            self.rayLine = self.sceneManager.createManualObject(&quot;rayLine&quot;)
+#            self.rayLine.setDynamic(True)
+#            self.sceneManager.getRootSceneNode().createChildSceneNode(&quot;raynode&quot;).attachObject(self.rayLine)
+#
+#            self.rayLine.begin(&quot;BaseWhiteNoLighting&quot;, og.RenderOperation.OT_LINE_STRIP)
+#
+#            self.rayLine.position(ray.getOrigin())
+#            self.rayLine.position( ray.getPoint(10000))
+#
+#            self.rayLine.end()
+#
+#        else:
+#            self.rayLine.beginUpdate(0)
+#
+#            self.rayLine.position(ray.getOrigin())
+#            self.rayLine.position( ray.getPoint(10000))
+#
+#            self.rayLine.end()
+
+    def deleteObjects(self):
+        if len(self.userSelectionList) &lt; 1:
+            return
+
+        self.pivot.hide()
+
+        for so in self.userSelectionList:
+            self.sceneManager.destroySceneNode(so.entity.getParentNode().getName())
+            del so
+
+        self.userSelectionList = []
+
+    def incrementNameSuffixNumber(self, name):
+        newName = &quot;&quot;
+        split = name.split(&quot;_&quot;)
+        lastPart = len(split)-1
+        newName = name.rstrip(split[lastPart])
+        newName = newName + str(self.numerOfCopys)
+
+#        if split[lastPart].isdigit() and not split[lastPart].startswith(&quot;0&quot;):
+#            num = int(split[lastPart])
+#            num = num + 1
+#            newName = name.rstrip(split[lastPart])
+#            newName = newName + str(num)
+#        else:
+#            newName = name + &quot;_1&quot;
+
+        self.numerOfCopys = self.numerOfCopys + 1
+        return newName
+
+    def copyObjects(self):
+        if len(self.userSelectionList) &lt; 1:
+            return
+
+        newSelectionList = []
+        print &quot;dbg: &quot;
+        for so in self.userSelectionList:
+            nodeName = self.incrementNameSuffixNumber(so.entity.getParentNode().getName())
+            newNode = self.sceneManager.getRootSceneNode().createChild(nodeName)
+
+            entityName = self.incrementNameSuffixNumber(so.entity.getName())
+            newEntity = self.sceneManager.createEntity(entityName, so.entity.getMesh().getName())
+
+            newNode.attachObject(newEntity)
+            newNode.setPosition(so.entity.getParentNode().getPosition())
+            newNode.setOrientation(so.entity.getParentNode().getOrientation())
+            newNode.setScale(so.entity.getParentNode().getScale())
+
+            newSO = SelectionObject(newEntity, so.distance)
+            newSO.setSelected(True)
+            newSelectionList.append(newSO)
+
+        self.resetSelection()
+        self.userSelectionList = newSelectionList
+
+    def cutObjects(self):
+        if len(self.userSelectionList) &lt; 1:
+            return
+            return
+
+        self.cutList = []
+        for so in self.userSelectionList:
+            self.cutListPreviousNodes.append(so.entity.getParentNode().getParent())
+            so.entity.getParentNode().getParent().removeChild(so.entity.getParentNode())
+            # set the &quot;point of gravity&quot; of all the cutted nodes to world origin at 0,0,0
+            # so we only have to translate them to their new destination when they get pasted
+            # the position of the pivot point is considered as the center of gravity
+            so.entity.getParentNode().setPosition(so.entity.getParentNode().getPosition() - self.pivot.getPosition())
+            self.cutList.append(so)
+        self.resetSelection()
+    def pasteObjects(self,  ray):
+        if len(self.cutList) &lt; 1:
+            return
+
+        result = og.Math.intersects(ray, self.dropCollisionPlane)
+        if result.first == True:
+            i=0
+            while i &lt; len(self.cutList):
+                self.cutListPreviousNodes[i].addChild(self.cutList[i].entity.getParentNode())
+                self.cutList[i].entity.getParentNode().translate(ray.getPoint(result.second))
+                i = i+1
+        else:
+            i=0
+            while i &lt; len(self.cutList):
+                self.cutListPreviousNodes[i].addChild(self.cutList[i].entity.getParentNode())
+                self.cutList[i].entity.getParentNode().translate(ray.getPoint(100.0))
+                i = i+1
+        self.cutList = []
+
+    def leftMouseUp(self):
+        if self.pivot is not None and self.pivot.isTransforming:
+            self.pivot.stopTransforming()
+
+#    def iterateEntityUnderMouse(self):
+#        self.listenerDings.iterateEntityUnderMouse()
+#
+#        pass
+
+    def resetSelection(self):
+        for so in self.userSelectionList:
+            so.setSelected(False)
+
+        self.userSelectionList = []
+
+        self.listenerDings.reset()
+        pass
+
+
+    def updatePivots(self):
+        newPivotPosition = og.Vector3(0, 0, 0)
+
+        for so in self.userSelectionList:
+            newPivotPosition += so.entity.getParentNode().getPosition()
+        if self.pivot is not None:
+            self.pivot.setPosition(newPivotPosition / len(self.userSelectionList))
+
+    def unload(self,  saveOnUnload=True):
+        pass
+
+    def save(self):
+        pass
+
+    def startDropGameObjectAction(self, classid, ray):
+        go = self.gocManager.getGameObjectWithClassId(classid)
+        meshFile = go.getMeshFileName()
+
+        if go is not None:
+            dropEntity = self.sceneManager.createEntity(&quot;dropMesh&quot; + str(self.dropCount), str(meshFile))
+            dropNode = self.sceneManager.getRootSceneNode().createChild(&quot;dropNode&quot; + str(self.dropCount))
+            dropNode.attachObject(dropEntity)
+
+            result = og.Math.intersects(ray, self.dropCollisionPlane)
+            if result.first == True:
+                dropNode.setPosition(ray.getPoint(result.second))
+            else:
+                dropNode.setPosition(ray.getPoint(50))
+
+            self.dropGO = GameObjectRepresentation(self.dropCount, classid, dropNode, meshFile)
+            dropEntity.setUserObject(self.dropGO)
+
+        self.dropCount += 1
+
+    def moveDropGameObjectAction(self, ray):
+        result = og.Math.intersects(ray, self.dropCollisionPlane)
+        if result.first == True:
+            self.dropGO.setPosition(ray.getPoint(result.second))
+        else:
+            self.dropGO.setPosition(ray.getPoint(50))
+
+    def stopDropGameObjectAction(self, ray):
+        print &quot;sd&quot;
+
+    def startDropModelAction(self, meshFile, ray):
+        self.dropEntity = self.sceneManager.createEntity(&quot;dropMesh&quot; + str(self.dropCount), str(meshFile))
+        self.dropNode = self.sceneManager.getRootSceneNode().createChild(&quot;dropNode&quot; + str(self.dropCount))
+        self.dropNode.attachObject(self.dropEntity)
+
+        result = og.Math.intersects(ray, self.dropCollisionPlane)
+        if result.first == True:
+            self.dropNode.setPosition(ray.getPoint(result.second))
+        else:
+            self.dropNode.setPosition(ray.getPoint(50))
+
+        self.dropCount += 1
+
+    def moveDropModelAction(self, ray):
+        result = og.Math.intersects(ray, self.dropCollisionPlane)
+        if result.first == True:
+            self.dropNode.setPosition(ray.getPoint(result.second))
+        else:
+            self.dropNode.setPosition(ray.getPoint(50))
+
+
+    def stopDropModelAction(self, ray):
+        pass
+

Copied: rl/branches/newton20/editors/Lockenwickler/src/MyRaySceneQueryListener.py (from rev 4567, rl/trunk/editors/Lockenwickler/src/MyRaySceneQueryListener.py)

Modified: rl/branches/newton20/editors/Lockenwickler/src/OgreMainWindow.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/src/OgreMainWindow.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/src/OgreMainWindow.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -227,8 +227,8 @@
         return False
 
     def dragEnterEvent(self, event):
-        if event.mimeData().hasFormat(&quot;application/x-text&quot;):
-            data = event.mimeData().data(&quot;application/x-text&quot;)
+        if event.mimeData().hasFormat(&quot;application/x-static_model&quot;):
+            data = event.mimeData().data(&quot;application/x-static_model&quot;)
             stream = QDataStream(data, QIODevice.ReadOnly)
             text = QString()
             stream &gt;&gt; text
@@ -238,18 +238,39 @@
             event.setDropAction(Qt.CopyAction)
             event.accept()
 
+        elif event.mimeData().hasFormat(&quot;application/x-game_object&quot;):
+            data = event.mimeData().data(&quot;application/x-game_object&quot;)
+            stream = QDataStream(data, QIODevice.ReadOnly)
+            text = QString()
+            stream &gt;&gt; text
+
+            self.moduleManager.startDropGameObjectAction(text, self.getCameraToViewportRay()) #start the model draging
+
+            event.setDropAction(Qt.CopyAction)
+            event.accept()
         else:
             event.ignore()
 
 
     def dragMoveEvent(self, event):
-        self.moduleManager.moveDropModelAction(self.getCameraToViewportRay()) #move it with the mouse
+        if event.mimeData().hasFormat(&quot;application/x-static_model&quot;):
+            self.moduleManager.moveDropModelAction(self.getCameraToViewportRay()) #move it with the mouse
+            event.accept()
+        elif event.mimeData().hasFormat(&quot;application/x-game_object&quot;):
+            self.moduleManager.moveDropGameObjectAction(self.getCameraToViewportRay()) #move it with the mouse
+            event.accept()
+        else:
+            event.ignore()
 
-        event.accept()
-
     def dropEvent(self, event):
-        self.moduleManager.stopDropModelAction(self.getCameraToViewportRay()) # place it down
-        event.accept()
+        if event.mimeData().hasFormat(&quot;application/x-static_model&quot;):
+            self.moduleManager.stopDropModelAction(self.getCameraToViewportRay()) #move it with the mouse
+            event.accept()
+        elif event.mimeData().hasFormat(&quot;application/x-game_object&quot;):
+            self.moduleManager.stopDropGameObjectAction(self.getCameraToViewportRay()) #move it with the mouse
+            event.accept()
+        else:
+            event.ignore()
 
     def getCameraToViewportRay(self):
         relMousePos = self.ogreRenderWindow.mapFromGlobal(QCursor.pos())

Modified: rl/branches/newton20/editors/Lockenwickler/src/Plugins-linux.cfg
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/src/Plugins-linux.cfg	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/src/Plugins-linux.cfg	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,7 +1,8 @@
 # Defines plugins to load
 
 # Define plugin folder
-PluginFolder=/home/stefan/development/root/usr/lib/OGRE/
+#PluginFolder=/home/stefan/development/root/usr/lib/OGRE/
+PluginFolder=/usr/lib/OGRE
 
 # default plugins installed with the libogre14 package
 Plugin=RenderSystem_GL.so

Modified: rl/branches/newton20/editors/Lockenwickler/src/PreferencesDialog.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/src/PreferencesDialog.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/src/PreferencesDialog.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -43,11 +43,11 @@
         if platform.system() == &quot;Windows&quot; or platform.system() == &quot;MAC&quot;:
             pass
             # TODO: delete this when ready
-#            self.prefDialog.lineEdit.setText(&quot;C:\Users\Stefan\Desktop\Lockenwickler\modules\modules.cfg&quot;)
-#            self.moduleCfgPath = &quot;C:\Users\Stefan\Desktop\Lockenwickler\modules\modules.cfg&quot;
-#            self.moduleCfgIsSelected = True
-#            self.modulePath = self.moduleCfgPath.replace(&quot;modules.cfg&quot;, &quot;&quot;)
-#            self.readInModules()
+            self.prefDialog.lineEdit.setText(&quot;C:/a11/modules/modules.cfg&quot;)
+            self.moduleCfgPath = 'C:/a11/modules/modules.cfg'
+            self.moduleCfgIsSelected = True
+            self.modulePath = self.moduleCfgPath.replace(&quot;modules.cfg&quot;, &quot;&quot;)
+            self.readInModules()
             # end delete
         else:
             # TODO: delete this when ready

Copied: rl/branches/newton20/editors/Lockenwickler/src/Ui_GOPropertyEditorDialogSTRING.py (from rev 4567, rl/trunk/editors/Lockenwickler/src/Ui_GOPropertyEditorDialogSTRING.py)

Copied: rl/branches/newton20/editors/Lockenwickler/src/media/icons/agt_games.png (from rev 4567, rl/trunk/editors/Lockenwickler/src/media/icons/agt_games.png)

Copied: rl/branches/newton20/editors/Lockenwickler/src/media/icons/agt_multimedia.png (from rev 4567, rl/trunk/editors/Lockenwickler/src/media/icons/agt_multimedia.png)

Copied: rl/branches/newton20/editors/Lockenwickler/src/media/icons/lockenwickler_provisorium.png (from rev 4567, rl/trunk/editors/Lockenwickler/src/media/icons/lockenwickler_provisorium.png)

Copied: rl/branches/newton20/editors/Lockenwickler/src/media/icons/lockenwickler_provisorium_small.png (from rev 4567, rl/trunk/editors/Lockenwickler/src/media/icons/lockenwickler_provisorium_small.png)

Copied: rl/branches/newton20/editors/Lockenwickler/src/media/icons/multirow.png (from rev 4567, rl/trunk/editors/Lockenwickler/src/media/icons/multirow.png)

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/FourPanelView.ui
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/FourPanelView.ui	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/FourPanelView.ui	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,41 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;FourPaneView&lt;/class&gt;
- &lt;widget class=&quot;QWidget&quot; name=&quot;FourPaneView&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;902&lt;/width&gt;
-    &lt;height&gt;759&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Form&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QSplitter&quot; name=&quot;splitter_3&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;widget class=&quot;QSplitter&quot; name=&quot;splitter&quot; &gt;
-      &lt;property name=&quot;orientation&quot; &gt;
-       &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-      &lt;/property&gt;
-      &lt;widget class=&quot;QWidget&quot; native=&quot;1&quot; name=&quot;widget&quot; /&gt;
-      &lt;widget class=&quot;QWidget&quot; native=&quot;1&quot; name=&quot;widget_4&quot; /&gt;
-     &lt;/widget&gt;
-     &lt;widget class=&quot;QSplitter&quot; name=&quot;splitter_2&quot; &gt;
-      &lt;property name=&quot;orientation&quot; &gt;
-       &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-      &lt;/property&gt;
-      &lt;widget class=&quot;QWidget&quot; native=&quot;1&quot; name=&quot;widget_2&quot; /&gt;
-      &lt;widget class=&quot;QWidget&quot; native=&quot;1&quot; name=&quot;widget_3&quot; /&gt;
-     &lt;/widget&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections/&gt;
-&lt;/ui&gt;

Copied: rl/branches/newton20/editors/Lockenwickler/ui files/GOPropertyEditorDialogINT.ui (from rev 4567, rl/trunk/editors/Lockenwickler/ui files/GOPropertyEditorDialogINT.ui)

Copied: rl/branches/newton20/editors/Lockenwickler/ui files/GOPropertyEditorDialogSTRING.ui (from rev 4567, rl/trunk/editors/Lockenwickler/ui files/GOPropertyEditorDialogSTRING.ui)

Copied: rl/branches/newton20/editors/Lockenwickler/ui files/PropertyEditorDialog.ui (from rev 4567, rl/trunk/editors/Lockenwickler/ui files/PropertyEditorDialog.ui)

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/batch_convert_ui.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/batch_convert_ui.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/batch_convert_ui.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,72 +0,0 @@
-import sys
-import os
-import platform
-
-copyCommand = &quot;cp &quot;
-cpDestination =  &quot; ../src/&quot;
-
-if platform.system() == &quot;Windows&quot;:
-    copyCommand = &quot;copy &quot;
-    cpDestination = &quot; ..\src\\&quot;
-
-###########################################################################
-output = os.popen(&quot;pyuic4 lockewickler.ui &gt; ui_lw.py&quot;)
-for line in output.readlines():
-    print line
-
-output = os.popen(copyCommand + &quot;ui_lw.py&quot; + cpDestination)
-for line in output.readlines():
-    print &quot;pyuic4 lockewickler.ui &gt; ui_lw.py &quot; + line
-###########################################################################
-
-###########################################################################
-output = os.popen(&quot;pyuic4 preferences_dialog.ui &gt; ui_pref_dialog.py&quot;)
-for line in output.readlines():
-    print line
-
-output = os.popen(copyCommand + &quot;ui_pref_dialog.py&quot; + cpDestination)
-for line in output.readlines():
-    print &quot;pyuic4 preferences_dialog.ui &gt; ui_pref_dialog.py &quot; + line
-###########################################################################
-
-###########################################################################
-output = os.popen(&quot;pyuic4 object_property.ui &gt; ui_obj_prop.py&quot;)
-for line in output.readlines():
-    print line
-
-output = os.popen(copyCommand + &quot;ui_obj_prop.py&quot; + cpDestination)
-for line in output.readlines():
-    print &quot;pyuic4 object_property.ui &gt; ui_obj_prop.py &quot; + line
-###########################################################################
-
-###########################################################################
-output = os.popen(&quot;pyuic4 model_preview.ui &gt; ui_model_prev.py&quot;)
-for line in output.readlines():
-    print line
-
-output = os.popen(copyCommand + &quot;ui_model_prev.py&quot; + cpDestination)
-for line in output.readlines():
-    print &quot;pyuic4 model_preview.ui &gt; ui_model_prev.py &quot; + line
-###########################################################################
-
-###########################################################################
-output = os.popen(&quot;pyuic4 FourPanelView.ui &gt; ui_FourPanelView.py&quot;)
-for line in output.readlines():
-        print line
-
-output = os.popen(copyCommand + &quot;ui_FourPanelView.py&quot; + cpDestination)
-for line in output.readlines():
-    print &quot;pyuic4 FourPanelView.ui &gt; ui_FourPanelView.py &quot; + line
-###########################################################################
-
-###########################################################################
-output = os.popen(&quot;pyuic4 console_window.ui &gt; ui_ConsoleWindow.py&quot;)
-for line in output.readlines():
-        print line
-
-output = os.popen(copyCommand + &quot;ui_ConsoleWindow.py&quot; + cpDestination)
-for line in output.readlines():
-    print &quot;pyuic4 console_window.ui &gt; ui_ConsoleWindow.py &quot; + line
-###########################################################################
-
-print &quot;Fertig!&quot;

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/console_window.ui
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/console_window.ui	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/console_window.ui	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,23 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;ConsoleWindow&lt;/class&gt;
- &lt;widget class=&quot;QWidget&quot; name=&quot;ConsoleWindow&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;884&lt;/width&gt;
-    &lt;height&gt;225&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Form&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QTextEdit&quot; name=&quot;textEdit&quot; /&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections/&gt;
-&lt;/ui&gt;

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/lockewickler.ui
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/lockewickler.ui	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/lockewickler.ui	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,108 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;author&gt;Stefan Stammberger&lt;/author&gt;
- &lt;class&gt;MainWindow&lt;/class&gt;
- &lt;widget class=&quot;QMainWindow&quot; name=&quot;MainWindow&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;660&lt;/width&gt;
-    &lt;height&gt;657&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;MainWindow&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;widget class=&quot;QWidget&quot; name=&quot;centralwidget&quot; &gt;
-   &lt;layout class=&quot;QHBoxLayout&quot; &gt;
-    &lt;item&gt;
-     &lt;layout class=&quot;QGridLayout&quot; &gt;
-      &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-       &lt;widget class=&quot;QWidget&quot; native=&quot;1&quot; name=&quot;ogreRenderWindow&quot; &gt;
-        &lt;property name=&quot;minimumSize&quot; &gt;
-         &lt;size&gt;
-          &lt;width&gt;250&lt;/width&gt;
-          &lt;height&gt;250&lt;/height&gt;
-         &lt;/size&gt;
-        &lt;/property&gt;
-       &lt;/widget&gt;
-      &lt;/item&gt;
-     &lt;/layout&gt;
-    &lt;/item&gt;
-   &lt;/layout&gt;
-  &lt;/widget&gt;
-  &lt;widget class=&quot;QMenuBar&quot; name=&quot;menubar&quot; &gt;
-   &lt;property name=&quot;geometry&quot; &gt;
-    &lt;rect&gt;
-     &lt;x&gt;0&lt;/x&gt;
-     &lt;y&gt;0&lt;/y&gt;
-     &lt;width&gt;660&lt;/width&gt;
-     &lt;height&gt;22&lt;/height&gt;
-    &lt;/rect&gt;
-   &lt;/property&gt;
-   &lt;widget class=&quot;QMenu&quot; name=&quot;menuFile&quot; &gt;
-    &lt;property name=&quot;title&quot; &gt;
-     &lt;string&gt;File&lt;/string&gt;
-    &lt;/property&gt;
-    &lt;addaction name=&quot;actionNeu&quot; /&gt;
-    &lt;addaction name=&quot;actionClose&quot; /&gt;
-   &lt;/widget&gt;
-   &lt;widget class=&quot;QMenu&quot; name=&quot;menuView&quot; &gt;
-    &lt;property name=&quot;title&quot; &gt;
-     &lt;string&gt;View&lt;/string&gt;
-    &lt;/property&gt;
-    &lt;addaction name=&quot;actionSceneGraph&quot; /&gt;
-    &lt;addaction name=&quot;actionPreferences&quot; /&gt;
-    &lt;addaction name=&quot;actionProperty_Window&quot; /&gt;
-    &lt;addaction name=&quot;actionObject_Selection&quot; /&gt;
-    &lt;addaction name=&quot;actionConsole_Window&quot; /&gt;
-   &lt;/widget&gt;
-   &lt;addaction name=&quot;menuFile&quot; /&gt;
-   &lt;addaction name=&quot;menuView&quot; /&gt;
-  &lt;/widget&gt;
-  &lt;widget class=&quot;QStatusBar&quot; name=&quot;statusbar&quot; /&gt;
-  &lt;action name=&quot;actionNeu&quot; &gt;
-   &lt;property name=&quot;text&quot; &gt;
-    &lt;string&gt;Neu&lt;/string&gt;
-   &lt;/property&gt;
-  &lt;/action&gt;
-  &lt;action name=&quot;actionSceneGraph&quot; &gt;
-   &lt;property name=&quot;checkable&quot; &gt;
-    &lt;bool&gt;false&lt;/bool&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;text&quot; &gt;
-    &lt;string&gt;SceneGraph&lt;/string&gt;
-   &lt;/property&gt;
-  &lt;/action&gt;
-  &lt;action name=&quot;actionPreferences&quot; &gt;
-   &lt;property name=&quot;checkable&quot; &gt;
-    &lt;bool&gt;false&lt;/bool&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;text&quot; &gt;
-    &lt;string&gt;Preferences&lt;/string&gt;
-   &lt;/property&gt;
-  &lt;/action&gt;
-  &lt;action name=&quot;actionProperty_Window&quot; &gt;
-   &lt;property name=&quot;text&quot; &gt;
-    &lt;string&gt;Property Window&lt;/string&gt;
-   &lt;/property&gt;
-  &lt;/action&gt;
-  &lt;action name=&quot;actionObject_Selection&quot; &gt;
-   &lt;property name=&quot;text&quot; &gt;
-    &lt;string&gt;Object Selection&lt;/string&gt;
-   &lt;/property&gt;
-  &lt;/action&gt;
-  &lt;action name=&quot;actionClose&quot; &gt;
-   &lt;property name=&quot;text&quot; &gt;
-    &lt;string&gt;Quit&lt;/string&gt;
-   &lt;/property&gt;
-  &lt;/action&gt;
-  &lt;action name=&quot;actionConsole_Window&quot; &gt;
-   &lt;property name=&quot;text&quot; &gt;
-    &lt;string&gt;Console Window&lt;/string&gt;
-   &lt;/property&gt;
-  &lt;/action&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections/&gt;
-&lt;/ui&gt;

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/model_preview.ui
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/model_preview.ui	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/model_preview.ui	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,56 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;modelPreviewDialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;modelPreviewDialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;272&lt;/width&gt;
-    &lt;height&gt;744&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Dialog&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QLineEdit&quot; name=&quot;modelSearchBox&quot; /&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QSplitter&quot; name=&quot;splitter&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Vertical&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;widget class=&quot;QListWidget&quot; name=&quot;listWidget&quot; /&gt;
-     &lt;widget class=&quot;QWidget&quot; native=&quot;1&quot; name=&quot;modelPreviewWindow&quot; &gt;
-      &lt;property name=&quot;minimumSize&quot; &gt;
-       &lt;size&gt;
-        &lt;width&gt;200&lt;/width&gt;
-        &lt;height&gt;200&lt;/height&gt;
-       &lt;/size&gt;
-      &lt;/property&gt;
-     &lt;/widget&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;modelSearchBox&lt;/sender&gt;
-   &lt;signal&gt;textChanged(QString)&lt;/signal&gt;
-   &lt;receiver&gt;listWidget&lt;/receiver&gt;
-   &lt;slot&gt;clearSelection()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;115&lt;/x&gt;
-     &lt;y&gt;20&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;114&lt;/x&gt;
-     &lt;y&gt;48&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/object_property.ui
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/object_property.ui	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/object_property.ui	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,76 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;ObjectPropertys&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;ObjectPropertys&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;202&lt;/width&gt;
-    &lt;height&gt;724&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Object Properties&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;widget class=&quot;QTreeWidget&quot; name=&quot;treeWidget&quot; &gt;
-   &lt;property name=&quot;geometry&quot; &gt;
-    &lt;rect&gt;
-     &lt;x&gt;0&lt;/x&gt;
-     &lt;y&gt;0&lt;/y&gt;
-     &lt;width&gt;901&lt;/width&gt;
-     &lt;height&gt;721&lt;/height&gt;
-    &lt;/rect&gt;
-   &lt;/property&gt;
-   &lt;property name=&quot;minimumSize&quot; &gt;
-    &lt;size&gt;
-     &lt;width&gt;400&lt;/width&gt;
-     &lt;height&gt;400&lt;/height&gt;
-    &lt;/size&gt;
-   &lt;/property&gt;
-   &lt;column&gt;
-    &lt;property name=&quot;text&quot; &gt;
-     &lt;string&gt;Property&lt;/string&gt;
-    &lt;/property&gt;
-   &lt;/column&gt;
-   &lt;column&gt;
-    &lt;property name=&quot;text&quot; &gt;
-     &lt;string&gt;Value&lt;/string&gt;
-    &lt;/property&gt;
-   &lt;/column&gt;
-   &lt;item&gt;
-    &lt;property name=&quot;text&quot; &gt;
-     &lt;string&gt;Position&lt;/string&gt;
-    &lt;/property&gt;
-    &lt;property name=&quot;text&quot; &gt;
-     &lt;string/&gt;
-    &lt;/property&gt;
-    &lt;item&gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;X&lt;/string&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string/&gt;
-     &lt;/property&gt;
-    &lt;/item&gt;
-    &lt;item&gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Y&lt;/string&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string/&gt;
-     &lt;/property&gt;
-    &lt;/item&gt;
-    &lt;item&gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string&gt;Z&lt;/string&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;text&quot; &gt;
-      &lt;string/&gt;
-     &lt;/property&gt;
-    &lt;/item&gt;
-   &lt;/item&gt;
-  &lt;/widget&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections/&gt;
-&lt;/ui&gt;

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/preferences_dialog.ui
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/preferences_dialog.ui	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/preferences_dialog.ui	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,159 +0,0 @@
-&lt;ui version=&quot;4.0&quot; &gt;
- &lt;class&gt;PreferencesDialog&lt;/class&gt;
- &lt;widget class=&quot;QDialog&quot; name=&quot;PreferencesDialog&quot; &gt;
-  &lt;property name=&quot;geometry&quot; &gt;
-   &lt;rect&gt;
-    &lt;x&gt;0&lt;/x&gt;
-    &lt;y&gt;0&lt;/y&gt;
-    &lt;width&gt;528&lt;/width&gt;
-    &lt;height&gt;626&lt;/height&gt;
-   &lt;/rect&gt;
-  &lt;/property&gt;
-  &lt;property name=&quot;windowTitle&quot; &gt;
-   &lt;string&gt;Dialog&lt;/string&gt;
-  &lt;/property&gt;
-  &lt;layout class=&quot;QGridLayout&quot; &gt;
-   &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QToolBox&quot; name=&quot;toolBox&quot; &gt;
-     &lt;property name=&quot;currentIndex&quot; &gt;
-      &lt;number&gt;0&lt;/number&gt;
-     &lt;/property&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;ResourcePaths&quot; &gt;
-      &lt;property name=&quot;geometry&quot; &gt;
-       &lt;rect&gt;
-        &lt;x&gt;0&lt;/x&gt;
-        &lt;y&gt;0&lt;/y&gt;
-        &lt;width&gt;510&lt;/width&gt;
-        &lt;height&gt;505&lt;/height&gt;
-       &lt;/rect&gt;
-      &lt;/property&gt;
-      &lt;attribute name=&quot;label&quot; &gt;
-       &lt;string&gt;Resource Paths&lt;/string&gt;
-      &lt;/attribute&gt;
-      &lt;layout class=&quot;QGridLayout&quot; &gt;
-       &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-        &lt;widget class=&quot;QListWidget&quot; name=&quot;listWidget&quot; /&gt;
-       &lt;/item&gt;
-       &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-        &lt;widget class=&quot;QGroupBox&quot; name=&quot;groupBox&quot; &gt;
-         &lt;property name=&quot;minimumSize&quot; &gt;
-          &lt;size&gt;
-           &lt;width&gt;0&lt;/width&gt;
-           &lt;height&gt;95&lt;/height&gt;
-          &lt;/size&gt;
-         &lt;/property&gt;
-         &lt;property name=&quot;title&quot; &gt;
-          &lt;string&gt;GroupBox&lt;/string&gt;
-         &lt;/property&gt;
-         &lt;widget class=&quot;QWidget&quot; name=&quot;layoutWidget&quot; &gt;
-          &lt;property name=&quot;geometry&quot; &gt;
-           &lt;rect&gt;
-            &lt;x&gt;10&lt;/x&gt;
-            &lt;y&gt;20&lt;/y&gt;
-            &lt;width&gt;471&lt;/width&gt;
-            &lt;height&gt;67&lt;/height&gt;
-           &lt;/rect&gt;
-          &lt;/property&gt;
-          &lt;layout class=&quot;QGridLayout&quot; &gt;
-           &lt;item row=&quot;0&quot; column=&quot;0&quot; &gt;
-            &lt;widget class=&quot;QLineEdit&quot; name=&quot;lineEdit&quot; /&gt;
-           &lt;/item&gt;
-           &lt;item row=&quot;1&quot; column=&quot;0&quot; colspan=&quot;2&quot; &gt;
-            &lt;widget class=&quot;QPushButton&quot; name=&quot;loadModuleBtn&quot; &gt;
-             &lt;property name=&quot;text&quot; &gt;
-              &lt;string&gt;Load Selected Module&lt;/string&gt;
-             &lt;/property&gt;
-            &lt;/widget&gt;
-           &lt;/item&gt;
-           &lt;item row=&quot;0&quot; column=&quot;1&quot; &gt;
-            &lt;widget class=&quot;QPushButton&quot; name=&quot;modulConfigSelector&quot; &gt;
-             &lt;property name=&quot;text&quot; &gt;
-              &lt;string&gt;...&lt;/string&gt;
-             &lt;/property&gt;
-            &lt;/widget&gt;
-           &lt;/item&gt;
-          &lt;/layout&gt;
-         &lt;/widget&gt;
-        &lt;/widget&gt;
-       &lt;/item&gt;
-      &lt;/layout&gt;
-     &lt;/widget&gt;
-     &lt;widget class=&quot;QWidget&quot; name=&quot;OgreSettings&quot; &gt;
-      &lt;property name=&quot;geometry&quot; &gt;
-       &lt;rect&gt;
-        &lt;x&gt;0&lt;/x&gt;
-        &lt;y&gt;0&lt;/y&gt;
-        &lt;width&gt;96&lt;/width&gt;
-        &lt;height&gt;26&lt;/height&gt;
-       &lt;/rect&gt;
-      &lt;/property&gt;
-      &lt;attribute name=&quot;label&quot; &gt;
-       &lt;string&gt;Ogre Settings&lt;/string&gt;
-      &lt;/attribute&gt;
-     &lt;/widget&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-   &lt;item row=&quot;1&quot; column=&quot;0&quot; &gt;
-    &lt;widget class=&quot;QDialogButtonBox&quot; name=&quot;buttonBox&quot; &gt;
-     &lt;property name=&quot;orientation&quot; &gt;
-      &lt;enum&gt;Qt::Horizontal&lt;/enum&gt;
-     &lt;/property&gt;
-     &lt;property name=&quot;standardButtons&quot; &gt;
-      &lt;set&gt;QDialogButtonBox::Cancel|QDialogButtonBox::NoButton|QDialogButtonBox::Ok&lt;/set&gt;
-     &lt;/property&gt;
-    &lt;/widget&gt;
-   &lt;/item&gt;
-  &lt;/layout&gt;
- &lt;/widget&gt;
- &lt;resources/&gt;
- &lt;connections&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;accepted()&lt;/signal&gt;
-   &lt;receiver&gt;PreferencesDialog&lt;/receiver&gt;
-   &lt;slot&gt;accept()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;227&lt;/x&gt;
-     &lt;y&gt;387&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;157&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;rejected()&lt;/signal&gt;
-   &lt;receiver&gt;PreferencesDialog&lt;/receiver&gt;
-   &lt;slot&gt;reject()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;295&lt;/x&gt;
-     &lt;y&gt;387&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;286&lt;/x&gt;
-     &lt;y&gt;274&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
-  &lt;connection&gt;
-   &lt;sender&gt;buttonBox&lt;/sender&gt;
-   &lt;signal&gt;clicked(QAbstractButton*)&lt;/signal&gt;
-   &lt;receiver&gt;PreferencesDialog&lt;/receiver&gt;
-   &lt;slot&gt;close()&lt;/slot&gt;
-   &lt;hints&gt;
-    &lt;hint type=&quot;sourcelabel&quot; &gt;
-     &lt;x&gt;467&lt;/x&gt;
-     &lt;y&gt;387&lt;/y&gt;
-    &lt;/hint&gt;
-    &lt;hint type=&quot;destinationlabel&quot; &gt;
-     &lt;x&gt;240&lt;/x&gt;
-     &lt;y&gt;0&lt;/y&gt;
-    &lt;/hint&gt;
-   &lt;/hints&gt;
-  &lt;/connection&gt;
- &lt;/connections&gt;
-&lt;/ui&gt;

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/ui_ConsoleWindow.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/ui_ConsoleWindow.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/ui_ConsoleWindow.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,29 +0,0 @@
-# -*- coding: utf-8 -*-
-
-# Form implementation generated from reading ui file 'console_window.ui'
-#
-# Created: Mon May 12 15:09:24 2008
-#      by: PyQt4 UI code generator 4.3.3
-#
-# WARNING! All changes made in this file will be lost!
-
-from PyQt4 import QtCore, QtGui
-
-class Ui_ConsoleWindow(object):
-    def setupUi(self, ConsoleWindow):
-        ConsoleWindow.setObjectName(&quot;ConsoleWindow&quot;)
-        ConsoleWindow.resize(QtCore.QSize(QtCore.QRect(0,0,884,225).size()).expandedTo(ConsoleWindow.minimumSizeHint()))
-
-        self.gridlayout = QtGui.QGridLayout(ConsoleWindow)
-        self.gridlayout.setObjectName(&quot;gridlayout&quot;)
-
-        self.textEdit = QtGui.QTextEdit(ConsoleWindow)
-        self.textEdit.setObjectName(&quot;textEdit&quot;)
-        self.gridlayout.addWidget(self.textEdit,0,0,1,1)
-
-        self.retranslateUi(ConsoleWindow)
-        QtCore.QMetaObject.connectSlotsByName(ConsoleWindow)
-
-    def retranslateUi(self, ConsoleWindow):
-        ConsoleWindow.setWindowTitle(QtGui.QApplication.translate(&quot;ConsoleWindow&quot;, &quot;Form&quot;, None, QtGui.QApplication.UnicodeUTF8))
-

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/ui_FourPanelView.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/ui_FourPanelView.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/ui_FourPanelView.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,50 +0,0 @@
-# -*- coding: utf-8 -*-
-
-# Form implementation generated from reading ui file 'FourPanelView.ui'
-#
-# Created: Mon May 12 15:09:24 2008
-#      by: PyQt4 UI code generator 4.3.3
-#
-# WARNING! All changes made in this file will be lost!
-
-from PyQt4 import QtCore, QtGui
-
-class Ui_FourPaneView(object):
-    def setupUi(self, FourPaneView):
-        FourPaneView.setObjectName(&quot;FourPaneView&quot;)
-        FourPaneView.resize(QtCore.QSize(QtCore.QRect(0,0,827,856).size()).expandedTo(FourPaneView.minimumSizeHint()))
-
-        self.gridlayout = QtGui.QGridLayout(FourPaneView)
-        self.gridlayout.setObjectName(&quot;gridlayout&quot;)
-
-        self.splitter_3 = QtGui.QSplitter(FourPaneView)
-        self.splitter_3.setOrientation(QtCore.Qt.Horizontal)
-        self.splitter_3.setObjectName(&quot;splitter_3&quot;)
-
-        self.splitter = QtGui.QSplitter(self.splitter_3)
-        self.splitter.setOrientation(QtCore.Qt.Vertical)
-        self.splitter.setObjectName(&quot;splitter&quot;)
-
-        self.widget = QtGui.QWidget(self.splitter)
-        self.widget.setObjectName(&quot;widget&quot;)
-
-        self.widget_4 = QtGui.QWidget(self.splitter)
-        self.widget_4.setObjectName(&quot;widget_4&quot;)
-
-        self.splitter_2 = QtGui.QSplitter(self.splitter_3)
-        self.splitter_2.setOrientation(QtCore.Qt.Vertical)
-        self.splitter_2.setObjectName(&quot;splitter_2&quot;)
-
-        self.widget_2 = QtGui.QWidget(self.splitter_2)
-        self.widget_2.setObjectName(&quot;widget_2&quot;)
-
-        self.widget_3 = QtGui.QWidget(self.splitter_2)
-        self.widget_3.setObjectName(&quot;widget_3&quot;)
-        self.gridlayout.addWidget(self.splitter_3,0,0,1,1)
-
-        self.retranslateUi(FourPaneView)
-        QtCore.QMetaObject.connectSlotsByName(FourPaneView)
-
-    def retranslateUi(self, FourPaneView):
-        FourPaneView.setWindowTitle(QtGui.QApplication.translate(&quot;FourPaneView&quot;, &quot;Form&quot;, None, QtGui.QApplication.UnicodeUTF8))
-

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/ui_lw.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/ui_lw.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/ui_lw.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,94 +0,0 @@
-# -*- coding: utf-8 -*-
-
-# Form implementation generated from reading ui file 'lockewickler.ui'
-#
-# Created: Mon May 12 15:09:23 2008
-#      by: PyQt4 UI code generator 4.3.3
-#
-# WARNING! All changes made in this file will be lost!
-
-from PyQt4 import QtCore, QtGui
-
-class Ui_MainWindow(object):
-    def setupUi(self, MainWindow):
-        MainWindow.setObjectName(&quot;MainWindow&quot;)
-        MainWindow.resize(QtCore.QSize(QtCore.QRect(0,0,660,657).size()).expandedTo(MainWindow.minimumSizeHint()))
-
-        self.centralwidget = QtGui.QWidget(MainWindow)
-        self.centralwidget.setObjectName(&quot;centralwidget&quot;)
-
-        self.hboxlayout = QtGui.QHBoxLayout(self.centralwidget)
-        self.hboxlayout.setObjectName(&quot;hboxlayout&quot;)
-
-        self.gridlayout = QtGui.QGridLayout()
-        self.gridlayout.setObjectName(&quot;gridlayout&quot;)
-
-        self.ogreRenderWindow = QtGui.QWidget(self.centralwidget)
-        self.ogreRenderWindow.setMinimumSize(QtCore.QSize(250,250))
-        self.ogreRenderWindow.setObjectName(&quot;ogreRenderWindow&quot;)
-        self.gridlayout.addWidget(self.ogreRenderWindow,0,0,1,1)
-        self.hboxlayout.addLayout(self.gridlayout)
-        MainWindow.setCentralWidget(self.centralwidget)
-
-        self.menubar = QtGui.QMenuBar(MainWindow)
-        self.menubar.setGeometry(QtCore.QRect(0,0,660,22))
-        self.menubar.setObjectName(&quot;menubar&quot;)
-
-        self.menuFile = QtGui.QMenu(self.menubar)
-        self.menuFile.setObjectName(&quot;menuFile&quot;)
-
-        self.menuView = QtGui.QMenu(self.menubar)
-        self.menuView.setObjectName(&quot;menuView&quot;)
-        MainWindow.setMenuBar(self.menubar)
-
-        self.statusbar = QtGui.QStatusBar(MainWindow)
-        self.statusbar.setObjectName(&quot;statusbar&quot;)
-        MainWindow.setStatusBar(self.statusbar)
-
-        self.actionNeu = QtGui.QAction(MainWindow)
-        self.actionNeu.setObjectName(&quot;actionNeu&quot;)
-
-        self.actionSceneGraph = QtGui.QAction(MainWindow)
-        self.actionSceneGraph.setCheckable(False)
-        self.actionSceneGraph.setObjectName(&quot;actionSceneGraph&quot;)
-
-        self.actionPreferences = QtGui.QAction(MainWindow)
-        self.actionPreferences.setCheckable(False)
-        self.actionPreferences.setObjectName(&quot;actionPreferences&quot;)
-
-        self.actionProperty_Window = QtGui.QAction(MainWindow)
-        self.actionProperty_Window.setObjectName(&quot;actionProperty_Window&quot;)
-
-        self.actionObject_Selection = QtGui.QAction(MainWindow)
-        self.actionObject_Selection.setObjectName(&quot;actionObject_Selection&quot;)
-
-        self.actionClose = QtGui.QAction(MainWindow)
-        self.actionClose.setObjectName(&quot;actionClose&quot;)
-
-        self.actionConsole_Window = QtGui.QAction(MainWindow)
-        self.actionConsole_Window.setObjectName(&quot;actionConsole_Window&quot;)
-        self.menuFile.addAction(self.actionNeu)
-        self.menuFile.addAction(self.actionClose)
-        self.menuView.addAction(self.actionSceneGraph)
-        self.menuView.addAction(self.actionPreferences)
-        self.menuView.addAction(self.actionProperty_Window)
-        self.menuView.addAction(self.actionObject_Selection)
-        self.menuView.addAction(self.actionConsole_Window)
-        self.menubar.addAction(self.menuFile.menuAction())
-        self.menubar.addAction(self.menuView.menuAction())
-
-        self.retranslateUi(MainWindow)
-        QtCore.QMetaObject.connectSlotsByName(MainWindow)
-
-    def retranslateUi(self, MainWindow):
-        MainWindow.setWindowTitle(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;MainWindow&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.menuFile.setTitle(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;File&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.menuView.setTitle(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;View&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.actionNeu.setText(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;Neu&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.actionSceneGraph.setText(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;SceneGraph&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.actionPreferences.setText(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;Preferences&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.actionProperty_Window.setText(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;Property Window&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.actionObject_Selection.setText(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;Object Selection&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.actionClose.setText(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;Quit&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.actionConsole_Window.setText(QtGui.QApplication.translate(&quot;MainWindow&quot;, &quot;Console Window&quot;, None, QtGui.QApplication.UnicodeUTF8))
-

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/ui_model_prev.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/ui_model_prev.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/ui_model_prev.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,42 +0,0 @@
-# -*- coding: utf-8 -*-
-
-# Form implementation generated from reading ui file 'model_preview.ui'
-#
-# Created: Mon May 12 15:09:24 2008
-#      by: PyQt4 UI code generator 4.3.3
-#
-# WARNING! All changes made in this file will be lost!
-
-from PyQt4 import QtCore, QtGui
-
-class Ui_modelPreviewDialog(object):
-    def setupUi(self, modelPreviewDialog):
-        modelPreviewDialog.setObjectName(&quot;modelPreviewDialog&quot;)
-        modelPreviewDialog.resize(QtCore.QSize(QtCore.QRect(0,0,272,744).size()).expandedTo(modelPreviewDialog.minimumSizeHint()))
-
-        self.gridlayout = QtGui.QGridLayout(modelPreviewDialog)
-        self.gridlayout.setObjectName(&quot;gridlayout&quot;)
-
-        self.modelSearchBox = QtGui.QLineEdit(modelPreviewDialog)
-        self.modelSearchBox.setObjectName(&quot;modelSearchBox&quot;)
-        self.gridlayout.addWidget(self.modelSearchBox,0,0,1,1)
-
-        self.splitter = QtGui.QSplitter(modelPreviewDialog)
-        self.splitter.setOrientation(QtCore.Qt.Vertical)
-        self.splitter.setObjectName(&quot;splitter&quot;)
-
-        self.listWidget = QtGui.QListWidget(self.splitter)
-        self.listWidget.setObjectName(&quot;listWidget&quot;)
-
-        self.modelPreviewWindow = QtGui.QWidget(self.splitter)
-        self.modelPreviewWindow.setMinimumSize(QtCore.QSize(200,200))
-        self.modelPreviewWindow.setObjectName(&quot;modelPreviewWindow&quot;)
-        self.gridlayout.addWidget(self.splitter,1,0,1,1)
-
-        self.retranslateUi(modelPreviewDialog)
-        QtCore.QObject.connect(self.modelSearchBox,QtCore.SIGNAL(&quot;textChanged(QString)&quot;),self.listWidget.clearSelection)
-        QtCore.QMetaObject.connectSlotsByName(modelPreviewDialog)
-
-    def retranslateUi(self, modelPreviewDialog):
-        modelPreviewDialog.setWindowTitle(QtGui.QApplication.translate(&quot;modelPreviewDialog&quot;, &quot;Dialog&quot;, None, QtGui.QApplication.UnicodeUTF8))
-

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/ui_obj_prop.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/ui_obj_prop.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/ui_obj_prop.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,46 +0,0 @@
-# -*- coding: utf-8 -*-
-
-# Form implementation generated from reading ui file 'object_property.ui'
-#
-# Created: Mon May 12 15:09:23 2008
-#      by: PyQt4 UI code generator 4.3.3
-#
-# WARNING! All changes made in this file will be lost!
-
-from PyQt4 import QtCore, QtGui
-
-class Ui_ObjectPropertys(object):
-    def setupUi(self, ObjectPropertys):
-        ObjectPropertys.setObjectName(&quot;ObjectPropertys&quot;)
-        ObjectPropertys.resize(QtCore.QSize(QtCore.QRect(0,0,761,724).size()).expandedTo(ObjectPropertys.minimumSizeHint()))
-
-        self.treeWidget = QtGui.QTreeWidget(ObjectPropertys)
-        self.treeWidget.setGeometry(QtCore.QRect(0,0,901,721))
-        self.treeWidget.setMinimumSize(QtCore.QSize(400,400))
-        self.treeWidget.setObjectName(&quot;treeWidget&quot;)
-
-        self.retranslateUi(ObjectPropertys)
-        QtCore.QMetaObject.connectSlotsByName(ObjectPropertys)
-
-    def retranslateUi(self, ObjectPropertys):
-        ObjectPropertys.setWindowTitle(QtGui.QApplication.translate(&quot;ObjectPropertys&quot;, &quot;Object Properties&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.treeWidget.headerItem().setText(0,QtGui.QApplication.translate(&quot;ObjectPropertys&quot;, &quot;Property&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.treeWidget.headerItem().setText(1,QtGui.QApplication.translate(&quot;ObjectPropertys&quot;, &quot;Value&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.treeWidget.clear()
-
-        item = QtGui.QTreeWidgetItem(self.treeWidget)
-        item.setText(0,QtGui.QApplication.translate(&quot;ObjectPropertys&quot;, &quot;Position&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        item.setText(1,&quot;&quot;)
-
-        item1 = QtGui.QTreeWidgetItem(item)
-        item1.setText(0,QtGui.QApplication.translate(&quot;ObjectPropertys&quot;, &quot;X&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        item1.setText(1,&quot;&quot;)
-
-        item2 = QtGui.QTreeWidgetItem(item)
-        item2.setText(0,QtGui.QApplication.translate(&quot;ObjectPropertys&quot;, &quot;Y&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        item2.setText(1,&quot;&quot;)
-
-        item3 = QtGui.QTreeWidgetItem(item)
-        item3.setText(0,QtGui.QApplication.translate(&quot;ObjectPropertys&quot;, &quot;Z&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        item3.setText(1,&quot;&quot;)
-

Deleted: rl/branches/newton20/editors/Lockenwickler/ui files/ui_pref_dialog.py
===================================================================
--- rl/branches/newton20/editors/Lockenwickler/ui files/ui_pref_dialog.py	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/editors/Lockenwickler/ui files/ui_pref_dialog.py	2008-11-03 15:49:51 UTC (rev 4571)
@@ -1,85 +0,0 @@
-# -*- coding: utf-8 -*-
-
-# Form implementation generated from reading ui file 'preferences_dialog.ui'
-#
-# Created: Mon May 12 15:09:23 2008
-#      by: PyQt4 UI code generator 4.3.3
-#
-# WARNING! All changes made in this file will be lost!
-
-from PyQt4 import QtCore, QtGui
-
-class Ui_PreferencesDialog(object):
-    def setupUi(self, PreferencesDialog):
-        PreferencesDialog.setObjectName(&quot;PreferencesDialog&quot;)
-        PreferencesDialog.resize(QtCore.QSize(QtCore.QRect(0,0,528,626).size()).expandedTo(PreferencesDialog.minimumSizeHint()))
-
-        self.gridlayout = QtGui.QGridLayout(PreferencesDialog)
-        self.gridlayout.setObjectName(&quot;gridlayout&quot;)
-
-        self.toolBox = QtGui.QToolBox(PreferencesDialog)
-        self.toolBox.setObjectName(&quot;toolBox&quot;)
-
-        self.ResourcePaths = QtGui.QWidget()
-        self.ResourcePaths.setGeometry(QtCore.QRect(0,0,510,505))
-        self.ResourcePaths.setObjectName(&quot;ResourcePaths&quot;)
-
-        self.gridlayout1 = QtGui.QGridLayout(self.ResourcePaths)
-        self.gridlayout1.setObjectName(&quot;gridlayout1&quot;)
-
-        self.listWidget = QtGui.QListWidget(self.ResourcePaths)
-        self.listWidget.setObjectName(&quot;listWidget&quot;)
-        self.gridlayout1.addWidget(self.listWidget,0,0,1,1)
-
-        self.groupBox = QtGui.QGroupBox(self.ResourcePaths)
-        self.groupBox.setMinimumSize(QtCore.QSize(0,95))
-        self.groupBox.setObjectName(&quot;groupBox&quot;)
-
-        self.layoutWidget = QtGui.QWidget(self.groupBox)
-        self.layoutWidget.setGeometry(QtCore.QRect(10,20,471,67))
-        self.layoutWidget.setObjectName(&quot;layoutWidget&quot;)
-
-        self.gridlayout2 = QtGui.QGridLayout(self.layoutWidget)
-        self.gridlayout2.setObjectName(&quot;gridlayout2&quot;)
-
-        self.lineEdit = QtGui.QLineEdit(self.layoutWidget)
-        self.lineEdit.setObjectName(&quot;lineEdit&quot;)
-        self.gridlayout2.addWidget(self.lineEdit,0,0,1,1)
-
-        self.loadModuleBtn = QtGui.QPushButton(self.layoutWidget)
-        self.loadModuleBtn.setObjectName(&quot;loadModuleBtn&quot;)
-        self.gridlayout2.addWidget(self.loadModuleBtn,1,0,1,2)
-
-        self.modulConfigSelector = QtGui.QPushButton(self.layoutWidget)
-        self.modulConfigSelector.setObjectName(&quot;modulConfigSelector&quot;)
-        self.gridlayout2.addWidget(self.modulConfigSelector,0,1,1,1)
-        self.gridlayout1.addWidget(self.groupBox,1,0,1,1)
-        self.toolBox.addItem(self.ResourcePaths,&quot;&quot;)
-
-        self.OgreSettings = QtGui.QWidget()
-        self.OgreSettings.setGeometry(QtCore.QRect(0,0,96,26))
-        self.OgreSettings.setObjectName(&quot;OgreSettings&quot;)
-        self.toolBox.addItem(self.OgreSettings,&quot;&quot;)
-        self.gridlayout.addWidget(self.toolBox,0,0,1,1)
-
-        self.buttonBox = QtGui.QDialogButtonBox(PreferencesDialog)
-        self.buttonBox.setOrientation(QtCore.Qt.Horizontal)
-        self.buttonBox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.NoButton|QtGui.QDialogButtonBox.Ok)
-        self.buttonBox.setObjectName(&quot;buttonBox&quot;)
-        self.gridlayout.addWidget(self.buttonBox,1,0,1,1)
-
-        self.retranslateUi(PreferencesDialog)
-        self.toolBox.setCurrentIndex(0)
-        QtCore.QObject.connect(self.buttonBox,QtCore.SIGNAL(&quot;accepted()&quot;),PreferencesDialog.accept)
-        QtCore.QObject.connect(self.buttonBox,QtCore.SIGNAL(&quot;rejected()&quot;),PreferencesDialog.reject)
-        QtCore.QObject.connect(self.buttonBox,QtCore.SIGNAL(&quot;clicked(QAbstractButton*)&quot;),PreferencesDialog.close)
-        QtCore.QMetaObject.connectSlotsByName(PreferencesDialog)
-
-    def retranslateUi(self, PreferencesDialog):
-        PreferencesDialog.setWindowTitle(QtGui.QApplication.translate(&quot;PreferencesDialog&quot;, &quot;Dialog&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.groupBox.setTitle(QtGui.QApplication.translate(&quot;PreferencesDialog&quot;, &quot;GroupBox&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.loadModuleBtn.setText(QtGui.QApplication.translate(&quot;PreferencesDialog&quot;, &quot;Load Selected Module&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.modulConfigSelector.setText(QtGui.QApplication.translate(&quot;PreferencesDialog&quot;, &quot;...&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.toolBox.setItemText(self.toolBox.indexOf(self.ResourcePaths), QtGui.QApplication.translate(&quot;PreferencesDialog&quot;, &quot;Resource Paths&quot;, None, QtGui.QApplication.UnicodeUTF8))
-        self.toolBox.setItemText(self.toolBox.indexOf(self.OgreSettings), QtGui.QApplication.translate(&quot;PreferencesDialog&quot;, &quot;Ogre Settings&quot;, None, QtGui.QApplication.UnicodeUTF8))
-

Modified: rl/branches/newton20/engine/ui/include/CombatControlState.h
===================================================================
--- rl/branches/newton20/engine/ui/include/CombatControlState.h	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/engine/ui/include/CombatControlState.h	2008-11-03 15:49:51 UTC (rev 4571)
@@ -41,6 +41,14 @@
             public PhysicsGenericContactCallback
 	{
 	public:
+        /** 
+         * Different view-modes:
+         * @VM_COMBAT_CENTERED: &quot;cameraLookAt&quot; to center of combat (middle of all combatant positions)
+         * @VM_THIRD_PERSON: zooms to one combatant (not only hero!)
+        */
+        typedef enum {VM_COMBAT_CENTERED, VM_THIRD_PERSON} ViewMode;
+
+
 		/**
 		*  @throw NullPointerException if camera is NULL.
 		*  @warning Ownership of combat is taken by the CombatControlState.
@@ -70,6 +78,13 @@
         // camera movement: Newton force and torque callback
         void OnApplyForceAndTorque(PhysicalThing *pt, float timstep);
 
+        // Change ViewMode
+        void setViewMode(ViewMode mode);
+        ViewMode getViewMode();
+        void toggleViewMode();
+        // set the combatant (must be part of this combat), the camera should focus on (VM_THIRD_PERSON) (only used internally?)
+        void setCameraFocusedCombatant(Combatant* combatant);
+
     private:
 		enum State {REQUEST_USER_INPUT, ROUND_EXECUTION};
 
@@ -90,17 +105,36 @@
         CameraObject* mCamera;
 
 		State mState;
+
         // Camera:
         Ogre::Degree mCameraYaw, mCameraPitch;
-        Ogre::Real mMaxCameraDistance, mMinCameraDistance;
-        int mMovementState;
+        Ogre::Real mCameraMaxDistance, mCameraCombatCenteredMinDistance, mCameraThirdPersonMinDistance;
+        int mMovementState; // keyboard input
         Ogre::Real mCameraLinearDampingK, mCameraLinearSpringK;
+        ViewMode mViewMode;
+        Ogre::Vector3 mCameraLookAt; // set by calculateOptimalCameraPositionAndLookAt
+        Ogre::Vector3 mCameraOptPos; // set by calculateOptimalCameraPositionAndLookAt
+        Ogre::Real mCameraDistance; // only used in third-person, changed by calculateOptimalCameraAndPosition
+        Ogre::Real mCameraSwitchDist; // set by calculateOptimalCameraPositionAndLookAt, dist at which switches to third-person
+        Ogre::Real mCameraSwitchTransitionDist; // relative value (0-1) of mCameraSwitchDist
+        Combatant* mCameraFocusedCombatant;  // the combatant currently focused by camera (VM_THIRD_PERSON)
+        // when switching from one view-mode to another or when changing focused combatant, these variables are used
+        // to provide smooth camera movement
+        bool mCameraTransitionLookAtActive;
+        bool mCameraTransitionPositionActive;
+        Ogre::Vector3 mCameraTransitionPosition;
+        Ogre::Vector3 mCameraTransitionLookAt;
+        // buffered values needed fo camera-movement, calculated once per frame:
+        Ogre::Vector3 mCombatCenter; // result of calculateCombatCenterPosition
+        Ogre::Real mCombatRadius; // result of calculateCombatRadius
 
         // Camera helper functions
         void resetCamera();
         void updateCameraLookAt(Ogre::Real timestep);
-        Ogre::Vector3 getCombatCenterPosition();
-        Ogre::Vector3 calculateOptimalCameraPosition();
+        Ogre::Vector3 calculateCombatCenterPosition();
+        Ogre::Real calculateCombatRadius(Ogre::Vector3 center);
+        // sets the variables mCameraLookAt, mCameraOptPos, mCameraDistance, usually called in OnApplyForceAndTorque
+        void calculateOptimalCameraPositionAndLookAt();
         
         // Event handlers
 		bool userRequestAttackOpponent(Combatant*);

Modified: rl/branches/newton20/engine/ui/src/CombatControlState.cpp
===================================================================
--- rl/branches/newton20/engine/ui/src/CombatControlState.cpp	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/engine/ui/src/CombatControlState.cpp	2008-11-03 15:49:51 UTC (rev 4571)
@@ -56,8 +56,15 @@
           mMovementState(0),
           mCameraLinearSpringK(100.0f),
           mCameraLinearDampingK(Math::NEG_INFINITY),
-          mMaxCameraDistance(30.0f),
-          mMinCameraDistance(5.0f)
+          mViewMode(VM_COMBAT_CENTERED),
+          mCameraFocusedCombatant(NULL),
+          mCameraTransitionLookAtActive(false),
+          mCameraTransitionPositionActive(false),
+          mCameraMaxDistance(30.0f),
+          mCameraCombatCenteredMinDistance(5.0f),
+          mCameraThirdPersonMinDistance(1.0f),
+          mCameraSwitchDist(30.0f),
+          mCameraSwitchTransitionDist(0.3f)
     {
         CreatureSelectionFilter* filter = new CreatureSelectionFilter();
         filter-&gt;setAlignmentMask(Creature::ALIGNMENT_ENEMY);
@@ -129,10 +136,7 @@
         mat_pair-&gt;setDefaultFriction(0,0);
         mat_pair-&gt;setDefaultFriction(0,1);
 
-        // reset camera
-        //resetCamera(); // if you don't call this here, the camera should smoothly move to the new position -&gt; looks nicer
-        // perhaps this should be handled differently!
-        mMovementState = 0;
+       
 
 
         ///\todo Richtig machen, nur tempor&#228;r Ani hier setzen.
@@ -166,6 +170,24 @@
         mCombat-&gt;addAlly(this);
 
         mCombat-&gt;start();
+
+        // reset camera
+        //resetCamera(); // if you don't call this here, the camera should smoothly move to the new position -&gt; looks nicer
+        // perhaps this should be handled differently!
+        mMovementState = 0;
+        // calculate some buffered values, so they are initialized:
+        mCameraTransitionPositionActive = false;
+        mCameraTransitionLookAtActive = false;
+        mCameraFocusedCombatant = this;
+        mCameraYaw = Degree(0);
+        mCameraPitch = Degree(50);
+        mCameraDistance = 30.0f; // only used for third-person
+        mCombatCenter = calculateCombatCenterPosition();
+        mCombatRadius = calculateCombatRadius(mCombatCenter);
+        calculateOptimalCameraPositionAndLookAt();
+ 
+        // update CombatGui
+        mCombatGui-&gt;update();
     }
 
     void CombatControlState::pause()
@@ -228,37 +250,69 @@
 
     void CombatControlState::run(Ogre::Real elapsedTime)
     {
+        // updateCameraLookAt should be called before mCombatGui-&gt;update()!
+
+        // update camera look-at position
+        updateCameraLookAt(elapsedTime);
+
+
         // update CombatGui
         mCombatGui-&gt;update();
 
 
-
-        // update camera look-at position
-        updateCameraLookAt(elapsedTime);
-
+        // slow down rotational movement, when radius grows
         if( mMovementState &amp; MOVE_RIGHT )
-            mCameraYaw += Degree( 360.0/10.0 * elapsedTime );
+            mCameraYaw += Degree( 360.0/2.0 * elapsedTime / Math::Sqrt(mCameraDistance) );
         if( mMovementState &amp; MOVE_LEFT )
-            mCameraYaw -= Degree( 360.0/10.0 * elapsedTime );
+            mCameraYaw -= Degree( 360.0/2.0 * elapsedTime / Math::Sqrt(mCameraDistance) );
+        if( mMovementState &amp; MOVE_FORWARD )
+            mCameraDistance -= 5 * elapsedTime;
+        if( mMovementState &amp; MOVE_BACKWARD )
+            mCameraDistance += 5 * elapsedTime;
 
+        mCameraDistance = std::max( mCameraDistance, mCameraThirdPersonMinDistance);
+        mCameraDistance = std::min( mCameraDistance, mCameraMaxDistance);
+
+        // switch view mode smoothly if nearer:
+        if( mViewMode == VM_COMBAT_CENTERED )
+        {
+            if( mMovementState &amp; MOVE_FORWARD )
+            {
+                mViewMode = VM_THIRD_PERSON;
+            }
+        }
+        else // VM_THIRD_PERSON
+        {
+            if( mCameraDistance &gt;= mCameraSwitchDist - 0.05f &amp;&amp; mMovementState &amp; MOVE_BACKWARD )
+            {
+                mViewMode = VM_COMBAT_CENTERED;
+            }
+        }
     }
 
     void CombatControlState::resetCamera(void)
     {
+        mCombatCenter = calculateCombatCenterPosition();
+        mCombatRadius = calculateCombatRadius(mCombatCenter);
+        mCameraTransitionPositionActive = false;
+        mCameraTransitionLookAtActive = false;
         mCameraYaw = Degree(0);
         mCameraPitch = Degree(50);
-        mCameraActor-&gt;setPosition(calculateOptimalCameraPosition());
+        if( mViewMode == VM_THIRD_PERSON )
+            mCameraDistance = 2.0f; // only used for third-person
+        calculateOptimalCameraPositionAndLookAt();
+        mCameraActor-&gt;setPosition(mCameraOptPos);
+        SceneNode* cameraNode = mCameraActor-&gt;_getSceneNode();
+        cameraNode-&gt;lookAt(mCameraLookAt, Node::TS_WORLD);
     }
 
     void CombatControlState::updateCameraLookAt(Real elapsedTime)
     {
-        Vector3 combatCenter = getCombatCenterPosition();
         SceneNode* cameraNode = mCameraActor-&gt;_getSceneNode();
-
-        cameraNode-&gt;lookAt(combatCenter + 2*Vector3::UNIT_Y, Node::TS_WORLD);
+        cameraNode-&gt;lookAt(mCameraLookAt, Node::TS_WORLD);
     }
 
-    Vector3 CombatControlState::getCombatCenterPosition()
+    Vector3 CombatControlState::calculateCombatCenterPosition()
     {
         // get the center of all persons (allies and opponents)
         int n = 0;
@@ -287,11 +341,9 @@
 
         return pos;
     }
-    
-    Vector3 CombatControlState::calculateOptimalCameraPosition()
+
+    Real CombatControlState::calculateCombatRadius(Vector3 center)
     {
-        Vector3 center = getCombatCenterPosition();
-
         // get the greatest distance from center from all persons
         Real distance = 0;
         const Combat::CombatantSet &amp;allies (mCombat-&gt;getAllAllies() );
@@ -304,31 +356,77 @@
         {
             distance = std::max( ( (*it)-&gt;getCreature()-&gt;getPosition() - center ).length(), distance );
         }
-        distance+=2;
+        return distance;
+    }
+    
+    void CombatControlState::calculateOptimalCameraPositionAndLookAt()
+    {
+        // some variables:
+        Vector3 playerPos = mCharacter-&gt;getPosition();
+        mCombatCenter = calculateCombatCenterPosition();
+        mCombatRadius = calculateCombatRadius(mCombatCenter);
 
 
+
+        // calculate camera-distance for VM_COMBAT_CENTERED (needed for third-person view, too)
+        Real combatCenteredDistance = mCombatRadius + 2; // this is camera-distance from center projected to the plane!
+            
         // put camera on the line player-center far enough to see all persons
         // if player is &quot;exactly&quot; in the center, use player orientation as fallback orientation
         // + rotation from mCameraYaw
-        Vector3 playerPos = mCharacter-&gt;getPosition();
-        Vector3 diff = playerPos - center;
+        Vector3 diff = playerPos - mCombatCenter;
         diff.y = 0;
-        Quaternion camYaw;
-        camYaw.FromAngleAxis(mCameraYaw, Vector3::UNIT_Y);
+        Quaternion combatCenteredCamYaw;
+        combatCenteredCamYaw.FromAngleAxis(mCameraYaw, Vector3::UNIT_Y);
         if( diff.squaredLength() &lt; 0.01 )
         {
             diff = mCharacterActor-&gt;getOrientation()*Vector3::UNIT_Z;
         }
         diff.y = 0;
         diff.normalise();
-        diff = camYaw*diff;
+        diff = combatCenteredCamYaw*diff;
         diff.y = Math::Tan(mCameraPitch.valueRadians());
 
-        distance = std::max( distance,  mMinCameraDistance*Math::Cos(mCameraPitch.valueRadians()) );
-        distance = std::min( distance,  mMaxCameraDistance*Math::Cos(mCameraPitch.valueRadians()) );
-            
-        Vector3 camPos = center + distance*diff;
-        return camPos;
+        Real cosPitch = Math::Cos(mCameraPitch.valueRadians());
+        combatCenteredDistance = std::max( combatCenteredDistance,  mCameraCombatCenteredMinDistance*cosPitch );
+        combatCenteredDistance = std::min( combatCenteredDistance,  mCameraMaxDistance*cosPitch );
+ 
+
+
+
+
+        // TODO
+        // Bewegung wirkt zu eckig... evt hilft es lookat und position separat zu berechnen
+        // und dabei das lookat schneller auf den anvisierten combatant zu setzen...
+        // ideal scheint mir eine &quot;runde&quot; bewegung, a la kamerafahrt!
+
+
+        Vector3 center;
+        Vector3 dist;
+        if( mViewMode == VM_THIRD_PERSON &amp;&amp; mCameraFocusedCombatant )
+        {
+            center = mCameraFocusedCombatant-&gt;getPosition();
+            // if mCameraDistance is near the one needed for combatCentered,
+            // interpolate the center (between center of third-person-view
+            // and center of combat-centered-view)
+            Real interpolateDist = std::max(0.0f, combatCenteredDistance - mCameraDistance*cosPitch) / cosPitch;
+            if( interpolateDist &lt;  mCameraSwitchTransitionDist*mCameraSwitchDist )
+            {
+                center += (mCombatCenter - center)*(1 - interpolateDist/(mCameraSwitchTransitionDist*mCameraSwitchDist));
+            }
+            dist = mCameraDistance*cosPitch;
+        }
+        else // assume VM_COMBAT_CENTERED
+        {
+            center = mCombatCenter;
+            // update camera-distance variable
+            mCameraDistance = (combatCenteredDistance*diff).length();
+            dist = combatCenteredDistance;
+        }
+
+        mCameraSwitchDist = (combatCenteredDistance*diff).length();
+        mCameraOptPos = center + dist*diff;
+        mCameraLookAt = center + 1.4*Vector3::UNIT_Y;
     }
 
     void CombatControlState::OnApplyForceAndTorque(PhysicalThing* thing, float timestep)
@@ -337,10 +435,32 @@
         Quaternion camOri;
         mCamBody-&gt;getPositionOrientation(camPos, camOri);
 
-        Vector3 optimalCamPos = calculateOptimalCameraPosition();
+        calculateOptimalCameraPositionAndLookAt();
 
+        // handle transition
+        if( mCameraTransitionPositionActive )
+        {
+            Vector3 diff = mCameraOptPos - mCameraTransitionPosition;
+            Real dist = diff.length();
+            Vector3 dir = diff/dist;
+            mCameraTransitionPosition += dir*std::min(dist, 0.5f*timestep);
+            if( (mCameraTransitionPosition - mCameraOptPos).squaredLength() &lt; 0.02 )
+                mCameraTransitionPositionActive = false;
+            mCameraOptPos = mCameraTransitionPosition;
+        }
+        if( mCameraTransitionLookAtActive )
+        {
+            Vector3 diff = mCameraLookAt - mCameraTransitionLookAt;
+            Real dist = diff.length();
+            Vector3 dir = diff/dist;
+            mCameraTransitionLookAt += dir * std::min(dist,0.5f*timestep);
+            if( (mCameraLookAt-mCameraTransitionLookAt).squaredLength() &lt; 0.02 )
+                mCameraTransitionLookAtActive = false;
+            mCameraLookAt = mCameraTransitionLookAt;
+        }
 
-        Vector3 diff = camPos - optimalCamPos;
+
+        Vector3 diff = camPos - mCameraOptPos;
         Vector3 cameraVelocity;
         cameraVelocity = mCamBody-&gt;getVelocity();
         // spring velocity
@@ -354,6 +474,46 @@
         mCamBody-&gt;setForce(springAcc * mass);
     }
 
+    void CombatControlState::setViewMode(ViewMode mode)
+    {
+        if(mode != mViewMode)
+        {
+            mViewMode = mode;
+            mCameraTransitionPosition = mCameraActor-&gt;getPosition();
+            mCameraTransitionLookAt = mCameraLookAt;
+            mCameraTransitionLookAtActive = true;
+            mCameraTransitionPositionActive = true;
+        }
+    }
+
+    void CombatControlState::toggleViewMode()
+    {
+        if( mViewMode == VM_COMBAT_CENTERED )
+            setViewMode(VM_THIRD_PERSON);
+        else
+            setViewMode(VM_COMBAT_CENTERED);
+    }
+
+    CombatControlState::ViewMode CombatControlState::getViewMode()
+    {
+        return mViewMode;
+    }
+
+    void CombatControlState::setCameraFocusedCombatant(Combatant* combatant)
+    {
+        if( combatant != mCameraFocusedCombatant )
+        {
+            if( mViewMode == VM_THIRD_PERSON )
+            {
+                mCameraTransitionPosition = mCameraActor-&gt;getPosition();
+                mCameraTransitionLookAt = mCameraLookAt;
+                mCameraTransitionLookAtActive = true;
+                mCameraTransitionPositionActive = true;
+            }
+        }
+        mCameraFocusedCombatant = combatant;
+    }
+
     int CombatControlState::onAABBOverlap(int threadIndex)
     {
         // TODO handle camera collisions here

Modified: rl/branches/newton20/engine/ui/src/CombatGui.cpp
===================================================================
--- rl/branches/newton20/engine/ui/src/CombatGui.cpp	2008-10-31 16:37:06 UTC (rev 4570)
+++ rl/branches/newton20/engine/ui/src/CombatGui.cpp	2008-11-03 15:49:51 UTC (rev 4571)
@@ -104,14 +104,15 @@
                 (*it)-&gt;getCreatureController()-&gt;getCreature()-&gt;getActor()
                     -&gt;_getSceneNode()-&gt;_getWorldAABB());
 
-			// Place buttons, if needed by current state
-			if (mUserInputEnabled)
-			{
-				Ogre::Rect screenRect = mCamera-&gt;getPixelRectOnScreen(rec);
-				// Place button set above opponent, horizontally centered.
-				int xpos = screenRect.left + ((screenRect.right - screenRect.left) - setSize.first) / 2;
-				mCombatWindow-&gt;placeEnemyButtonSet(mOpponentButtons[*it], xpos, screenRect.top - setSize.second);
-			}
+			// Place buttons, update every frame (camera movement requires this)
+                        // TODO: is there any better possibility (attach button-windows to ogre node?!?)
+			//if (mUserInputEnabled)
+			//{
+			Ogre::Rect screenRect = mCamera-&gt;getPixelRectOnScreen(rec);
+			// Place button set above opponent, horizontally centered.
+			int xpos = screenRect.left + ((screenRect.right - screenRect.left) - setSize.first) / 2;
+			mCombatWindow-&gt;placeEnemyButtonSet(mOpponentButtons[*it], xpos, screenRect.top - setSize.second);
+			//}
 
 			// draw Hud
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="001629.html">[Dsa-hl-svn] r4572 - in rl/trunk/editors/Lockenwickler/src: . media	media/icons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1628">[ date ]</a>
              <a href="thread.html#1628">[ thread ]</a>
              <a href="subject.html#1628">[ subject ]</a>
              <a href="author.html#1628">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
