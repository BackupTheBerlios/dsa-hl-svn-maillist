<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r3852 - in modules: common/materials	common/materials/model common/materials/programs	common/materials/programs/Normalmapping common/models	ruchin/dsa ruchin/maps ruchin/models ruchin/scripts	ruchin/scripts/maps
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r3852%20-%20in%20modules%3A%20common/materials%0A%09common/materials/model%20common/materials/programs%0A%09common/materials/programs/Normalmapping%20common/models%0A%09ruchin/dsa%20ruchin/maps%20ruchin/models%20ruchin/scripts%0A%09ruchin/scripts/maps&In-Reply-To=%3C200709160941.l8G9f8Aq005900%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000922.html">
   <LINK REL="Next"  HREF="000924.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r3852 - in modules: common/materials	common/materials/model common/materials/programs	common/materials/programs/Normalmapping common/models	ruchin/dsa ruchin/maps ruchin/models ruchin/scripts	ruchin/scripts/maps</H1>
    <B>pnyx at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r3852%20-%20in%20modules%3A%20common/materials%0A%09common/materials/model%20common/materials/programs%0A%09common/materials/programs/Normalmapping%20common/models%0A%09ruchin/dsa%20ruchin/maps%20ruchin/models%20ruchin/scripts%0A%09ruchin/scripts/maps&In-Reply-To=%3C200709160941.l8G9f8Aq005900%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r3852 - in modules: common/materials	common/materials/model common/materials/programs	common/materials/programs/Normalmapping common/models	ruchin/dsa ruchin/maps ruchin/models ruchin/scripts	ruchin/scripts/maps">pnyx at mail.berlios.de
       </A><BR>
    <I>Sun Sep 16 11:41:08 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000922.html">[Dsa-hl-svn] r3851 - rl/trunk/engine/rules/include
</A></li>
        <LI>Next message: <A HREF="000924.html">[Dsa-hl-svn] r3853 - in modules: aitest/models common/models
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#923">[ date ]</a>
              <a href="thread.html#923">[ thread ]</a>
              <a href="subject.html#923">[ subject ]</a>
              <a href="author.html#923">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: pnyx
Date: 2007-09-16 11:34:55 +0200 (Sun, 16 Sep 2007)
New Revision: 3852

Added:
   modules/common/materials/programs/Basic_Vertex_Shader_noDirectional.source
   modules/common/materials/programs/Normalmapping/Basic_Normalmapping_UV0_noDirectional_VS.hlsl
   modules/ruchin/models/Ruchin_Hessi_innen.mesh
   modules/ruchin/models/Ruchin_g.mesh
   modules/ruchin/scripts/equip.rb
Removed:
   modules/ruchin/dsa/mckherotest.gof
Modified:
   modules/common/materials/men_human_female_hair_long01_normal.mesh.material
   modules/common/materials/model/men_human_female_hair_long_01_spec.png
   modules/common/materials/programs/Basic_Vertex_Shader.program
   modules/common/materials/programs/Normalmapping/Basic_Normalmapping.material
   modules/common/materials/programs/Normalmapping/Basic_Normalmapping_Spec.material
   modules/common/materials/programs/Normalmapping/Normalmapping.program
   modules/common/materials/programs/Normalmapping/Skin_Normalmapping.material
   modules/common/models/men_human_female_cloth_long.mesh
   modules/common/models/men_human_female_cloth_short.mesh
   modules/common/models/men_human_female_leg_pants_01_long.mesh
   modules/common/models/men_human_female_torso.mesh
   modules/ruchin/maps/ruchin_lightzones.rlmap.xml
   modules/ruchin/models/House_dummies.mesh
   modules/ruchin/models/Ruchin_inside.material
   modules/ruchin/models/Ruchin_l.mesh
   modules/ruchin/models/Ruchin_map.mesh
   modules/ruchin/models/Ruchin_n.mesh
   modules/ruchin/models/Ruchin_s.mesh
   modules/ruchin/models/Ruchintest.material
   modules/ruchin/models/Stadtmauer.mesh
   modules/ruchin/scripts/maps/maptest.rb
Log:
Added WIP of part g
Added Hessi interior
Added Shader that ignores directional lights to fake interior light form outside the zone.
Changed stuff I cant remember :)

Modified: modules/common/materials/men_human_female_hair_long01_normal.mesh.material
===================================================================
--- modules/common/materials/men_human_female_hair_long01_normal.mesh.material	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/men_human_female_hair_long01_normal.mesh.material	2007-09-16 09:34:55 UTC (rev 3852)
@@ -1,5 +1,5 @@
 
-material men_human_female_hair_long_01_normal : Basic_Normalmapping_Spec_Alpha
+material men_human_female_hair_long_01_normal : Basic_Normalmapping_Spec_Hair
 {
 set_texture_alias DiffuseMap men_human_female_hair_long_01.png
 set_texture_alias NormalMap men_human_female_hair_long_01_normal.png

Modified: modules/common/materials/model/men_human_female_hair_long_01_spec.png
===================================================================
(Binary files differ)

Modified: modules/common/materials/programs/Basic_Vertex_Shader.program
===================================================================
--- modules/common/materials/programs/Basic_Vertex_Shader.program	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/programs/Basic_Vertex_Shader.program	2007-09-16 09:34:55 UTC (rev 3852)
@@ -7,7 +7,15 @@
 	target vs_2_0
 	entry_point vs_main
 }
-//DirectX 9.0 HLSL Pixel Shader ps_2_0
+
+vertex_program Basic_Vertex_Shader_noDirectional hlsl
+{
+	source Basic_Vertex_Shader_noDirectional.source
+	target vs_2_0
+	entry_point vs_main
+}
+
+//DirectX 9.0 HLSL Pixel Shader ps_2_0 
 fragment_program Basic_Pixel_Shader hlsl
 {
 	source Basic_Pixel_Shader.source
@@ -141,3 +149,114 @@
         }
     }
 }
+
+
+material Basic_Vertex_Shader_noDirectional
+{
+	receive_shadows off
+	technique glsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader_glsl
+			{
+				param_named baseMap int 0
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_glsl
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+			
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+	}
+	
+	technique hlsl
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader
+			{
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader_noDirectional
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+			
+			texture_unit
+			{
+				texture_alias diffuse
+
+			}
+		}
+	}
+
+	technique
+	{
+        pass
+        {
+            texture_unit
+            {
+                texture_alias diffuse
+            }
+        }
+    }
+}

Added: modules/common/materials/programs/Basic_Vertex_Shader_noDirectional.source
===================================================================
--- modules/common/materials/programs/Basic_Vertex_Shader_noDirectional.source	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/programs/Basic_Vertex_Shader_noDirectional.source	2007-09-16 09:34:55 UTC (rev 3852)
@@ -0,0 +1,119 @@
+float4x4 matViewProjection;
+float4 skycolor;
+float4 groundcolor;
+float4 Light1_attenuation;
+float4 Light1_position;
+float4 Light1_color;
+float4 Light1_spec_power;
+
+float4 Light2_attenuation;
+float4 Light2_position;
+float4 Light2_color;
+float4 Light2_spec_power;
+
+float4 Light3_attenuation;
+float4 Light3_position;
+float4 Light3_color;
+float4 Light3_spec_power;
+
+float4 vViewPosition;
+
+struct VS_INPUT 
+{
+   float4 Position : POSITION0;
+   float2 Texcoord : TEXCOORD0;
+   float2 Texcoord1 : TEXCOORD1;
+   float2 Texcoord2: TEXCOORD2;
+   float3 Normal   : NORMAL;
+   
+};
+
+struct VS_OUTPUT 
+{
+   float4 Position : POSITION0;
+   float2 Texcoord : TEXCOORD0;
+   float2 Texcoord1: TEXCOORD1;
+   float2 Texcoord2: TEXCOORD2;
+   float4 Color    : TEXCOORD3;
+   
+};
+
+VS_OUTPUT vs_main( VS_INPUT Input )
+{
+   VS_OUTPUT Output;
+   Output.Color = lerp(skycolor,groundcolor,(dot(Input.Normal, float3(0,-1,0))+1)/2 );
+   Output.Position = mul( matViewProjection, Input.Position );
+   
+   
+   
+   // Light1
+   
+   float3 LightDir = Light1_position - Input.Position;
+   float Dist = length(LightDir);
+   LightDir = LightDir / Dist;
+   
+   float AngleAttn = saturate( dot(Input.Normal ,LightDir));
+   
+   float3 EyeVect = normalize(Input.Position - vViewPosition);
+   float3 HalfVect = normalize(LightDir - EyeVect);
+   
+   float SpecAttn = Light1_color * Light1_spec_power * pow(clamp(dot(Input.Normal,HalfVect),0,1),32);
+   
+   float DistAttn = clamp(1/ (Light1_attenuation.y +
+                              Light1_attenuation.z * Dist +
+                              Light1_attenuation.w * Dist * Dist)
+                          ,0,1);
+   
+   Output.Color += (Light1_color * AngleAttn + SpecAttn) * DistAttn * Light1_position.w;
+   
+   
+   // Light3
+   
+   LightDir = Light3_position - Input.Position;
+   Dist = length(LightDir);
+   LightDir = LightDir / Dist;
+   
+   AngleAttn = saturate( dot(Input.Normal ,LightDir));
+   
+   EyeVect = normalize(Input.Position - vViewPosition);
+   HalfVect = normalize(LightDir - EyeVect);
+   
+   SpecAttn = Light3_color * Light3_spec_power * pow(clamp(dot(Input.Normal,HalfVect),0,1),32);
+   
+   DistAttn = clamp(1/ (Light3_attenuation.y +
+                              Light3_attenuation.z * Dist +
+                              Light3_attenuation.w * Dist * Dist)
+                          ,0,1);
+   
+   Output.Color += (Light3_color * AngleAttn + SpecAttn) * DistAttn * Light3_position.w;
+   
+   
+   // Light2
+   
+   LightDir = Light2_position - Input.Position;
+   Dist = length(LightDir);
+   LightDir = LightDir / Dist;
+   
+   AngleAttn = saturate( dot(Input.Normal ,LightDir));
+   
+   HalfVect = normalize(LightDir - EyeVect);
+   
+   SpecAttn = Light2_color *Light2_spec_power * pow(clamp(dot(Input.Normal,HalfVect),0,1),32);
+   
+   DistAttn = clamp(1/ (Light2_attenuation.y +
+                        Light2_attenuation.z * Dist +
+                        Light2_attenuation.w * Dist * Dist)
+                        ,0,1);
+   
+   Output.Color += (Light2_color * AngleAttn + SpecAttn) * DistAttn * Light2_position.w;
+   
+   Output.Texcoord = Input.Texcoord;
+   Output.Texcoord1 = Input.Texcoord1;
+   Output.Texcoord2 = Input.Texcoord2;
+   
+   return( Output );
+   
+}
+
+
+

Modified: modules/common/materials/programs/Normalmapping/Basic_Normalmapping.material
===================================================================
--- modules/common/materials/programs/Normalmapping/Basic_Normalmapping.material	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/programs/Normalmapping/Basic_Normalmapping.material	2007-09-16 09:34:55 UTC (rev 3852)
@@ -1,4 +1,4 @@
-material Basic_Normalmapping
+material Basic_Normalmapping 
 {
 	lod_distances 12 100
 	
@@ -230,4 +230,122 @@
             }
         } 
     }
+}
+
+
+
+material Basic_Normalmapping_noDirectional
+{
+	lod_distances 12 100
+	
+    technique hlsl
+    {
+	    lod_index 0
+        pass
+        {
+            vertex_program_ref Basic_Normalmapping_UV0_noDirectional_VS_HLSL
+            {
+                param_named_auto matViewProjection worldviewproj_matrix
+                param_named_auto LightPosition_0 light_position_object_space 0
+                param_named_auto LightPosition_1 light_position_object_space 1
+                param_named_auto LightPosition_2 light_position_object_space 2
+                
+                param_named_auto LightAttn_0 light_attenuation 0
+                param_named_auto LightAttn_1 light_attenuation 1
+                param_named_auto LightAttn_2 light_attenuation 2
+                
+                param_named_auto vViewPosition	 camera_position_object_space
+            }
+
+            fragment_program_ref Basic_Normalmapping_PS_HLSL
+            {
+                param_named_auto LightColor_0  light_diffuse_colour  0
+                param_named_auto LightColor_1  light_diffuse_colour  1
+                param_named_auto LightColor_2  light_diffuse_colour  2
+                
+                param_named groundcolor float4 0.1 0.1 0.1 1.0
+                param_named skycolor float4 0.5 0.5 0.5 1.0
+                param_named SpecColor float4 0.2 0.2 0.2 1.0
+                param_named SpecExp float 16.0
+            }
+			
+            // Base diffuse texture map
+            texture_unit DiffuseMap
+            {
+                texture_alias DiffuseMap
+            }
+
+            // Normal map
+            texture_unit NormalMap
+            {
+                texture_alias NormalMap
+            }
+        }
+    }
+    
+    technique hlsl1
+	{
+		lod_index 1
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			alpha_rejection greater 128
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Basic_Pixel_Shader
+			{
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Basic_Vertex_Shader
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 0.3
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named skycolor float4 0.5 0.5 0.5 1.0
+				param_named groundcolor float4 0.10 0.10 0.10 1.0
+			}
+			
+			texture_unit
+			{
+				texture_alias DiffuseMap
+
+			}
+		}
+	}
+    
+
+    technique fixed_function
+    {
+	    lod_index 2
+        pass
+        {
+            ambient 0.6 0.6 0.6 1.0
+            diffuse 0.7 0.7 0.7 1.0
+            specular 0.3 0.3 0.3 1.0 16.0
+
+            // Base diffuse texture map
+            texture_unit DiffuseMap
+            {
+                texture_alias DiffuseMap
+            }
+        } 
+    }
 }
\ No newline at end of file

Modified: modules/common/materials/programs/Normalmapping/Basic_Normalmapping_Spec.material
===================================================================
--- modules/common/materials/programs/Normalmapping/Basic_Normalmapping_Spec.material	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/programs/Normalmapping/Basic_Normalmapping_Spec.material	2007-09-16 09:34:55 UTC (rev 3852)
@@ -364,4 +364,266 @@
             }
         } 
     }
+}
+
+
+material Basic_Normalmapping_Spec_Hair
+{
+	lod_distances 12 100
+	
+    technique hlsl
+    {
+	    lod_index 0
+        pass
+        {
+	        scene_blend alpha_blend 
+      		// Tiefenpuffer aus
+      		depth_write off
+      		//alpha_rejection greater 128
+      		
+      		cull_hardware anticlockwise 
+      		cull_software back
+      		
+            vertex_program_ref Basic_Normalmapping_UV0_VS_HLSL
+            {
+                param_named_auto matViewProjection worldviewproj_matrix
+                param_named_auto LightPosition_0 light_position_object_space 0
+                param_named_auto LightPosition_1 light_position_object_space 1
+                param_named_auto LightPosition_2 light_position_object_space 2
+                
+                param_named_auto LightAttn_0 light_attenuation 0
+                param_named_auto LightAttn_1 light_attenuation 1
+                param_named_auto LightAttn_2 light_attenuation 2
+                
+                param_named_auto vViewPosition	 camera_position_object_space
+            }
+
+            fragment_program_ref Basic_Normalmapping_Spec_PS_HLSL
+            {
+                param_named_auto LightColor_0  light_diffuse_colour  0
+                param_named_auto LightColor_1  light_diffuse_colour  1
+                param_named_auto LightColor_2  light_diffuse_colour  2
+                
+                param_named groundcolor float4 0.1 0.1 0.1 1.0
+                param_named skycolor float4 0.5 0.5 0.5 1.0
+                param_named SpecExp float 16.0
+            }
+			
+            // Base diffuse texture map
+            texture_unit DiffuseMap
+            {
+                texture_alias DiffuseMap
+            }
+
+            // Normal map
+            texture_unit NormalMap
+            {
+                texture_alias NormalMap
+            }
+            
+            texture_unit SpecMap
+            {
+                texture_alias SpecMap
+            }
+        }
+        
+        
+        pass
+        {
+	        scene_blend alpha_blend 
+      		// Tiefenpuffer aus
+      		depth_write off
+      		//alpha_rejection greater 20
+      		
+      		cull_hardware clockwise 
+      		cull_software front 
+      		
+            vertex_program_ref Basic_Normalmapping_UV0_VS_HLSL
+            {
+                param_named_auto matViewProjection worldviewproj_matrix
+                param_named_auto LightPosition_0 light_position_object_space 0
+                param_named_auto LightPosition_1 light_position_object_space 1
+                param_named_auto LightPosition_2 light_position_object_space 2
+                
+                param_named_auto LightAttn_0 light_attenuation 0
+                param_named_auto LightAttn_1 light_attenuation 1
+                param_named_auto LightAttn_2 light_attenuation 2
+                
+                param_named_auto vViewPosition	 camera_position_object_space
+            }
+
+            fragment_program_ref Basic_Normalmapping_Spec_PS_HLSL
+            {
+                param_named_auto LightColor_0  light_diffuse_colour  0
+                param_named_auto LightColor_1  light_diffuse_colour  1
+                param_named_auto LightColor_2  light_diffuse_colour  2
+                
+                param_named groundcolor float4 0.1 0.1 0.1 1.0
+                param_named skycolor float4 0.5 0.5 0.5 1.0
+                param_named SpecExp float 16.0
+            }
+			
+            // Base diffuse texture map
+            texture_unit DiffuseMap
+            {
+                texture_alias DiffuseMap
+            }
+
+            // Normal map
+            texture_unit NormalMap
+            {
+                texture_alias NormalMap
+            }
+            
+            texture_unit SpecMap
+            {
+                texture_alias SpecMap
+            }
+        }
+    }
+    
+    technique hlsl1
+	{
+		//Rendering Pass: Pass 0 (pass index: #0 )
+		pass
+		{
+			scene_blend alpha_blend 
+      		// Tiefenpuffer aus
+      		//depth_write off
+      		alpha_rejection greater 128
+      		
+      		cull_hardware anticlockwise 
+      		cull_software back 
+      		
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Hair_Pixel_Shader
+			{
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Hair_Vertex_Shader
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 1.0
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named groundcolor float4 0.1 0.1 0.1 1.0
+                param_named skycolor float4 0.5 0.5 0.5 1.0
+            }
+			
+            // Base diffuse texture map
+            texture_unit DiffuseMap
+            {
+                texture_alias DiffuseMap
+            }
+
+            // Normal map
+            texture_unit NormalMap
+            {
+                texture_alias NormalMap
+            }
+            
+            texture_unit SpecMap
+            {
+                texture_alias SpecMap
+            }
+		}
+		
+		pass
+		{
+			scene_blend alpha_blend 
+      		// Tiefenpuffer aus
+      		//depth_write off
+      		alpha_rejection greater 20
+      		
+      		cull_hardware clockwise 
+      		cull_software front 
+      		
+			//DirectX 9.0 HLSL Pixel Shader ps_2_0
+			fragment_program_ref Hair_Pixel_Shader
+			{
+			}
+			//DirectX 9.0 HLSL Vertex Shader vs_2_0
+			vertex_program_ref Hair_Vertex_Shader
+			{
+				// param_named_auto
+
+				param_named_auto Light1_attenuation light_attenuation 0
+				param_named_auto Light1_color light_diffuse_colour 0
+				param_named_auto Light1_position light_position_object_space 0
+				param_named Light1_spec_power float 0.3
+				
+				param_named_auto Light2_attenuation light_attenuation 1
+				param_named_auto Light2_color light_diffuse_colour 1
+				param_named_auto Light2_position light_position_object_space 1
+				param_named Light2_spec_power float 0.3
+				
+				param_named_auto Light3_attenuation light_attenuation 2
+				param_named_auto Light3_color light_diffuse_colour 2
+				param_named_auto Light3_position light_position_object_space 2
+				param_named Light3_spec_power float 1.0
+				
+				
+				param_named_auto matViewProjection worldviewproj_matrix
+				param_named_auto vViewPosition camera_position_object_space
+				
+				
+				param_named groundcolor float4 0.1 0.1 0.1 1.0
+                param_named skycolor float4 0.5 0.5 0.5 1.0
+            }
+			
+            // Base diffuse texture map
+            texture_unit DiffuseMap
+            {
+                texture_alias DiffuseMap
+            }
+
+            // Normal map
+            texture_unit NormalMap
+            {
+                texture_alias NormalMap
+            }
+            
+            texture_unit SpecMap
+            {
+                texture_alias SpecMap
+            }
+		}
+		
+		
+	}
+
+    technique fixed_function
+    {
+	    lod_index 1
+        pass
+        {
+            ambient 0.6 0.6 0.6 1.0
+            diffuse 0.7 0.7 0.7 1.0
+            specular 0.3 0.3 0.3 1.0 16.0
+
+            // Base diffuse texture map
+            texture_unit DiffuseMap
+            {
+                texture_alias DiffuseMap
+            }
+        } 
+    }
 }
\ No newline at end of file

Added: modules/common/materials/programs/Normalmapping/Basic_Normalmapping_UV0_noDirectional_VS.hlsl
===================================================================
--- modules/common/materials/programs/Normalmapping/Basic_Normalmapping_UV0_noDirectional_VS.hlsl	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/programs/Normalmapping/Basic_Normalmapping_UV0_noDirectional_VS.hlsl	2007-09-16 09:34:55 UTC (rev 3852)
@@ -0,0 +1,98 @@
+float4x4 matViewProjection;
+float4 LightPosition_0;
+float4 LightPosition_1;
+float4 LightPosition_2;
+float4 vViewPosition;
+float4 LightAttn_0;
+float4 LightAttn_1;
+float4 LightAttn_2;
+
+struct VS_OUTPUT 
+{
+   float4 Position   : POSITION0;
+   float2 UV         : TEXCOORD0;
+   float4 LightDir_0 : TEXCOORD1;
+   float3 HalfVect_0 : TEXCOORD2;
+   float4 LightDir_1 : TEXCOORD3;
+   float3 HalfVect_1 : TEXCOORD4;
+   float4 LightDir_2 : TEXCOORD5;
+   float3 HalfVect_2 : TEXCOORD6;
+   float3 SkyDir     : TEXCOORD7;
+   
+};
+
+VS_OUTPUT vs_main(      float4 inPosition : POSITION0,
+                        float3 inNormal : NORMAL0,
+                        float3 inTangent : TANGENT0,
+                        float2 inUV:   TEXCOORD )
+{
+   VS_OUTPUT Output;
+
+   Output.Position = mul( matViewProjection, inPosition );
+   Output.UV = inUV;
+   
+   float3x3 TangentSpace;
+   
+   TangentSpace[0] = inTangent;   
+   TangentSpace[1] = cross(inTangent,inNormal);   
+   TangentSpace[2] = inNormal;
+   
+   float3 EyeVector = normalize(vViewPosition - inPosition);
+   
+   //################# Light 0  ################
+   float4 LightDir;
+   LightDir.xyz = LightPosition_0 - inPosition;
+   float Dist = length(LightDir.xyz);
+   LightDir.xyz = LightDir.xyz /Dist;
+   
+   if (LightPosition_0.w != 0.0)
+   LightDir.w = saturate(1/(LightAttn_0.y +
+                            LightAttn_0.z * Dist +
+                            LightAttn_0.w * Dist * Dist));
+                            
+   
+   
+   Output.HalfVect_0 = mul(TangentSpace, normalize(LightDir.xyz + EyeVector));
+   Output.LightDir_0 = float4(mul(TangentSpace,LightDir.xyz),LightDir.w);
+   
+   //################# Light 1  ################
+   LightDir;
+   LightDir.xyz = LightPosition_1 - inPosition;
+   Dist = length(LightDir.xyz);
+   LightDir.xyz = LightDir.xyz /Dist;
+   
+   if (LightPosition_1.w != 0.0)
+   LightDir.w = saturate(1/(LightAttn_1.y +
+                            LightAttn_1.z * Dist +
+                            LightAttn_1.w * Dist * Dist));
+                            
+   
+   Output.HalfVect_1 = mul(TangentSpace, normalize(LightDir.xyz + EyeVector));
+   Output.LightDir_1 = float4(mul(TangentSpace,LightDir.xyz),LightDir.w);
+   
+   //################# Light 2  ################
+   LightDir;
+   LightDir.xyz = LightPosition_2 - inPosition;
+   Dist = length(LightDir.xyz);
+   LightDir.xyz = LightDir.xyz /Dist;
+   
+   if (LightPosition_2.w != 0.0)
+   LightDir.w = saturate(1/(LightAttn_2.y +
+                            LightAttn_2.z * Dist +
+                            LightAttn_2.w * Dist * Dist));
+                            
+   
+   Output.HalfVect_2 = mul(TangentSpace, normalize(LightDir.xyz + EyeVector));
+   Output.LightDir_2 = float4(mul(TangentSpace,LightDir.xyz),LightDir.w);
+   
+   
+   // SkyLight
+   Output.SkyDir    = mul(TangentSpace, float3(0,-1,0));
+   
+   
+   return( Output );
+   
+}
+
+
+

Modified: modules/common/materials/programs/Normalmapping/Normalmapping.program
===================================================================
--- modules/common/materials/programs/Normalmapping/Normalmapping.program	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/programs/Normalmapping/Normalmapping.program	2007-09-16 09:34:55 UTC (rev 3852)
@@ -5,6 +5,13 @@
     target vs_1_1
 }
 
+vertex_program Basic_Normalmapping_UV0_noDirectional_VS_HLSL hlsl
+{
+    source Basic_Normalmapping_UV0_noDirectional_VS.hlsl
+    entry_point vs_main
+    target vs_1_1
+}
+
 vertex_program Basic_Normalmapping_UV1_VS_HLSL hlsl
 {
     source Basic_Normalmapping_UV1_VS.hlsl

Modified: modules/common/materials/programs/Normalmapping/Skin_Normalmapping.material
===================================================================
--- modules/common/materials/programs/Normalmapping/Skin_Normalmapping.material	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/common/materials/programs/Normalmapping/Skin_Normalmapping.material	2007-09-16 09:34:55 UTC (rev 3852)
@@ -162,7 +162,7 @@
                 param_named_auto LightAttn_1 light_attenuation 1
                 param_named_auto LightAttn_2 light_attenuation 2
                 
-                param_named eyeDirection float3 0.0 1 0.0
+                param_named eyeDirection float3 0.25 1 0.0
                 
                 param_named_auto vViewPosition	 camera_position_object_space
             }

Modified: modules/common/models/men_human_female_cloth_long.mesh
===================================================================
(Binary files differ)

Modified: modules/common/models/men_human_female_cloth_short.mesh
===================================================================
(Binary files differ)

Modified: modules/common/models/men_human_female_leg_pants_01_long.mesh
===================================================================
(Binary files differ)

Modified: modules/common/models/men_human_female_torso.mesh
===================================================================
(Binary files differ)

Deleted: modules/ruchin/dsa/mckherotest.gof
===================================================================
--- modules/ruchin/dsa/mckherotest.gof	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/ruchin/dsa/mckherotest.gof	2007-09-16 09:34:55 UTC (rev 3852)
@@ -1,20 +0,0 @@
-&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;
-&lt;GameObjectDefinitions&gt;
-
-    &lt;gameobjectclass classid=&quot;mckhero&quot;  baseclass=&quot;MCKHero&quot;&gt;
-        &lt;property name=&quot;geometrytype&quot; type=&quot;STRING&quot; data=&quot;ellipsoid&quot; /&gt;
-        &lt;property name=&quot;mass&quot; type=&quot;REAL&quot; data=&quot;75&quot;/&gt;
-        &lt;property name=&quot;inventorywindowtype&quot; type=&quot;STRING&quot; data=&quot;inventory_human.xml&quot;/&gt;
-        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;men_human_female_torso.mesh&quot;/&gt;
-        &lt;property name=&quot;geometrytype&quot; type=&quot;STRING&quot; data=&quot;ellipsoid&quot;/&gt;
-        &lt;property name=&quot;meshparts&quot; type=&quot;MAP&quot;&gt;
-            &lt;property name=&quot;torso&quot; type=&quot;STRING&quot; data=&quot;men_human_female_torso.mesh&quot;/&gt;
-            &lt;property name=&quot;hand&quot; type=&quot;STRING&quot; data=&quot;men_human_female_hand_nude.mesh&quot;/&gt;
-            &lt;property name=&quot;head&quot; type=&quot;STRING&quot; data=&quot;men_human_female_head_02.mesh&quot;/&gt;
-            &lt;property name=&quot;hair&quot; type=&quot;STRING&quot; data=&quot;men_human_female_hair_long_01_normal.mesh&quot;/&gt;
-            &lt;property name=&quot;leg&quot; type=&quot;STRING&quot; data=&quot;men_human_female_leg_pants_01_long.mesh&quot;/&gt;
-            &lt;property name=&quot;feet&quot; type=&quot;STRING&quot; data=&quot;men_human_female_feet_boots_01.mesh&quot;/&gt;
-        &lt;/property&gt;
-    &lt;/gameobjectclass&gt;
-    
-&lt;/GameObjectDefinitions&gt;
\ No newline at end of file

Modified: modules/ruchin/maps/ruchin_lightzones.rlmap.xml
===================================================================
--- modules/ruchin/maps/ruchin_lightzones.rlmap.xml	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/ruchin/maps/ruchin_lightzones.rlmap.xml	2007-09-16 09:34:55 UTC (rev 3852)
@@ -1,6 +1,22 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;
 &lt;rastullahmap formatVersion=&quot;0.4.0&quot;&gt;
 	&lt;nodes&gt;
+		&lt;entity name=&quot;Ruchin_Hessi_innen&quot; meshfile=&quot;Ruchin_Hessi_innen.mesh&quot; visible=&quot;true&quot; receivesShadow=&quot;true&quot;&gt;
+			&lt;position x=&quot;130.0&quot; y=&quot;0.0&quot; z=&quot;-50.0&quot; /&gt;
+			&lt;rotation qx=&quot;0.0&quot; qy=&quot;0.0&quot; qz=&quot;0.0&quot; qw=&quot;1.0&quot; /&gt;
+			&lt;scale x=&quot;1.0&quot; y=&quot;1.0&quot; z=&quot;1.0&quot; /&gt;
+			&lt;staticgeometrygroup id=&quot;0&quot;/&gt;
+			&lt;renderingdistance data=&quot;100&quot; /&gt; 
+		&lt;/entity&gt;
+		
+		&lt;entity name=&quot;Ruchin_g&quot; meshfile=&quot;Ruchin_g.mesh&quot; visible=&quot;true&quot; receivesShadow=&quot;true&quot;&gt;
+			&lt;position x=&quot;120.0&quot; y=&quot;0.0&quot; z=&quot;-50.0&quot; /&gt;
+			&lt;rotation qx=&quot;0.0&quot; qy=&quot;0.0&quot; qz=&quot;0.0&quot; qw=&quot;1.0&quot; /&gt;
+			&lt;scale x=&quot;1.0&quot; y=&quot;1.0&quot; z=&quot;1.0&quot; /&gt;
+			&lt;staticgeometrygroup id=&quot;0&quot;/&gt;
+			&lt;renderingdistance data=&quot;100&quot; /&gt; 
+		&lt;/entity&gt;
+	
 		&lt;entity name=&quot;Ruchin_l_innen&quot; meshfile=&quot;Ruchin_l_innen.mesh&quot; visible=&quot;true&quot; receivesShadow=&quot;true&quot;&gt;
 			&lt;position x=&quot;65.2876&quot; y=&quot;6.02141&quot; z=&quot;-66.9458&quot; /&gt;
 			&lt;rotation qx=&quot;0.0&quot; qy=&quot;0.0&quot; qz=&quot;0.0&quot; qw=&quot;1.0&quot; /&gt;
@@ -144,14 +160,14 @@
 			&lt;position x=&quot;112.486&quot; y=&quot;1.53497&quot; z=&quot;-17.18&quot; /&gt;
 			&lt;rotation qx=&quot;0.0&quot; qy=&quot;-0.707107&quot; qz=&quot;0.0&quot; qw=&quot;0.707107&quot; /&gt;
 			&lt;scale x=&quot;1.0&quot; y=&quot;1.0&quot; z=&quot;1.0&quot; /&gt;
-			&lt;staticgeometrygroup id=&quot;39&quot;/&gt;
+			&lt;staticgeometrygroup id=&quot;3&quot;/&gt;
 			&lt;renderingdistance data=&quot;100&quot; /&gt;
 		&lt;/entity&gt;
 		&lt;entity name=&quot;Statue_02&quot; meshfile =&quot;Statue_02.mesh&quot; visible=&quot;true&quot; receivesShadow=&quot;true&quot;&gt;
 			&lt;position x=&quot;112.486&quot; y=&quot;1.53497&quot; z=&quot;-24.0179&quot; /&gt;
 			&lt;rotation qx=&quot;0.0&quot; qy=&quot;-0.707107&quot; qz=&quot;0.0&quot; qw=&quot;0.707107&quot; /&gt;
 			&lt;scale x=&quot;1.0&quot; y=&quot;1.0&quot; z=&quot;1.0&quot; /&gt;
-			&lt;staticgeometrygroup id=&quot;40&quot;/&gt;
+			&lt;staticgeometrygroup id=&quot;3&quot;/&gt;
 			&lt;renderingdistance data=&quot;100&quot; /&gt;
 		&lt;/entity&gt;
 		
@@ -264,13 +280,17 @@
 		
 		&lt;light name=&quot;sun&quot; type=&quot;directional&quot; visible=&quot;true&quot; castShadows=&quot;true&quot;&gt;
 			&lt;colourDiffuse r=&quot;0.8&quot; g=&quot;0.8&quot; b=&quot;0.8&quot; /&gt;
-			&lt;colourSpecular r=&quot;0&quot; g=&quot;0&quot; b=&quot;1&quot; /&gt;
+			&lt;colourDiffuse r=&quot;0.8&quot; g=&quot;0.8&quot; b=&quot;0.8&quot; /&gt;
 			&lt;direction x=&quot;-0.17101&quot; y=&quot;-0.873647&quot; z=&quot;0.969846&quot; /&gt;
 		&lt;/light&gt;
 	&lt;/nodes&gt;
 	&lt;zones&gt;
 		&lt;zone name=&quot;default&quot;&gt;
 			&lt;light name=&quot;sun&quot;/&gt;
+			&lt;light name=&quot;Ruchin_l_Light2&quot;/&gt;
+			&lt;light name=&quot;Ruchin_l_Light1&quot;/&gt;
+			&lt;light name=&quot;templeLight1&quot;/&gt;
+			&lt;light name=&quot;templeLight2&quot;/&gt;
 		&lt;/zone&gt;
 		&lt;zone name=&quot;temple_zone&quot;&gt;
 			&lt;area type=&quot;mesh&quot; meshfile=&quot;temple_lightzone.mesh&quot;&gt;

Modified: modules/ruchin/models/House_dummies.mesh
===================================================================
(Binary files differ)

Added: modules/ruchin/models/Ruchin_Hessi_innen.mesh
===================================================================
(Binary files differ)


Property changes on: modules/ruchin/models/Ruchin_Hessi_innen.mesh
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/ruchin/models/Ruchin_g.mesh
===================================================================
(Binary files differ)


Property changes on: modules/ruchin/models/Ruchin_g.mesh
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: modules/ruchin/models/Ruchin_inside.material
===================================================================
--- modules/ruchin/models/Ruchin_inside.material	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/ruchin/models/Ruchin_inside.material	2007-09-16 09:34:55 UTC (rev 3852)
@@ -1,5 +1,5 @@
 
-material Ruchin_inside/base : Basic_Vertex_Shader
+material Ruchin_inside/base : Basic_Vertex_Shader_noDirectional
 {
 set_texture_alias diffuse ruchin_atlasmap.png
 

Modified: modules/ruchin/models/Ruchin_l.mesh
===================================================================
(Binary files differ)

Modified: modules/ruchin/models/Ruchin_map.mesh
===================================================================
(Binary files differ)

Modified: modules/ruchin/models/Ruchin_n.mesh
===================================================================
(Binary files differ)

Modified: modules/ruchin/models/Ruchin_s.mesh
===================================================================
(Binary files differ)

Modified: modules/ruchin/models/Ruchintest.material
===================================================================
--- modules/ruchin/models/Ruchintest.material	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/ruchin/models/Ruchintest.material	2007-09-16 09:34:55 UTC (rev 3852)
@@ -127,13 +127,6 @@
 
 }
 
-material base : Basic_Vertex_Shader
-{
-set_texture_alias diffuse ruchin_atlasmap.png
-
-}
-
-
 material Ruchin/Schiefer : Basic_Vertex_Shader
 {
 set_texture_alias diffuse arc_schieferdach.png
@@ -144,4 +137,4 @@
 {
 set_texture_alias diffuse ruchin_atlasmap.dds
 
-}
\ No newline at end of file
+}

Modified: modules/ruchin/models/Stadtmauer.mesh
===================================================================
(Binary files differ)

Added: modules/ruchin/scripts/equip.rb
===================================================================
--- modules/ruchin/scripts/equip.rb	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/ruchin/scripts/equip.rb	2007-09-16 09:34:55 UTC (rev 3852)
@@ -0,0 +1,23 @@
+require 'npc.rb'
+	
+	$SCRIPT.log(&quot;aktiven hero geten&quot;);
+	hero = $UI.getActiveCharacter();
+	
+	$SCRIPT.log(&quot;backpack erstellen&quot;);
+    #backpack = $GOM.createGameObject(&quot;leather backpack&quot;);
+    #backpack.addAction(ShowContainerContentAction.new());
+    #backpack.setPosition(center);
+    #backpack.placeIntoScene();
+    
+    #$SCRIPT.log(&quot;inventar f&#252;llen!!!&quot;);
+    #hero.getInventory().hold(backpack, &quot;Back&quot;);
+    
+    itemToAdd = $GOM.createGameObject(&quot;men_human_female_leg_pants_01_long&quot;);
+    hero.getInventory().hold(itemToAdd, &quot;Trousers&quot;);
+    #hero.getInventory().getItem(&quot;Back&quot;).addItem(itemToAdd);
+    itemToAdd = $GOM.createGameObject(&quot;men_human_female_cloth_short&quot;);
+    hero.getInventory().hold(itemToAdd, &quot;Clothes&quot;);
+    #hero.getInventory().getItem(&quot;Back&quot;).addItem(itemToAdd);
+    itemToAdd = $GOM.createGameObject(&quot;men_human_female_feet_boots_01&quot;);
+    hero.getInventory().hold(itemToAdd, &quot;Boots&quot;);
+   # hero.getInventory().getItem(&quot;Back&quot;).addItem(itemToAdd);
\ No newline at end of file

Modified: modules/ruchin/scripts/maps/maptest.rb
===================================================================
--- modules/ruchin/scripts/maps/maptest.rb	2007-09-12 19:44:01 UTC (rev 3851)
+++ modules/ruchin/scripts/maps/maptest.rb	2007-09-16 09:34:55 UTC (rev 3852)
@@ -81,3 +81,4 @@
 ##########################
 
 load &quot;particle.rb&quot;
+load &quot;equip.rb&quot;
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000922.html">[Dsa-hl-svn] r3851 - rl/trunk/engine/rules/include
</A></li>
	<LI>Next message: <A HREF="000924.html">[Dsa-hl-svn] r3853 - in modules: aitest/models common/models
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#923">[ date ]</a>
              <a href="thread.html#923">[ thread ]</a>
              <a href="subject.html#923">[ subject ]</a>
              <a href="author.html#923">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
