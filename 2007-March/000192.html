<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r3121 - in modules: . aitest aitest/dsa aitest/gui	aitest/gui/windows aitest/maps aitest/materials	aitest/materials/textures aitest/scripts aitest/scripts/maps	common/scripts
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2007-March/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r3121%20-%20in%20modules%3A%20.%20aitest%20aitest/dsa%20aitest/gui%0A%09aitest/gui/windows%20aitest/maps%20aitest/materials%0A%09aitest/materials/textures%20aitest/scripts%20aitest/scripts/maps%0A%09common/scripts&In-Reply-To=%3C200703052008.l25K8t4q010640%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000191.html">
   <LINK REL="Next"  HREF="000193.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r3121 - in modules: . aitest aitest/dsa aitest/gui	aitest/gui/windows aitest/maps aitest/materials	aitest/materials/textures aitest/scripts aitest/scripts/maps	common/scripts</H1>
    <B>natoka at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r3121%20-%20in%20modules%3A%20.%20aitest%20aitest/dsa%20aitest/gui%0A%09aitest/gui/windows%20aitest/maps%20aitest/materials%0A%09aitest/materials/textures%20aitest/scripts%20aitest/scripts/maps%0A%09common/scripts&In-Reply-To=%3C200703052008.l25K8t4q010640%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r3121 - in modules: . aitest aitest/dsa aitest/gui	aitest/gui/windows aitest/maps aitest/materials	aitest/materials/textures aitest/scripts aitest/scripts/maps	common/scripts">natoka at mail.berlios.de
       </A><BR>
    <I>Mon Mar  5 21:08:55 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000191.html">[Dsa-hl-svn] r3120 - in rl/trunk/engine: ai/src common/src	dialog/src dialog/src/predicates
</A></li>
        <LI>Next message: <A HREF="000193.html">[Dsa-hl-svn] r3122 - in modules/aitest: maps scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#192">[ date ]</a>
              <a href="thread.html#192">[ thread ]</a>
              <a href="subject.html#192">[ subject ]</a>
              <a href="author.html#192">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: natoka
Date: 2007-03-05 21:08:20 +0100 (Mon, 05 Mar 2007)
New Revision: 3121

Added:
   modules/aitest/
   modules/aitest/dialogs/
   modules/aitest/dsa/
   modules/aitest/dsa/gameobjectdefinitions.gof
   modules/aitest/gui/
   modules/aitest/gui/fonts/
   modules/aitest/gui/imagesets/
   modules/aitest/gui/schemes/
   modules/aitest/gui/windows/
   modules/aitest/gui/windows/buttons/
   modules/aitest/maps/
   modules/aitest/maps/aitest.scene
   modules/aitest/maps/aitest_floorplane.mesh
   modules/aitest/materials/
   modules/aitest/materials/nx.grid.material
   modules/aitest/materials/textures/
   modules/aitest/materials/textures/nx.grid.axis.png
   modules/aitest/materials/textures/nx.grid.floor.png
   modules/aitest/materials/textures/nx.static.wall.png
   modules/aitest/materials/textures/nx.trafficcone.png
   modules/aitest/materials/textures/nx.zone.blue.png
   modules/aitest/materials/textures/nx.zone.green.png
   modules/aitest/materials/textures/nx.zone.nogravity.png
   modules/aitest/materials/textures/nx.zone.orange.png
   modules/aitest/materials/textures/nx.zone.pink.png
   modules/aitest/models/
   modules/aitest/scripts/
   modules/aitest/scripts/DebugKeys.rb
   modules/aitest/scripts/NpcCapsuleTest.rb
   modules/aitest/scripts/NpcTest.rb
   modules/aitest/scripts/WallSet1.rb
   modules/aitest/scripts/WallSet2.rb
   modules/aitest/scripts/WayPointTest.rb
   modules/aitest/scripts/WayPointTest2.rb
   modules/aitest/scripts/doortest.rb
   modules/aitest/scripts/maps/
   modules/aitest/scripts/maps/aitest.rb
   modules/aitest/scripts/maps/aitest2.rb
   modules/aitest/scripts/maps/aitestold.rb
   modules/aitest/scripts/moduleconfig.rb
   modules/aitest/scripts/testcase.rb
   modules/aitest/sound/
Modified:
   modules/common/scripts/globals.rb
   modules/modules.cfg
Log:
enable Waypoints in scripts (in common)
added aitest module for ai testing


Added: modules/aitest/dsa/gameobjectdefinitions.gof
===================================================================
--- modules/aitest/dsa/gameobjectdefinitions.gof	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/dsa/gameobjectdefinitions.gof	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,88 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;
+&lt;GameObjectDefinitions&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;Holzscheit&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;GameObject&quot; /&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Greater log of time check. (Very rare)&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;ver_holzscheit_01.mesh&quot;/&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;apple&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;GameObject&quot; /&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Ein Apfel?&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;sphere.1m.mesh&quot;/&gt;
+        &lt;property name=&quot;geometrytype&quot; type=&quot;STRING&quot; data=&quot;ellipsoid&quot;/&gt;
+        &lt;property name=&quot;mass&quot; type=&quot;REAL&quot; data=&quot;65&quot;/&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;TestPerson&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;NPC&quot;/&gt;
+        &lt;property name=&quot;name&quot; type=&quot;STRING&quot; data=&quot;TestPerson&quot;/&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Wenn man mal jemanden zum Reden braucht...&quot;/&gt;
+        &lt;property name=&quot;geometrytype&quot; type=&quot;STRING&quot; data=&quot;ellipsoid&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;men_alrike.mesh&quot;/&gt;
+        &lt;property name=&quot;mass&quot; type=&quot;REAL&quot; data=&quot;65&quot;/&gt;
+        &lt;property name=&quot;dialogfile&quot; type=&quot;STRING&quot; data=&quot;testperson.xml&quot;/&gt;
+        &lt;property name=&quot;behaviours&quot; type=&quot;ARRAY&quot;&gt;
+            &lt;property type=&quot;STRING&quot; data=&quot;default_idle_behaviour&quot;/&gt;
+            &lt;property type=&quot;STRING&quot; data=&quot;dialog_behaviour&quot;/&gt;
+        &lt;/property&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;TestPersonCapsule&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;NPC&quot;/&gt;
+        &lt;property name=&quot;name&quot; type=&quot;STRING&quot; data=&quot;TestPerson&quot;/&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Wenn man mal jemanden zum Reden braucht...&quot;/&gt;
+        &lt;property name=&quot;geometrytype&quot; type=&quot;STRING&quot; data=&quot;capsule&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;men_alrike.mesh&quot;/&gt;
+        &lt;property name=&quot;mass&quot; type=&quot;REAL&quot; data=&quot;65&quot;/&gt;
+        &lt;property name=&quot;dialogfile&quot; type=&quot;STRING&quot; data=&quot;testperson.xml&quot;/&gt;
+        &lt;property name=&quot;behaviours&quot; type=&quot;ARRAY&quot;&gt;
+            &lt;property type=&quot;STRING&quot; data=&quot;default_idle_behaviour&quot;/&gt;
+            &lt;property type=&quot;STRING&quot; data=&quot;dialog_behaviour&quot;/&gt;
+        &lt;/property&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;switch3way&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;Switch3Way&quot;/&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Ein Hebel&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;arc_hebel_01.mesh&quot;/&gt;
+        &lt;property name=&quot;geometrytype&quot; type=&quot;STRING&quot; data=&quot;sphere&quot;/&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;shortsword&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;Weapon&quot; /&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Ein ordin&#228;res Kurzschwert - scharf, aber langweilig&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;waf_kurzschwert_01.mesh&quot;/&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;leather backpack&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;Container&quot;/&gt; 
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Ein Lederrucksack (oder so)&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;ins_rucksack.mesh&quot;/&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;ErrorHandling&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;GameObject&quot; /&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;The ErrorHandling TestCase&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;arc_hebel_01.mesh&quot;/&gt;
+    &lt;/gameobjectclass&gt;
+
+    &lt;!-- JobSequenceTest --&gt;
+    &lt;gameobjectclass&gt;
+        &lt;property name=&quot;classid&quot; type=&quot;STRING&quot; data=&quot;JobSequenceTestChest&quot;/&gt;
+        &lt;property name=&quot;baseclass&quot; type=&quot;STRING&quot; data=&quot;GameObject&quot; /&gt;
+        &lt;property name=&quot;description&quot; type=&quot;STRING&quot; data=&quot;Eine Truhe zum Test der JobSequence&quot;/&gt;
+        &lt;property name=&quot;meshfile&quot; type=&quot;STRING&quot; data=&quot;ver_truhe_gross01.mesh&quot;/&gt;
+        &lt;property name=&quot;geometrytype&quot; type=&quot;STRING&quot; data=&quot;box&quot;/&gt;
+    &lt;/gameobjectclass&gt;
+
+&lt;/GameObjectDefinitions&gt;

Added: modules/aitest/maps/aitest.scene
===================================================================
--- modules/aitest/maps/aitest.scene	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/maps/aitest.scene	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,14 @@
+&lt;scene formatVersion=&quot;0.2.0&quot;&gt;
+    &lt;nodes&gt;
+        &lt;node&gt;
+            &lt;position x=&quot;0.0&quot; y=&quot;0.0&quot; z=&quot;0.0&quot; /&gt;
+            &lt;scale x=&quot;1.0&quot; y=&quot;1.0&quot; z=&quot;1.0&quot; /&gt;
+            &lt;entity meshFile=&quot;aitest_floorplane.mesh&quot;/&gt;
+        &lt;/node&gt;
+        &lt;node&gt;
+            &lt;position x=&quot;10.0&quot; y=&quot;0.0&quot; z=&quot;0.0&quot; /&gt;
+            &lt;scale x=&quot;1.0&quot; y=&quot;1.0&quot; z=&quot;1.0&quot; /&gt;
+            &lt;entity meshFile=&quot;held.mesh&quot;/&gt;
+        &lt;/node&gt;
+    &lt;/nodes&gt;
+&lt;/scene&gt;

Added: modules/aitest/maps/aitest_floorplane.mesh
===================================================================
(Binary files differ)


Property changes on: modules/aitest/maps/aitest_floorplane.mesh
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/nx.grid.material
===================================================================
--- modules/aitest/materials/nx.grid.material	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/materials/nx.grid.material	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,34 @@
+material nx.grid
+{
+    technique
+    {
+        pass
+        {
+            lighting off
+            
+            texture_unit
+            {
+                max_anisotropy 8
+                filtering anisotropic
+                texture nx.grid.floor.png
+            }
+        }
+    }
+}
+
+material nx.axis
+{
+    technique
+    {
+        pass
+        {
+            lighting off
+            scene_blend alpha_blend
+            
+            texture_unit
+            {
+                texture nx.grid.axis.png
+            }
+        }
+    }
+}

Added: modules/aitest/materials/textures/nx.grid.axis.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.grid.axis.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.grid.floor.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.grid.floor.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.static.wall.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.static.wall.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.trafficcone.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.trafficcone.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.zone.blue.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.zone.blue.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.zone.green.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.zone.green.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.zone.nogravity.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.zone.nogravity.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.zone.orange.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.zone.orange.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/materials/textures/nx.zone.pink.png
===================================================================
(Binary files differ)


Property changes on: modules/aitest/materials/textures/nx.zone.pink.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: modules/aitest/scripts/DebugKeys.rb
===================================================================
--- modules/aitest/scripts/DebugKeys.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/DebugKeys.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,15 @@
+class DebugKeys
+    def initialize()
+        @isWPShown = false
+    end
+
+    def toggleWP()
+      if @isWPShown:
+	$DVM.hide(8)
+      else
+	$DVM.show(8)
+      end
+      @isWPShown = (@isWPShown == false)
+    end
+end
+

Added: modules/aitest/scripts/NpcCapsuleTest.rb
===================================================================
--- modules/aitest/scripts/NpcCapsuleTest.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/NpcCapsuleTest.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,21 @@
+require 'testcase.rb'
+require 'npc.rb'
+
+class NpcCapsuleTest &lt; TestCase
+    def initialize(center)
+        super(center)
+
+        height = 0.05
+        #min_base = [-2.0, 0.05, -2.0]
+        #max_base = [2.0, height, 2.0]
+        #base = $AM.createBoxPrimitiveActor(&quot;capsuleTestBase&quot;,
+        #                                   min_base, max_base, &quot;alpha_red&quot;)
+        #base.placeIntoScene(center);
+
+        npc1proxy = $GOM.createGameObjectProxy(&quot;TestPersonCapsule&quot;);
+        npc1 = npc1proxy.getGameObject();
+        npc1.setPosition(rel_pos([0.0, height, 0.0]));
+
+        npc1.placeIntoScene();
+    end
+end

Added: modules/aitest/scripts/NpcTest.rb
===================================================================
--- modules/aitest/scripts/NpcTest.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/NpcTest.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,21 @@
+require 'testcase.rb'
+require 'npc.rb'
+
+class NpcTest &lt; TestCase
+    def initialize(center)
+        super(center)
+
+        height = 0.3
+        min_base = [-3.0, 0.05, -3.0]
+        max_base = [3.0, height, 3.0]
+        base = $AM.createBoxPrimitiveActor(&quot;DialogTestBase&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+        base.placeIntoScene(center);
+
+        npc1proxy = $GOM.createGameObjectProxy(&quot;TestPerson&quot;);
+        npc1 = npc1proxy.getGameObject();
+        npc1.setPosition(rel_pos([0.0, height, 0.0]));
+
+        npc1.placeIntoScene();
+    end
+end

Added: modules/aitest/scripts/WallSet1.rb
===================================================================
--- modules/aitest/scripts/WallSet1.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/WallSet1.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,53 @@
+require 'testcase.rb'
+
+class WallSet1 &lt; TestCase
+    def initialize(center)
+        super(center)
+
+        height = 1.0
+        min_base = [-3.0, 0.05, 0]
+        max_base = [3.0, height, 0.3]
+        base = $AM.createBoxPrimitiveActor(&quot;WallSet1_1&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [-10.0, 0.05, 0]
+	max_base = [-4, height, 0.3]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet1_2&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [4.0, 0.05, 0]
+	max_base = [10.0, height, 0.3]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet1_3&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [10.0, 0.05, 2]
+	max_base = [4, height, 2.3]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet1_4&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [-10.0, 0.05, 2]
+	max_base = [3, height, 2.3]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet1_5&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+
+
+        base.placeIntoScene(center);
+
+	min_base = [4.0, 0.05, 0.0]
+	max_base = [4.3, height, -7.0]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet1_6&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [4.0, 0.05, -8.0]
+	max_base = [4.3, height, -10.0]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet1_7&quot;,
+                                           min_base, max_base, &quot;alpha_blue&quot;)
+        base.placeIntoScene(center);
+
+    end
+end

Added: modules/aitest/scripts/WallSet2.rb
===================================================================
--- modules/aitest/scripts/WallSet2.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/WallSet2.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,35 @@
+require 'testcase.rb'
+
+class WallSet2 &lt; TestCase
+    def initialize(center)
+        super(center)
+
+        height = 1.0
+        min_base = [-10.0, 0.05, -10.0]
+        max_base = [10.0, height, -10.3]
+        base = $AM.createBoxPrimitiveActor(&quot;WallSet2_1&quot;,
+                                           min_base, max_base, &quot;white&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [-10.0, 0.05, 10.0]
+	max_base = [10.0, height, 10.3]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet2_2&quot;,
+                                           min_base, max_base, &quot;white&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [-10.0, 0.05, -10.0]
+	max_base = [-10.3, height, 10.0]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet2_3&quot;,
+                                           min_base, max_base, &quot;white&quot;)
+        base.placeIntoScene(center);
+
+	min_base = [10.0, 0.05, -10.0]
+	max_base = [10.3, height, 10.0]
+	base = $AM.createBoxPrimitiveActor(&quot;WallSet2_4&quot;,
+                                           min_base, max_base, &quot;white&quot;)
+
+
+        base.placeIntoScene(center);
+
+    end
+end

Added: modules/aitest/scripts/WayPointTest.rb
===================================================================
--- modules/aitest/scripts/WayPointTest.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/WayPointTest.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,82 @@
+
+
+class WayPointTest 
+    def initialize(center)
+	
+	height = 0.5;
+
+	@WPGraph = $WPGM.createWayPointGraph();
+	@WPGraph.addWayPoint([3, height, -8.5], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([3, height, -4], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([3, height, 0], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([3, height, 1], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([3, height, 5], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([3, height, 9.5], WayPointNode::WP_EXTERIOR);
+
+	@WPGraph.addWayPoint([4, height, -10], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([4, height, -7], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([4, height, -1], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([4, height, 2], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([4, height, 4], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([4, height, 7], WayPointNode::WP_EXTERIOR);
+
+	@WPGraph.addWayPoint([5, height, -6], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([5, height, -3], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([5, height, 1], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([5, height, 5], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([5, height, 6], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([5, height, 9.5], WayPointNode::WP_EXTERIOR);
+
+	@WPGraph.addWayPoint([6, height, -9], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([6, height, -2], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([6, height, -1], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([6, height, 4], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([6, height, 8], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([6, height, 9.5], WayPointNode::WP_EXTERIOR);
+
+	@WPGraph.addWayPoint([7, height, -8], WayPointNode::WP_EXTERIOR);
+	@WPGraph.addWayPoint([7, height, -4], WayPointNode::WP_EXTERIOR);
+
+	number = 4
+	inner = 5
+	count = 0
+	outercount = 0
+
+	number.times do
+		count = outercount * 6
+		inner.times do
+			wp2 = count + 1
+			@WPGraph.addConnection(@WPGraph.getWayPointAt(count),
+					       @WPGraph.getWayPointAt(wp2));
+			count += 1
+		end
+		outercount += 1
+	end
+
+	number -= 1
+	count = 0
+	outercount = 0
+	outer = 6
+	
+	outer.times do
+		count = outercount
+		number.times do
+			wp2 = count + outer
+			@WPGraph.addConnection(@WPGraph.getWayPointAt(count),
+					       @WPGraph.getWayPointAt(wp2));
+			count += outer
+		end
+		outercount += 1
+	end
+
+    end
+    def save()
+	@WPGraph.save(&quot;graphtest.wpg&quot;)
+    end
+    def load()
+	@WPGraph.load(&quot;graphtest.wpg&quot;)
+    end
+#def clear()
+#	@WPGraph.
+end
+

Added: modules/aitest/scripts/WayPointTest2.rb
===================================================================
--- modules/aitest/scripts/WayPointTest2.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/WayPointTest2.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,14 @@
+
+
+class WayPointTest2 
+    def initialize(center)
+	@WPGraph = $WPGM.createWayPointGraph();
+    end
+    def save()
+	@WPGraph.save(&quot;graphtest.wpg&quot;)
+    end
+    def load()
+	@WPGraph.load(&quot;graphtest.wpg&quot;)
+    end
+end
+

Added: modules/aitest/scripts/doortest.rb
===================================================================
--- modules/aitest/scripts/doortest.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/doortest.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,64 @@
+require 'util/vector_util.rb'
+require 'testcase.rb'
+require 'door.rb'
+require 'switch.rb'
+
+class DoorOpener &lt; ObjectStateChangeListener
+
+  def initialize(door, switch)
+    super()
+    @door = door
+    @switch = switch
+    @switch.addObjectStateChangeListener(self)
+  end
+
+  def objectStateChanged(event)
+      doorOpen = @switch.getState() == Switch3Way::STATE_OBEN
+      if (@door.isOpen() != doorOpen)
+        if (doorOpen)
+          @door.doAction(&quot;opendoor&quot;)
+        else
+          @door.doAction(&quot;closedoor&quot;)
+        end
+      end
+  end
+end
+
+# Test case for Doors. Tests basic GameObject interaction,
+# ObjectStateChange event handling and physical collision updates.
+class DoorTest &lt; TestCase
+    def initialize(center)
+        super(center)
+
+        # Define a base box to place everything else on.
+        height = 0.3
+        min_base = [-3.0, 0.05, -3.0]
+        max_base = [3.0, height, 3.0]
+        base = $AM.createBoxPrimitiveActor(&quot;DoorTestBase&quot;, min_base, max_base)
+        base.placeIntoScene(center);
+
+        # The door with the door knob
+        door1 = $GOM.createGameObjectProxy(&quot;door&quot;).getGameObject();
+	door1.setDescription(&quot;Eine Holztuer&quot;);
+	door1.setPosition(rel_pos([1.5, height, 0.0]));
+        # Place door and add door actions. Initially the door is not open but can be opened.
+        door1.placeIntoScene()
+
+        # The door without a working door knob, to be opened with
+        door2 = $GOM.createGameObjectProxy(&quot;door&quot;).getGameObject();
+	door2.setDescription(&quot;Eine Holztuer.\nDiese Tuer hat weder Klinke noch Schloesser&quot;);
+	door2.setPosition(rel_pos([-1.5, height, 0.0]));
+        # Place door and add door actions. Initially door is not open and cannot be opened.
+        door2.placeIntoScene()
+
+        # The switch to open the second door
+        switch = $GOM.createGameObjectProxy(&quot;switch3way&quot;).getGameObject();
+        switch.setPosition(rel_pos([2.25, height, 2.0]));
+	switch.placeIntoScene();
+
+        doorprocessor = DoorOpener.new(door2, switch);
+
+        $SCRIPT.log(&quot;doortest initialisiert&quot;);
+    end
+end
+

Added: modules/aitest/scripts/maps/aitest.rb
===================================================================
--- modules/aitest/scripts/maps/aitest.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/maps/aitest.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,59 @@
+load &quot;embed.rb&quot;
+
+require 'player.rb'
+require 'hero.rb'
+require 'debugkeys.rb'
+
+require 'doortest.rb'
+
+require 'WallSet1.rb'
+require 'WallSet2.rb'
+
+require 'NpcTest.rb'
+require 'NpcCapsuleTest.rb'
+
+require 'WayPointTest.rb'
+require 'WayPointTest2.rb'
+
+# Physik aktivieren
+$PM.setEnabled(true)
+
+$SCRIPT.log(&quot;init map 'regressiontest'...&quot;)
+
+$SCRIPT.log(&quot;Create hero&quot;)
+$hero = $GOM.createGameObjectProxy(&quot;hero&quot;, 1);
+
+$SCRIPT.log(&quot;Place hero into scene&quot;)
+#$hero.getGameObject().setPosition([0.0, 1.0, 0.0]);
+$hero.getGameObject().placeIntoScene()
+
+
+$SCRIPT.log(&quot;Prepare hero for being the active character&quot;)
+PlayerSettings.preparePlayer($hero.getGameObject())
+
+$SCRIPT.log(&quot;Set hero as active character&quot;)
+$UI.setActiveCharacter($hero.getGameObject())
+
+$SCRIPT.log(&quot;Hero ready&quot;)
+
+$SCRIPT.log(&quot;map 'regressiontest' initialisiert.&quot;);
+
+$debugkeys = DebugKeys.new();
+$UI.linkKeyToRubyCommand('G',&quot;$debugkeys.toggleWP()&quot;);
+
+$SCRIPT.log(&quot;debug keys are set up&quot;);
+
+#DoorTest.new([0.0, 0.0, -5.0])
+
+#WallSet1.new([0, 0, 0])
+WallSet2.new([0, 0, 0])
+
+NpcTest.new([-5, 0, 5])
+NpcCapsuleTest.new([0, 0, 5])
+
+#$MyWPT = WayPointTest.new([0, 0, 0])
+#$MyWPT.save()
+$MyWPT = WayPointTest2.new([0, 0, 0])
+$MyWPT.load()
+
+$SCRIPT.log(&quot;tests initialisiert.&quot;);

Added: modules/aitest/scripts/maps/aitest2.rb
===================================================================
--- modules/aitest/scripts/maps/aitest2.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/maps/aitest2.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,65 @@
+load &quot;embed.rb&quot;
+
+require 'player.rb'
+require 'hero.rb'
+require 'debugkeys.rb'
+
+#require 'doortest.rb'
+
+require 'WallSet1.rb'
+require 'WallSet2.rb'
+
+require 'NpcTest.rb'
+require 'NpcCapsuleTest.rb'
+
+require 'WayPointTest.rb'
+#require 'TimeTest.rb'
+#require 'InventoryTest.rb'
+#require 'ErrorHandlingTest.rb'
+#require 'JobSequenceTest.rb'
+
+# Physik aktivieren
+$PM.setEnabled(true)
+
+$SCRIPT.log(&quot;init map 'aitest'...&quot;)
+
+$SCRIPT.log(&quot;Create hero&quot;)
+$hero = $GOM.createGameObjectProxy(&quot;hero&quot;, 1);
+
+$SCRIPT.log(&quot;Place hero into scene&quot;)
+#$hero.getGameObject().setPosition([1.0, 0.0, 0.0]);
+$hero.getGameObject().placeIntoScene()
+
+
+$SCRIPT.log(&quot;Prepare hero for being the active character&quot;)
+PlayerSettings.preparePlayer($hero.getGameObject())
+
+$SCRIPT.log(&quot;Set hero as active character&quot;)
+$UI.setActiveCharacter($hero.getGameObject())
+
+$SCRIPT.log(&quot;Hero ready&quot;)
+
+$SCRIPT.log(&quot;map 'aitest' initialisiert.&quot;);
+
+$debugkeys = DebugKeys.new();
+$UI.linkKeyToRubyCommand('G',&quot;$debugkeys.toggleWP()&quot;);
+
+$SCRIPT.log(&quot;debug keys are set up&quot;);
+
+#DoorTest.new([0.0, 0.0, -5.0])
+
+#WallSet1.new([0, 0, 0])
+#WallSet2.new([0, 0, 0])
+
+WayPointTest.new([0, 0, 0])
+
+NpcTest.new([-5, 0, 5])
+NpcCapsuleTest.new([0, 0, 5])
+
+#TimeTest.new([-5, 0, -5])
+#ErrorHandlingTest.new([-10, 0, 5])
+#InventoryTest.new([0, 0, 10])
+#JobSequenceTest.new([5, 0, -5])
+$SCRIPT.log(&quot;tests initialisiert.&quot;);
+
+

Added: modules/aitest/scripts/maps/aitestold.rb
===================================================================
--- modules/aitest/scripts/maps/aitestold.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/maps/aitestold.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,65 @@
+load &quot;embed.rb&quot;
+
+require 'player.rb'
+require 'hero.rb'
+require 'debugkeys.rb'
+
+#require 'doortest.rb'
+
+require 'WallSet1.rb'
+require 'WallSet2.rb'
+
+require 'NpcTest.rb'
+require 'NpcCapsuleTest.rb'
+
+require 'WayPointTest.rb'
+#require 'TimeTest.rb'
+#require 'InventoryTest.rb'
+#require 'ErrorHandlingTest.rb'
+#require 'JobSequenceTest.rb'
+
+# Physik aktivieren
+$PM.setEnabled(true)
+
+$SCRIPT.log(&quot;init map 'aitest'...&quot;)
+
+$SCRIPT.log(&quot;Create hero&quot;)
+$hero = $GOM.createGameObjectProxy(&quot;hero&quot;, 1);
+
+$SCRIPT.log(&quot;Place hero into scene&quot;)
+#$hero.getGameObject().setPosition([1.0, 0.0, 0.0]);
+$hero.getGameObject().placeIntoScene()
+
+
+$SCRIPT.log(&quot;Prepare hero for being the active character&quot;)
+PlayerSettings.preparePlayer($hero.getGameObject())
+
+$SCRIPT.log(&quot;Set hero as active character&quot;)
+$UI.setActiveCharacter($hero.getGameObject())
+
+$SCRIPT.log(&quot;Hero ready&quot;)
+
+$SCRIPT.log(&quot;map 'aitest' initialisiert.&quot;);
+
+$debugkeys = DebugKeys.new();
+$UI.linkKeyToRubyCommand('G',&quot;$debugkeys.toggleWP()&quot;);
+
+$SCRIPT.log(&quot;debug keys are set up&quot;);
+
+#DoorTest.new([0.0, 0.0, -5.0])
+
+#WallSet1.new([0, 0, 0])
+#WallSet2.new([0, 0, 0])
+
+WayPointTest.new([0, 0, 0])
+
+NpcTest.new([-5, 0, 5])
+NpcCapsuleTest.new([0, 0, 5])
+
+#TimeTest.new([-5, 0, -5])
+#ErrorHandlingTest.new([-10, 0, 5])
+#InventoryTest.new([0, 0, 10])
+#JobSequenceTest.new([5, 0, -5])
+$SCRIPT.log(&quot;tests initialisiert.&quot;);
+
+

Added: modules/aitest/scripts/moduleconfig.rb
===================================================================
--- modules/aitest/scripts/moduleconfig.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/moduleconfig.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,30 @@
+include RlScript
+
+class AITestModule &lt; ContentModule
+    def initialize()
+        super(&quot;aitest&quot;, &quot;aitest&quot;, false, 20070303)
+    end
+
+    def getDependencies()
+        return [&quot;common&quot;]
+    end
+
+    def getTextureLocations()
+        return [&quot;textures&quot;]
+    end
+
+    def getModelLocations()
+        return []
+    end
+
+    def getSoundLocations()
+        return []
+    end
+
+    def start()
+        $CORE.loadMap(&quot;Octree&quot;, &quot;aitest.scene&quot;, &quot;aitest&quot;, &quot;aitest.rb&quot;)
+        $World = $CORE.getWorld();
+    end
+end
+
+CoreSubsystem.getSingleton().registerModule(AITestModule.new())

Added: modules/aitest/scripts/testcase.rb
===================================================================
--- modules/aitest/scripts/testcase.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/aitest/scripts/testcase.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -0,0 +1,9 @@
+class TestCase
+    def initialize(center)
+        @center = center
+    end
+    def rel_pos(position)
+        vector_add(@center, position)
+    end
+end
+

Modified: modules/common/scripts/globals.rb
===================================================================
--- modules/common/scripts/globals.rb	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/common/scripts/globals.rb	2007-03-05 20:08:20 UTC (rev 3121)
@@ -16,6 +16,7 @@
 $DS = DialogSubsystem.getSingleton();
 $WF = WindowFactory.getSingleton();
 $AI = AgentManager.getSingleton();
+$WPGM = WayPointGraphManager.getSingleton();
 $DVM = DebugVisualsManager.getSingleton();
 $SCRIPT = ScriptSubsystem.getSingleton();
 

Modified: modules/modules.cfg
===================================================================
--- modules/modules.cfg	2007-03-05 18:22:38 UTC (rev 3120)
+++ modules/modules.cfg	2007-03-05 20:08:20 UTC (rev 3121)
@@ -4,6 +4,8 @@
 module=intro
 
 module=regressiontest
+module=aitest
+
 module=techdemo
 module=techdemo2
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000191.html">[Dsa-hl-svn] r3120 - in rl/trunk/engine: ai/src common/src	dialog/src dialog/src/predicates
</A></li>
	<LI>Next message: <A HREF="000193.html">[Dsa-hl-svn] r3122 - in modules/aitest: maps scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#192">[ date ]</a>
              <a href="thread.html#192">[ thread ]</a>
              <a href="subject.html#192">[ subject ]</a>
              <a href="author.html#192">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
