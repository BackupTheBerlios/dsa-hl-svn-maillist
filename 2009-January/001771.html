<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r4714 - in rl/branches/newton20: .	Mac/Rastullah.xcodeproj Mac/tools engine/core/include	engine/core/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4714%20-%20in%20rl/branches/newton20%3A%20.%0A%09Mac/Rastullah.xcodeproj%20Mac/tools%20engine/core/include%0A%09engine/core/src&In-Reply-To=%3C200901211953.n0LJr3nB032068%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001770.html">
   <LINK REL="Next"  HREF="001772.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r4714 - in rl/branches/newton20: .	Mac/Rastullah.xcodeproj Mac/tools engine/core/include	engine/core/src</H1>
    <B>melven at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4714%20-%20in%20rl/branches/newton20%3A%20.%0A%09Mac/Rastullah.xcodeproj%20Mac/tools%20engine/core/include%0A%09engine/core/src&In-Reply-To=%3C200901211953.n0LJr3nB032068%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r4714 - in rl/branches/newton20: .	Mac/Rastullah.xcodeproj Mac/tools engine/core/include	engine/core/src">melven at mail.berlios.de
       </A><BR>
    <I>Wed Jan 21 20:53:03 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001770.html">[Dsa-hl-svn] r4713 - rl/trunk/Mac/Rastullah.xcodeproj
</A></li>
        <LI>Next message: <A HREF="001772.html">[Dsa-hl-svn] r4715 - in dependencies/OgreNewt_ngt: inc src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1771">[ date ]</a>
              <a href="thread.html#1771">[ thread ]</a>
              <a href="subject.html#1771">[ subject ]</a>
              <a href="author.html#1771">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: melven
Date: 2009-01-21 20:52:59 +0100 (Wed, 21 Jan 2009)
New Revision: 4714

Modified:
   rl/branches/newton20/CMakeLists.txt
   rl/branches/newton20/Mac/Rastullah.xcodeproj/project.pbxproj
   rl/branches/newton20/Mac/tools/renameinstalldirs.sh
   rl/branches/newton20/engine/core/include/CoreSubsystem.h
   rl/branches/newton20/engine/core/src/CoreSubsystem.cpp
   rl/branches/newton20/engine/core/src/SoundManager.cpp
Log:
-merged from trunk
-set debug flags im CMakeLists.txt


Modified: rl/branches/newton20/CMakeLists.txt
===================================================================
--- rl/branches/newton20/CMakeLists.txt	2009-01-17 12:14:07 UTC (rev 4713)
+++ rl/branches/newton20/CMakeLists.txt	2009-01-21 19:52:59 UTC (rev 4714)
@@ -78,6 +78,10 @@
 	SET_FEATURE_INFO(SWIG &quot;&quot; &quot;&quot; &quot;You use an unsupported version of SWIG.&quot;)
 ENDIF(NOT SWIG_DIR MATCHES -rl$)
 
+# Compile settings for build types
+SET(CMAKE_CXX_FLAGS_DEBUG &quot;-O0 -g -DDEBUG&quot;)
+SET(CMAKE_CXX_FLAGS_RELWITHDEBINFO &quot;-O2 -g -DDEBUG&quot;)
+
 # Path options
 SET(BINDIR &quot;bin&quot; CACHE STRING &quot;Where to install binaries&quot;)
 SET(DATAROOTDIR &quot;${CMAKE_INSTALL_PREFIX}/share&quot; CACHE STRING &quot;Sets the root of data directories to a non-default location&quot;)

Modified: rl/branches/newton20/Mac/Rastullah.xcodeproj/project.pbxproj
===================================================================
--- rl/branches/newton20/Mac/Rastullah.xcodeproj/project.pbxproj	2009-01-17 12:14:07 UTC (rev 4713)
+++ rl/branches/newton20/Mac/Rastullah.xcodeproj/project.pbxproj	2009-01-21 19:52:59 UTC (rev 4714)
@@ -429,7 +429,6 @@
 		44D8147A0BF7B62F00534175 /* Trigger.h in Headers */ = {isa = PBXBuildFile; fileRef = 44D814750BF7B62F00534175 /* Trigger.h */; };
 		44D8147B0BF7B62F00534175 /* Zone.h in Headers */ = {isa = PBXBuildFile; fileRef = 44D814760BF7B62F00534175 /* Zone.h */; };
 		44D8147C0BF7B62F00534175 /* ZoneManager.h in Headers */ = {isa = PBXBuildFile; fileRef = 44D814770BF7B62F00534175 /* ZoneManager.h */; };
-		48003B550E3211660056D073 /* libboost_system.dylib in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 48A52CAF0E0EF55C008DBDD8 /* libboost_system.dylib */; };
 		483646990D83D13700912FEC /* ContentLoader.h in Headers */ = {isa = PBXBuildFile; fileRef = 483646960D83D13700912FEC /* ContentLoader.h */; };
 		4836469A0D83D13700912FEC /* SoundStitching.h in Headers */ = {isa = PBXBuildFile; fileRef = 483646970D83D13700912FEC /* SoundStitching.h */; };
 		4836469B0D83D13700912FEC /* StartAnimationJob.h in Headers */ = {isa = PBXBuildFile; fileRef = 483646980D83D13700912FEC /* StartAnimationJob.h */; };
@@ -549,7 +548,7 @@
 		484D92210E1E078100BCFC2B /* libRlRules.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC370BD0E44900C6D4A0 /* libRlRules.dylib */; };
 		484D92220E1E078100BCFC2B /* libRlUi.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 444EAC3E0BD0E46000C6D4A0 /* libRlUi.dylib */; };
 		484D92230E1E078100BCFC2B /* libRlScript.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 48570C1B0D8A6C5400096E35 /* libRlScript.dylib */; };
-		484D92240E1E078100BCFC2B /* libRlFmod4Driver.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 483D86700D8C3A3300F3629E /* libRlFmod4Driver.dylib */; };
+		484D92240E1E078100BCFC2B /* RlFmod4Driver.bundle in Resources */ = {isa = PBXBuildFile; fileRef = 483D86700D8C3A3300F3629E /* RlFmod4Driver.bundle */; };
 		484D92250E1E078100BCFC2B /* RlScript.bundle in Resources */ = {isa = PBXBuildFile; fileRef = 483D87C90D8C55E500F3629E /* RlScript.bundle */; };
 		484FE6BA0E17BC8800FA880F /* Carbon.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 484FE6B90E17BC8800FA880F /* Carbon.framework */; };
 		484FE6BB0E17BC8800FA880F /* Carbon.framework in Frameworks */ = {isa = PBXBuildFile; fileRef = 484FE6B90E17BC8800FA880F /* Carbon.framework */; };
@@ -612,6 +611,8 @@
 		485B895A0E15796500D5B19C /* Scene.cpp in Sources */ = {isa = PBXBuildFile; fileRef = 485B89570E15796500D5B19C /* Scene.cpp */; };
 		485B895B0E15796500D5B19C /* SceneLoader.cpp in Sources */ = {isa = PBXBuildFile; fileRef = 485B89580E15796500D5B19C /* SceneLoader.cpp */; };
 		485B895C0E15796500D5B19C /* SceneManager.cpp in Sources */ = {isa = PBXBuildFile; fileRef = 485B89590E15796500D5B19C /* SceneManager.cpp */; };
+		4869D5300EF055F500619D4D /* libboost_system.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 48A52CAF0E0EF55C008DBDD8 /* libboost_system.dylib */; };
+		4869D5310EF055F600619D4D /* libboost_filesystem.dylib in Resources */ = {isa = PBXBuildFile; fileRef = 48A52B210E0EDA0E008DBDD8 /* libboost_filesystem.dylib */; };
 		487029C70E80DCEA00B66388 /* GameOverWindow.h in Headers */ = {isa = PBXBuildFile; fileRef = 487029C60E80DCEA00B66388 /* GameOverWindow.h */; };
 		487029C90E80DCF900B66388 /* GameOverWindow.cpp in Sources */ = {isa = PBXBuildFile; fileRef = 487029C80E80DCF900B66388 /* GameOverWindow.cpp */; };
 		487029E80E80E12200B66388 /* PartyManager.h in Headers */ = {isa = PBXBuildFile; fileRef = 487029E70E80E12200B66388 /* PartyManager.h */; };
@@ -681,7 +682,6 @@
 		48C04B8A0E67DF0300CD3A7D /* PCRE.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 48C04B890E67DF0300CD3A7D /* PCRE.framework */; };
 		48CFBF8F0E2E869000CD0C51 /* FreeType.framework in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 48CFBF8E0E2E869000CD0C51 /* FreeType.framework */; };
 		48D0BDC70E23375E00863824 /* libruby.dylib in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 483646A10D83D57800912FEC /* libruby.dylib */; };
-		48D0BDE60E23378700863824 /* libboost_filesystem.dylib in Copy Frameworks */ = {isa = PBXBuildFile; fileRef = 48A52B210E0EDA0E008DBDD8 /* libboost_filesystem.dylib */; };
 		48D0BE2C0E273C5E00863824 /* SaveAble.h in Headers */ = {isa = PBXBuildFile; fileRef = 48D0BE280E273C5E00863824 /* SaveAble.h */; };
 		48D0BE2D0E273C5E00863824 /* SaveAbleCollection.h in Headers */ = {isa = PBXBuildFile; fileRef = 48D0BE290E273C5E00863824 /* SaveAbleCollection.h */; };
 		48D0BE2E0E273C5E00863824 /* SaveAbleFactory.h in Headers */ = {isa = PBXBuildFile; fileRef = 48D0BE2A0E273C5E00863824 /* SaveAbleFactory.h */; };
@@ -705,7 +705,6 @@
 		48D34A7F0D91C7D800C89477 /* SaveGameFileReader.h in Headers */ = {isa = PBXBuildFile; fileRef = 485A056F0D71EDC40024198D /* SaveGameFileReader.h */; };
 		48D34A800D91C7D800C89477 /* SaveGameFileWriter.h in Headers */ = {isa = PBXBuildFile; fileRef = 485A05700D71EDC40024198D /* SaveGameFileWriter.h */; };
 		48D34A810D91C7D800C89477 /* SaveGameManager.h in Headers */ = {isa = PBXBuildFile; fileRef = 485A05710D71EDC40024198D /* SaveGameManager.h */; };
-		48D409CE0D9E483300AE5340 /* modules in Resources */ = {isa = PBXBuildFile; fileRef = 48D401810D9E483200AE5340 /* modules */; };
 		48EFE0A40E8B6AF6007EB7F8 /* FetchItemJob.h in Headers */ = {isa = PBXBuildFile; fileRef = 48EFE0A30E8B6AF6007EB7F8 /* FetchItemJob.h */; };
 		48EFE0A60E8B6C39007EB7F8 /* FetchItemJob.cpp in Sources */ = {isa = PBXBuildFile; fileRef = 48EFE0A50E8B6C39007EB7F8 /* FetchItemJob.cpp */; };
 		8D0C4E8D0486CD37000505A6 /* InfoPlist.strings in Resources */ = {isa = PBXBuildFile; fileRef = 0867D6AAFE840B52C02AAC07 /* InfoPlist.strings */; };
@@ -864,8 +863,6 @@
 			files = (
 				487750B00E7E3C9C0018216B /* Cg.framework in Copy Frameworks */,
 				48C04B8A0E67DF0300CD3A7D /* PCRE.framework in Copy Frameworks */,
-				48003B550E3211660056D073 /* libboost_system.dylib in Copy Frameworks */,
-				48D0BDE60E23378700863824 /* libboost_filesystem.dylib in Copy Frameworks */,
 				48CFBF8F0E2E869000CD0C51 /* FreeType.framework in Copy Frameworks */,
 				48D0BDC70E23375E00863824 /* libruby.dylib in Copy Frameworks */,
 				484D92140E1E060200BCFC2B /* Xerces.framework in Copy Frameworks */,
@@ -1405,7 +1402,7 @@
 		483D31710D85B3B7003477A0 /* SimpleVehicle.cpp */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.cpp.cpp; name = SimpleVehicle.cpp; path = ../engine/ai/src/SimpleVehicle.cpp; sourceTree = SOURCE_ROOT; };
 		483D31720D85B3B7003477A0 /* stdinc.cpp */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.cpp.cpp; name = stdinc.cpp; path = ../engine/ai/src/stdinc.cpp; sourceTree = SOURCE_ROOT; };
 		483D31730D85B3B7003477A0 /* WalkPathBehaviour.cpp */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.cpp.cpp; name = WalkPathBehaviour.cpp; path = ../engine/ai/src/WalkPathBehaviour.cpp; sourceTree = SOURCE_ROOT; };
-		483D86700D8C3A3300F3629E /* libRlFmod4Driver.dylib */ = {isa = PBXFileReference; explicitFileType = &quot;compiled.mach-o.dylib&quot;; includeInIndex = 0; path = libRlFmod4Driver.dylib; sourceTree = BUILT_PRODUCTS_DIR; };
+		483D86700D8C3A3300F3629E /* RlFmod4Driver.bundle */ = {isa = PBXFileReference; explicitFileType = &quot;compiled.mach-o.dylib&quot;; includeInIndex = 0; path = RlFmod4Driver.bundle; sourceTree = BUILT_PRODUCTS_DIR; };
 		483D868C0D8C3DA200F3629E /* Fmod4ConfigComponent.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; path = Fmod4ConfigComponent.h; sourceTree = &quot;&lt;group&gt;&quot;; };
 		483D868D0D8C3DA200F3629E /* Fmod4Driver.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; path = Fmod4Driver.h; sourceTree = &quot;&lt;group&gt;&quot;; };
 		483D868E0D8C3DA200F3629E /* Fmod4DriverPrerequisites.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; path = Fmod4DriverPrerequisites.h; sourceTree = &quot;&lt;group&gt;&quot;; };
@@ -1698,7 +1695,7 @@
 				444EAC370BD0E44900C6D4A0 /* libRlRules.dylib */,
 				444EAC3E0BD0E46000C6D4A0 /* libRlUi.dylib */,
 				48570C1B0D8A6C5400096E35 /* libRlScript.dylib */,
-				483D86700D8C3A3300F3629E /* libRlFmod4Driver.dylib */,
+				483D86700D8C3A3300F3629E /* RlFmod4Driver.bundle */,
 				483D87C90D8C55E500F3629E /* RlScript.bundle */,
 			);
 			name = Products;
@@ -3038,7 +3035,7 @@
 			);
 			name = RlFmod4Driver;
 			productName = RlFmod4Driver;
-			productReference = 483D86700D8C3A3300F3629E /* libRlFmod4Driver.dylib */;
+			productReference = 483D86700D8C3A3300F3629E /* RlFmod4Driver.bundle */;
 			productType = &quot;com.apple.product-type.library.dynamic&quot;;
 		};
 		483D87C80D8C55E500F3629E /* RlScriptExports */ = {
@@ -3143,6 +3140,8 @@
 			isa = PBXResourcesBuildPhase;
 			buildActionMask = 2147483647;
 			files = (
+				4869D5300EF055F500619D4D /* libboost_system.dylib in Resources */,
+				4869D5310EF055F600619D4D /* libboost_filesystem.dylib in Resources */,
 				48B0B03C0E6535AB0023B198 /* libmeshmagick.dylib in Resources */,
 				484D921E0E1E078100BCFC2B /* libRlCommon.dylib in Resources */,
 				484D921F0E1E078100BCFC2B /* libRlCore.dylib in Resources */,
@@ -3151,11 +3150,10 @@
 				484D92220E1E078100BCFC2B /* libRlUi.dylib in Resources */,
 				48B0B04A0E65BBC10023B198 /* libfmodex.dylib in Resources */,
 				484D92230E1E078100BCFC2B /* libRlScript.dylib in Resources */,
-				484D92240E1E078100BCFC2B /* libRlFmod4Driver.dylib in Resources */,
+				484D92240E1E078100BCFC2B /* RlFmod4Driver.bundle in Resources */,
 				484D92250E1E078100BCFC2B /* RlScript.bundle in Resources */,
 				8D0C4E8D0486CD37000505A6 /* InfoPlist.strings in Resources */,
 				8D0C4E8E0486CD37000505A6 /* main.nib in Resources */,
-				48D409CE0D9E483300AE5340 /* modules in Resources */,
 			);
 			runOnlyForDeploymentPostprocessing = 0;
 		};
@@ -3765,6 +3763,7 @@
 				OTHER_LDFLAGS = &quot;&quot;;
 				PREBINDING = NO;
 				PRODUCT_NAME = libRlCore;
+				SDKROOT = /Developer/SDKs/MacOSX10.4u.sdk;
 				ZERO_LINK = NO;
 			};
 			name = Debug;
@@ -3806,6 +3805,7 @@
 				OTHER_LDFLAGS = &quot;&quot;;
 				PREBINDING = NO;
 				PRODUCT_NAME = RlCore;
+				SDKROOT = /Developer/SDKs/MacOSX10.4u.sdk;
 				ZERO_LINK = NO;
 			};
 			name = Release;
@@ -4038,7 +4038,10 @@
 			isa = XCBuildConfiguration;
 			buildSettings = {
 				COPY_PHASE_STRIP = NO;
-				EXECUTABLE_PREFIX = lib;
+				DYLIB_COMPATIBILITY_VERSION = &quot;&quot;;
+				DYLIB_CURRENT_VERSION = &quot;&quot;;
+				EXECUTABLE_EXTENSION = bundle;
+				EXECUTABLE_PREFIX = &quot;&quot;;
 				FRAMEWORK_SEARCH_PATHS = (
 					&quot;$(inherited)&quot;,
 					&quot;$(FRAMEWORK_SEARCH_PATHS_QUOTED_FOR_TARGET_1)&quot;,
@@ -4060,6 +4063,7 @@
 				);
 				LIBRARY_SEARCH_PATHS_QUOTED_FOR_TARGET_1 = &quot;\&quot;/Developer/FMOD Programmers API/api/lib\&quot;&quot;;
 				LIBRARY_SEARCH_PATHS_QUOTED_FOR_TARGET_2 = &quot;\&quot;$(DEVELOPER_DIR)/FMOD Programmers API/api/lib\&quot;&quot;;
+				MACH_O_TYPE = mh_bundle;
 				OTHER_LDFLAGS = &quot;-lfmodex&quot;;
 				PREBINDING = NO;
 				PRODUCT_NAME = RlFmod4Driver;
@@ -4072,7 +4076,10 @@
 			buildSettings = {
 				COPY_PHASE_STRIP = YES;
 				DEBUG_INFORMATION_FORMAT = &quot;dwarf-with-dsym&quot;;
-				EXECUTABLE_PREFIX = lib;
+				DYLIB_COMPATIBILITY_VERSION = &quot;&quot;;
+				DYLIB_CURRENT_VERSION = &quot;&quot;;
+				EXECUTABLE_EXTENSION = bundle;
+				EXECUTABLE_PREFIX = &quot;&quot;;
 				FRAMEWORK_SEARCH_PATHS = (
 					&quot;$(inherited)&quot;,
 					&quot;$(FRAMEWORK_SEARCH_PATHS_QUOTED_FOR_TARGET_1)&quot;,
@@ -4092,6 +4099,7 @@
 				);
 				LIBRARY_SEARCH_PATHS_QUOTED_FOR_TARGET_1 = &quot;\&quot;/Developer/FMOD Programmers API/api/lib\&quot;&quot;;
 				LIBRARY_SEARCH_PATHS_QUOTED_FOR_TARGET_2 = &quot;\&quot;$(DEVELOPER_DIR)/FMOD Programmers API/api/lib\&quot;&quot;;
+				MACH_O_TYPE = mh_bundle;
 				OTHER_LDFLAGS = &quot;-lfmodex&quot;;
 				PREBINDING = NO;
 				PRODUCT_NAME = RlFmod4Driver;
@@ -4259,6 +4267,7 @@
 				LIBRARY_SEARCH_PATHS_QUOTED_FOR_TARGET_3 = &quot;\&quot;$(SRCROOT)/build/Debug\&quot;&quot;;
 				LIBRARY_SEARCH_PATHS_QUOTED_FOR_TARGET_4 = &quot;\&quot;$(DEVELOPER_DIR)/FMOD Programmers API/api/lib\&quot;&quot;;
 				PRODUCT_NAME = Rastullah;
+				SDKROOT = /Developer/SDKs/MacOSX10.4u.sdk;
 				WRAPPER_EXTENSION = app;
 				ZERO_LINK = YES;
 			};
@@ -4292,6 +4301,7 @@
 				LIBRARY_SEARCH_PATHS_QUOTED_3 = &quot;\&quot;$(SRCROOT)/build/Debug\&quot;&quot;;
 				LIBRARY_SEARCH_PATHS_QUOTED_FOR_TARGET_1 = &quot;\&quot;$(DEVELOPER_DIR)/FMOD Programmers API/api/lib\&quot;&quot;;
 				PRODUCT_NAME = Rastullah;
+				SDKROOT = /Developer/SDKs/MacOSX10.4u.sdk;
 				WRAPPER_EXTENSION = app;
 			};
 			name = Release;

Modified: rl/branches/newton20/Mac/tools/renameinstalldirs.sh
===================================================================
--- rl/branches/newton20/Mac/tools/renameinstalldirs.sh	2009-01-17 12:14:07 UTC (rev 4713)
+++ rl/branches/newton20/Mac/tools/renameinstalldirs.sh	2009-01-21 19:52:59 UTC (rev 4714)
@@ -2,20 +2,33 @@
 RASTULLAH_APP_DIR=$1
 RASTULLAH_APP_NAME=$2
 RASTULLAH_APP_BIN=${RASTULLAH_APP_DIR}/${RASTULLAH_APP_NAME}
-CEGUI_BIN=${RASTULLAH_APP_DIR}/../Frameworks/CEGUI.framework/CEGUI
+CEGUI_DIR=${RASTULLAH_APP_DIR}/../Frameworks/CEGUI.framework
+CEGUI_BIN=${CEGUI_DIR}/CEGUI
 RASTULLAH_RES_DIR=$1/../Resources
 
 #TODO: Replace the absolute source paths to something with olist -L $RASTULLAH_APP_NAME and grep
 
 echo Changing library installation directories for $RASTULLAH_APP_NAME
 
-RL_BINARIES=&quot;$RASTULLAH_APP_BIN $RASTULLAH_RES_DIR/libRlAi.dylib $RASTULLAH_RES_DIR/libRlCommon.dylib $RASTULLAH_RES_DIR/libRlCore.dylib $RASTULLAH_RES_DIR/libRlRules.dylib $RASTULLAH_RES_DIR/libRlScript.dylib $RASTULLAH_RES_DIR/libRlUi.dylib $RASTULLAH_RES_DIR/libRlFmod4Driver.dylib&quot;
+RL_BINARIES=&quot;$RASTULLAH_APP_BIN \
+    $RASTULLAH_RES_DIR/libRlAi.dylib \
+    $RASTULLAH_RES_DIR/libRlCommon.dylib \
+    $RASTULLAH_RES_DIR/libRlCore.dylib \
+    $RASTULLAH_RES_DIR/libRlRules.dylib \
+    $RASTULLAH_RES_DIR/libRlScript.dylib \
+    $RASTULLAH_RES_DIR/libRlUi.dylib \
+    $RASTULLAH_RES_DIR/libRlFmod4Driver.dylib \
+    $RASTULLAH_RES_DIR/libboost_filesystem.dylib \
+    $RASTULLAH_RES_DIR/libboost_system.dylib \
+    $RASTULLAH_RES_DIR/RlScript.bundle&quot;
+
 # RL Application binary
 for cur in $RL_BINARIES 
 do
     echo Processing $cur
     install_name_tool -change /Library/Frameworks/CEGUI.framework/Versions/A/CEGUI @executable_path/../Frameworks/CEGUI.framework/Versions/A/CEGUI $cur
-    install_name_tool -change libboost_system-mt-1_35.dylib @executable_path/../Frameworks/libboost_system.dylib $cur
+    install_name_tool -change libboost_system-mt-1_35.dylib @executable_path/../Resources/libboost_system.dylib $cur
+    install_name_tool -change libboost_filesystem-mt-1_35.dylib @executable_path/../Resources/libboost_filesystem.dylib $cur
     install_name_tool -change /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/libruby.1.dylib @executable_path/../Frameworks/libruby.1.dylib $cur
     install_name_tool -change /Users/blakharaz/Library/Frameworks/OgreNewt.framework/Versions/A/OgreNewt @executable_path/../Frameworks/OgreNewt.framework/Versions/A/OgreNewt $cur
     install_name_tool -change /Users/blakharaz/Library/Frameworks/OpenSteer.framework/Versions/0.8/OpenSteer @executable_path/../Frameworks/OpenSteer.framework/Versions/0.8/OpenSteer $cur
@@ -24,6 +37,10 @@
 
 # CEGUI
 install_name_tool -change /Library/Frameworks/CEGUI.framework/Versions/A/CEGUI @executable_path/../Frameworks/CEGUI.framework/Versions/A/CEGUI ${CEGUI_BIN}
+install_name_tool -change /Library/Frameworks/CEGUI.framework/Versions/A/CEGUI @executable_path/../Frameworks/CEGUI.framework/Versions/A/CEGUI ${CEGUI_DIR}/Resources/CEGUIExpatParser.bundle/Contents/MacOS/CEGUIExpatParser
+install_name_tool -change /Library/Frameworks/CEGUI.framework/Versions/A/CEGUI @executable_path/../Frameworks/CEGUI.framework/Versions/A/CEGUI ${CEGUI_DIR}/Resources/CEGUIFalagardWRBase.bundle/Contents/MacOS/CEGUIFalagardWRBase
+install_name_tool -change /Library/Frameworks/CEGUI.framework/Versions/A/CEGUI @executable_path/../Frameworks/CEGUI.framework/Versions/A/CEGUI ${CEGUI_DIR}/Resources/CEGUIFreeImageImageCodec.bundle/Contents/MacOS/CEGUIFreeImageImageCodec
+install_name_tool -change /Library/Frameworks/CEGUI.framework/Versions/A/CEGUI @executable_path/../Frameworks/CEGUI.framework/Versions/A/CEGUI ${CEGUI_DIR}/Resources/CEGUIDevILImageCodec.bundle/Contents/MacOS/CEGUIDevILImageCodec
 install_name_tool -change /Library/Frameworks/FreeType.framework/Versions/2.3/FreeType @executable_path/../Frameworks/FreeType.framework/Versions/2.3/FreeType ${CEGUI_BIN}
 
 echo done.
\ No newline at end of file

Modified: rl/branches/newton20/engine/core/include/CoreSubsystem.h
===================================================================
--- rl/branches/newton20/engine/core/include/CoreSubsystem.h	2009-01-17 12:14:07 UTC (rev 4713)
+++ rl/branches/newton20/engine/core/include/CoreSubsystem.h	2009-01-21 19:52:59 UTC (rev 4714)
@@ -1,169 +1,170 @@
-/* This source file is part of Rastullahs Lockenpracht.
- * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the Clarified Artistic License.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  Clarified Artistic License for more details.
- *
- *  You should have received a copy of the Clarified Artistic License
- *  along with this program; if not you can get it here
- *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
- */
-
-#ifndef __CoreSubsystem_H__
-#define __CoreSubsystem_H__
-
-
-#include &lt;map&gt;
-
-#include &quot;EventSource.h&quot;
-#include &quot;EventCaster.h&quot;
-#include &quot;CorePrerequisites.h&quot;
-
-namespace rl {
-
-class RubyInterpreter;
-class World;
-class CoreEvent;
-class CoreEventListener;
-class Actor;
-class ContentModule;
-class ScriptWrapper;
-class PhysicsManager;
-class MessagePump;
-class GameLoop;
-class AnimationManager;
-class ActorManager;
-class GameEventManager;
-class XmlResourceManager;
-class SoundManager;
-class DebugVisualsManager;
-class SaveGameManager;
-class JobScheduler;
-class ZoneManager;
-class TimeSourceManager;
-
-typedef _RlCoreExport std::map&lt;Ogre::String, ContentModule*&gt; ModuleMap;
-
-/** CoreSubsystem.
-    @remarks
-        It follows the Singleton Pattern,
-        and initialises the game context.
-*/
-class _RlCoreExport CoreSubsystem : public Ogre::Singleton&lt;CoreSubsystem&gt;
-{
-public:
-    /** Default Constructor */
-    CoreSubsystem();
-    /** Default Deconstructor */
-    virtual ~CoreSubsystem();
-
-    /** Starts the Game */
-    void startCore();
-
-    /** Renders one frame (for internal use) */
-    void renderOneFrame(bool executeTasks = true);
-
-    World* getWorld();
-    void loadMap(const Ogre::String type, const Ogre::String filename,
-        const Ogre::String module);
-
-    RubyInterpreter* getRubyInterpreter();
-
-    ContentModule* getActiveAdventureModule() const;
-    ContentModule* getModule(const Ogre::String&amp; moduleId) const;
-    const ModuleMap&amp; getAllModules() const;
-    void startAdventureModule(ContentModule* module);
-    void setDefaultActiveModule(const Ogre::String&amp; moduleId);
-    const Ogre::String&amp; getDefaultActiveModule() const;
-    void registerModule(ContentModule* module);
-
-    void setDeveloperMode(bool developerMode);
-    bool getDeveloperMode() const;
-
-    /** Saves a timestamped png Screenshot
-        @param sName The filename (extended with the timestamp)
-    */
-    void makeScreenshot(const Ogre::String&amp; sName);
-
-    void setScheme(const Ogre::String&amp; schemeName);
-
-    bool isInitialized() const;
-
-    const Ogre::String getEngineVersionString() const;
-    const Ogre::String getEngineVersionName() const;
-    long         getEngineBuildNumber() const;
-
-    /**
-     * Retrieves a pointer to the current render window.
-     *
-     * @return pointer to render window
-     */
-    Ogre::RenderWindow* getRenderWindow() const;
-
-	/// Sets the pause state of the game
-	/// @param paused &lt;code&gt;true&lt;/code&gt; if the game should be paused, &lt;code&gt;false&lt;/code&gt; if it should be continued
-	void setPaused(bool paused);
-
-    void setTimeFactor(const Ogre::Real&amp; factor = 1.0F);
-
-    void _setCurrentScene(const CeGuiString&amp; scene);
-    const CeGuiString&amp; getCurrentScene() const;
-
-private:
-    World* mWorld;
-    RubyInterpreter* mRubyInterpreter;
-    ModuleMap mModules;
-    ContentModule* mActiveAdventureModule;
-    Ogre::String mDefaultActiveModule;
-    Ogre::RenderWindow* mRenderWindow;            //!&lt; Render window for OGRE
-    CeGuiString mCurrentScene;
-
-    RL_LONGLONG mClockStartTime;
-
-    bool mDeveloperMode;
-    bool mInitialized;
-    std::vector&lt;Ogre::Technique*&gt; mDefaultTechniques;
-
-    // The singletons of this subsystem
-    Ogre::Root* mOgreRoot;
-    ScriptWrapper* mScriptWrapper;
-    XmlResourceManager* mXmlResourceManager;
-    PhysicsManager* mPhysicsManager;
-    MessagePump* mMessagePump;
-    GameLoop* mGameLoop;
-    AnimationManager* mAnimationManager;
-    ActorManager* mActorManager;
-    GameEventManager* mGameEventManager;
-    SoundManager* mSoundManager;
-    DebugVisualsManager* mDebugVisualsManager;
-    SaveGameManager* mSaveGameManager;
-    JobScheduler* mJobScheduler;
-	ZoneManager* mZoneManager;
-    TimeSourceManager* mTimeSourceManager;
-
-    /** Runs the setup methods  */
-    bool initializeCoreSubsystem();
-
-    /** Loads all needed ressources */
-    void initializeResources();
-
-    void loadPlugins();
-    void unloadPlugins();
-
-    /**
-     * Sammelt alle Default-Techniques, um sie sp&#228;ter bei jedem aktivierten Scheme
-     * benutzen zu k&#246;nnen
-     */
-    void updateDefaultScheme();
-
-    void loadModule(ContentModule* module);
-};
-
-}
-#endif
-
+/* This source file is part of Rastullahs Lockenpracht.
+ * Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the Clarified Artistic License.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  Clarified Artistic License for more details.
+ *
+ *  You should have received a copy of the Clarified Artistic License
+ *  along with this program; if not you can get it here
+ *  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+ */
+
+#ifndef __CoreSubsystem_H__
+#define __CoreSubsystem_H__
+
+
+#include &lt;map&gt;
+
+#include &quot;EventSource.h&quot;
+#include &quot;EventCaster.h&quot;
+#include &quot;CorePrerequisites.h&quot;
+
+namespace rl {
+
+class RubyInterpreter;
+class World;
+class CoreEvent;
+class CoreEventListener;
+class Actor;
+class ContentModule;
+class ScriptWrapper;
+class PhysicsManager;
+class MessagePump;
+class GameLoop;
+class AnimationManager;
+class ActorManager;
+class GameEventManager;
+class XmlResourceManager;
+class SoundManager;
+class DebugVisualsManager;
+class SaveGameManager;
+class JobScheduler;
+class ZoneManager;
+class TimeSourceManager;
+
+typedef _RlCoreExport std::map&lt;Ogre::String, ContentModule*&gt; ModuleMap;
+
+/** CoreSubsystem.
+    @remarks
+        It follows the Singleton Pattern,
+        and initialises the game context.
+*/
+class _RlCoreExport CoreSubsystem : public Ogre::Singleton&lt;CoreSubsystem&gt;
+{
+public:
+    /** Default Constructor */
+    CoreSubsystem();
+    /** Default Deconstructor */
+    virtual ~CoreSubsystem();
+
+    /** Starts the Game */
+    void startCore();
+
+    /** Renders one frame (for internal use) */
+    void renderOneFrame(bool executeTasks = true);
+
+    World* getWorld();
+    void loadMap(const Ogre::String&amp; type, const Ogre::String&amp; filename,
+        const Ogre::String&amp; module);
+
+    RubyInterpreter* getRubyInterpreter();
+
+    ContentModule* getActiveAdventureModule() const;
+    ContentModule* getModule(const Ogre::String&amp; moduleId) const;
+    const ModuleMap&amp; getAllModules() const;
+    void startAdventureModule(ContentModule* module);
+    void setDefaultActiveModule(const Ogre::String&amp; moduleId);
+    const Ogre::String&amp; getDefaultActiveModule() const;
+    void registerModule(ContentModule* module);
+
+    void setDeveloperMode(bool developerMode);
+    bool getDeveloperMode() const;
+
+    /** Saves a timestamped png Screenshot
+        @param sName The filename (extended with the timestamp)
+    */
+    void makeScreenshot(const Ogre::String&amp; sName);
+
+    void setScheme(const Ogre::String&amp; schemeName);
+
+    bool isInitialized() const;
+
+    const Ogre::String getEngineVersionString() const;
+    const Ogre::String getEngineVersionName() const;
+    long         getEngineBuildNumber() const;
+
+    /**
+     * Retrieves a pointer to the current render window.
+     *
+     * @return pointer to render window
+     */
+    Ogre::RenderWindow* getRenderWindow() const;
+
+	/// Sets the pause state of the game
+	/// @param paused &lt;code&gt;true&lt;/code&gt; if the game should be paused, &lt;code&gt;false&lt;/code&gt; if it should be continued
+	void setPaused(bool paused);
+
+    void setTimeFactor(const Ogre::Real&amp; factor = 1.0F);
+
+    void _setCurrentScene(const CeGuiString&amp; scene);
+    const CeGuiString&amp; getCurrentScene() const;
+    void loadPlugin(const Ogre::String&amp; plugin);
+
+private:
+    World* mWorld;
+    RubyInterpreter* mRubyInterpreter;
+    ModuleMap mModules;
+    ContentModule* mActiveAdventureModule;
+    Ogre::String mDefaultActiveModule;
+    Ogre::RenderWindow* mRenderWindow;            //!&lt; Render window for OGRE
+    CeGuiString mCurrentScene;
+
+    RL_LONGLONG mClockStartTime;
+
+    bool mDeveloperMode;
+    bool mInitialized;
+    std::vector&lt;Ogre::Technique*&gt; mDefaultTechniques;
+
+    // The singletons of this subsystem
+    Ogre::Root* mOgreRoot;
+    ScriptWrapper* mScriptWrapper;
+    XmlResourceManager* mXmlResourceManager;
+    PhysicsManager* mPhysicsManager;
+    MessagePump* mMessagePump;
+    GameLoop* mGameLoop;
+    AnimationManager* mAnimationManager;
+    ActorManager* mActorManager;
+    GameEventManager* mGameEventManager;
+    SoundManager* mSoundManager;
+    DebugVisualsManager* mDebugVisualsManager;
+    SaveGameManager* mSaveGameManager;
+    JobScheduler* mJobScheduler;
+	ZoneManager* mZoneManager;
+    TimeSourceManager* mTimeSourceManager;
+
+    /** Runs the setup methods  */
+    bool initializeCoreSubsystem();
+
+    /** Loads all needed ressources */
+    void initializeResources();
+
+    void loadPlugins();
+    void unloadPlugins();
+
+    /**
+     * Sammelt alle Default-Techniques, um sie sp&#226;&#128;&#176;ter bei jedem aktivierten Scheme
+     * benutzen zu k&#203;&#134;nnen
+     */
+    void updateDefaultScheme();
+
+    void loadModule(ContentModule* module);
+};
+
+}
+#endif
+

Modified: rl/branches/newton20/engine/core/src/CoreSubsystem.cpp
===================================================================
--- rl/branches/newton20/engine/core/src/CoreSubsystem.cpp	2009-01-17 12:14:07 UTC (rev 4713)
+++ rl/branches/newton20/engine/core/src/CoreSubsystem.cpp	2009-01-21 19:52:59 UTC (rev 4714)
@@ -471,7 +471,7 @@
             {
                 Throw(
                     rl::RuntimeException,
-                    &quot;Depedency Module &quot; + depName
+                    &quot;Dependency Module &quot; + depName
                     + &quot; needed by &quot; + Ogre::String(module-&gt;getName().c_str())
                     + &quot; not found.&quot;);
             }
@@ -571,11 +571,24 @@
         return mModules;
     }
 
-    void CoreSubsystem::loadMap(const Ogre::String type, const Ogre::String filename,
-        const Ogre::String module)
+    void CoreSubsystem::loadMap(const Ogre::String&amp; type, const Ogre::String&amp; filename,
+        const Ogre::String&amp; module)
     {
         mWorld-&gt;loadScene(filename, module);
     }
+    
+    void CoreSubsystem::loadPlugin(const Ogre::String&amp; plugin)
+    {
+        Ogre::String pluginFile;
+        
+#if OGRE_PLATFORM == OGRE_PLATFORM_LINUX
+        pluginFile = &quot;lib&quot; + plugin;
+#else
+        pluginFile = plugin;
+#endif
+        
+        Ogre::Root::getSingleton().loadPlugin(pluginFile);
+    }
 
     void CoreSubsystem::loadPlugins()
     {

Modified: rl/branches/newton20/engine/core/src/SoundManager.cpp
===================================================================
--- rl/branches/newton20/engine/core/src/SoundManager.cpp	2009-01-17 12:14:07 UTC (rev 4713)
+++ rl/branches/newton20/engine/core/src/SoundManager.cpp	2009-01-21 19:52:59 UTC (rev 4714)
@@ -1,390 +1,387 @@
-/* This source file is part of Rastullahs Lockenpracht.
-* Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
-*
-*  This program is free software; you can redistribute it and/or modify
-*  it under the terms of the Clarified Artistic License.
-*
-*  This program is distributed in the hope that it will be useful,
-*  but WITHOUT ANY WARRANTY; without even the implied warranty of
-*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-*  Clarified Artistic License for more details.
-*
-*  You should have received a copy of the Clarified Artistic License
-*  along with this program; if not you can get it here
-*  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
-*/
-#include &quot;stdinc.h&quot; //precompiled header
-
-#include &quot;SoundManager.h&quot;
-
-#include &lt;set&gt;
-
-#include &quot;Actor.h&quot;
-#include &quot;ActorManager.h&quot;
-#include &quot;ConfigFile.h&quot;
-#include &quot;GameLoop.h&quot;
-#include &quot;ListenerMovable.h&quot;
-#include &quot;ListenerObject.h&quot;
-#include &quot;SoundDriver.h&quot;
-#include &quot;SoundResource.h&quot;
-
-#include &quot;NullDriver.h&quot;
-
-using namespace std;
-using namespace Ogre;
-
-/** Das Singleton
- * @author JoSch
- * @date 04-26-2004
- */
-template&lt;&gt; rl::SoundManager* Singleton&lt;rl::SoundManager&gt;::ms_Singleton = 0;
-
-namespace rl
-{
-    /**
-     * Standardkonstruktor
-     * @author JoSch
-     * @date 01-27-2005
-     */
-    SoundManager::SoundManager()
-    : ResourceManager(),
-      mDriverList(),
-      mActiveDriver(NULL),
-      mListenerActor(NULL),
-      mActiveListener(NULL)
-    {
-        LOG_MESSAGE(Logger::MULTIMEDIA, &quot;Erzeuge Soundmanager...&quot;);
-        NullDriver* nullDriver = new NullDriver(this);
-        registerDriver(nullDriver);
-        setActiveDriver(nullDriver);
-
-        mResourceType = &quot;Sound&quot;;
-        ResourceGroupManager::getSingleton()._registerResourceManager(mResourceType, this);
-
-    }
-
-    SoundManager::~SoundManager()
-    {
-        ResourceGroupManager::getSingleton()._unregisterResourceManager(mResourceType);
-        unloadAllDrivers();
-    }
-
-/**
- * Gibt die Suchmuster fuer die Extension zurueck.
- * @return Die Liste der Suchmuster
- * @author JoSch
- * @date 06-18-2004
- */
-StringList SoundManager::getExtension()
-{
-    StringList result;
-    result.push_back(&quot;*.ogg&quot;);
-    result.push_back(&quot;*.wav&quot;);
-
-    return result;
-}
-
-/**
-* @param resName. Der Name der Soundresource, die erzeugt
-* werden soll.
-* @author JoSch
-* @date 06-18-2004
-*/
-Resource* SoundManager::createImpl(
-    const String&amp; resName,
-    ResourceHandle handle,
-    const String&amp; group,
-    bool isManual,
-    ManualResourceLoader* loader,
-    const NameValuePairList* loadParams)
-{
-    SoundResource *newSound = NULL;
-    newSound = new SoundResource(this, resName, handle, group, isManual, loader);
-    return newSound;
-}
-
-/**
- * @param Der neue Treiber.
- * @author JoSch
- * @date 12-23-2005
- */
-void SoundManager::setActiveDriver(SoundDriver *driver)
-{
-    if (driver == NULL)
-    {
-        driver = getDriverByName(NullDriver::NAME);
-    }
-
-    if (mActiveDriver == driver)
-    {
-        LOG_DEBUG(Logger::MULTIMEDIA,
-            &quot;No need to change Sound Driver, &quot;
-            + mActiveDriver-&gt;getName()
-            + &quot; is already active.&quot;);
-        return;
-    }
-
-    LOG_MESSAGE(Logger::MULTIMEDIA,
-        &quot;Changing Sound Driver to &quot;
-         + driver-&gt;getName());
-
-    if (driver-&gt;initialize())
-    {
-        if (mActiveDriver != NULL)
-        {
-            mActiveDriver-&gt;shutdown();
-            mActiveDriver = NULL;
-        }
-        mActiveDriver = driver;
-    }
-    else
-    {
-        LOG_ERROR(
-            Logger::MULTIMEDIA,
-            &quot;Sound driver &quot;
-            + driver-&gt;getName()
-            + &quot; had an error while initializing, keeping old driver.&quot;);
-    }
-}
-
-void SoundManager::_clearListenerActor()
-{
-    mActiveListener = NULL;
-    mListenerActor = NULL;
-}
-
-
-/**
- * @return Der aktive Treiber.
- * @author JoSch
- * @date 12-23-2005
- */
-SoundDriver* SoundManager::getActiveDriver() const
-{
-    return mActiveDriver;
-}
-
-/**
- * @return Der aktive Listener.
- * @author JoSch
- * @date 04-04-2006
- */
-ListenerObject* SoundManager::getListener() const
-{
-    return mActiveListener;
-}
-
-Actor* SoundManager::createListenerActor()
-{
-    if (mListenerActor == NULL)
-    {
-        if (mActiveListener != NULL)
-        {
-            mActiveListener-&gt;getListener()-&gt;setActive(false);
-        }
-
-        mListenerActor = ActorManager::getSingleton().createListenerActor(&quot;SoundListenerObject&quot;);
-        mActiveListener = static_cast&lt;ListenerObject*&gt;(mListenerActor-&gt;getControlledObject());
-        mActiveListener-&gt;getListener()-&gt;setActive(true);
-        return mListenerActor;
-    }
-    else
-    {
-        Throw(IllegalStateException, &quot;ListenerActor already created.&quot;);
-    }
-}
-
-Actor* SoundManager::getListenerActor()
-{
-    return mListenerActor;
-}
-
-/**
- * Hole einen Treiber durch Angabe seines Namens
- * @param name Der name des gesuchten Treibers.
- * @return Der gesuchte Treiber
- * @author JoSch
- * @date 05-10-2006
- */
-SoundDriver *SoundManager::getDriverByName(const String &amp;name)
-{
-    DriverList::const_iterator it;
-    for(it = mDriverList.begin(); it != mDriverList.end(); it++)
-    {
-        if ((*it)-&gt;getName() == name)
-        {
-            return *it;
-        }
-    }
-    return 0;
-}
-
-    const std::list&lt;SoundDriver*&gt;&amp; SoundManager::getDriverList()
-    {
-        return mDriverList;
-    }
-
-    void SoundManager::registerDriver(rl::SoundDriver *driver)
-    {
-        mDriverList.push_back(driver);
-    }
-
-    void SoundManager::unregisterDriver(rl::SoundDriver *driver)
-    {
-        mDriverList.remove(driver);
-    }
-
-    void SoundManager::applySettings(const Ogre::NameValuePairList&amp; settings)
-    {
-        // Get the sound driver
-        Ogre::NameValuePairList::const_iterator it = settings.find(&quot;Driver&quot;);
-        Ogre::String drivername;
-
-        if (it == settings.end())
-        {
-            drivername = &quot;RlFmod4Driver&quot;;
-        }
-        else
-        {
-            drivername = it-&gt;second;
-        }
-
-        try
-        {
-            #if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
-            Ogre::Root::getSingleton().loadPlugin(drivername);
-            #else
-            Ogre::Root::getSingleton().loadPlugin(&quot;lib&quot; + drivername);
-            #endif
-        }
-        catch(Ogre::Exception &amp;e)
-        {
-            LOG_MESSAGE(Logger::MULTIMEDIA,
-                CeGuiString(&quot;Soundtreiber kann nicht geladen werden: &quot;)
-                    + drivername + &quot;\n&quot;
-                    + e.getFullDescription());
-        }
-        catch(...)
-        {
-            LOG_MESSAGE(Logger::MULTIMEDIA,
-                 CeGuiString(&quot;Soundtreiber kann nicht geladen werden: &quot;)
-                    + drivername);
-        }
-
-        SoundDriver *driver = getDriverByName(drivername);
-
-        if (driver == NULL)
-        {
-            driver = getDriverByName(NullDriver::NAME);
-        }
-
-        RlAssert(driver != NULL, &quot;Beim Laden des Treibers ist ein Fehler aufgetreten&quot;);
-        setActiveDriver(driver);
-        getActiveDriver()-&gt;applySettings(settings);
-    }
-
-void SoundManager::unloadAllDrivers()
-{
-    if (mActiveDriver != NULL)
-    {
-        mActiveDriver-&gt;shutdown();
-        mActiveDriver = NULL;
-    }
-
-    for(DriverList::iterator it = mDriverList.begin(); it != mDriverList.end(); it++)
-    {
-#       if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
-        Ogre::String driverPlugin = (*it)-&gt;getName();
-#       else
-        Ogre::String driverPlugin = &quot;lib&quot; + (*it)-&gt;getName();
-#       endif
-
-        LOG_MESSAGE(Logger::MULTIMEDIA,
-            &quot;Unloading sound driver DLL &quot;
-            + driverPlugin);
-
-        bool isDriverPlugin = (*it)-&gt;isDriverPlugin();
-        if (isDriverPlugin)
-        {
-            Ogre::Root::getSingleton().unloadPlugin(driverPlugin);
-        }
-        else
-        {
-            delete *it;
-        }
-
-        LOG_MESSAGE(Logger::MULTIMEDIA,
-            &quot;Sound driver DLL &quot;
-            + driverPlugin
-            + &quot; successfully unloaded.&quot;);
-    }
-
-    mDriverList.clear();
-}
-
-/**
- * @author JoSch
- * @date 07-03-2005
- */
-void SoundManager::run(Real elapsedTime)
-{
-    if (mActiveDriver != NULL)
-    {
-        mActiveDriver-&gt;update();
-    }
-
-    if (mListenerActor != NULL)
-    {
-        mListenerActor-&gt;_update();
-    }
-}
-
-const Ogre::String&amp; SoundManager::getName() const
-{
-    static String NAME = &quot;SoundManager&quot;;
-
-    return NAME;
-}
-
-/**
- * @author JoSch
- * @date 20-04-2007
- * Delegate sound creation to active driver
- */
-Sound* SoundManager::createSound(const Ogre::String&amp; res, SoundType type)
-{
-    if (getActiveDriver() != NULL)
-    {
-        return getActiveDriver()-&gt;createSound(res, type);
-    }
-    return NULL;
-}
-
-/**
- * @author JoSch
- * @date 20-04-2007
- * Delegate sound creation to active driver
- */
-Sound* SoundManager::createSound(const SoundResourcePtr&amp; res, SoundType type)
-{
-    if (getActiveDriver() != NULL)
-    {
-        return getActiveDriver()-&gt;createSound(res, type);
-    }
-    return NULL;
-}
-
-/**
- * @author JoSch
- * @date 20-04-2007
- * Delegate sound destruction to active driver
- */
-void SoundManager::destroySound(Sound* sound)
-{
-    if (getActiveDriver() != NULL)
-    {
-        getActiveDriver()-&gt;destroySound(sound);
-    }
-}
-
-}
+/* This source file is part of Rastullahs Lockenpracht.
+* Copyright (C) 2003-2008 Team Pantheon. <A HREF="http://www.team-pantheon.de">http://www.team-pantheon.de</A>
+*
+*  This program is free software; you can redistribute it and/or modify
+*  it under the terms of the Clarified Artistic License.
+*
+*  This program is distributed in the hope that it will be useful,
+*  but WITHOUT ANY WARRANTY; without even the implied warranty of
+*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+*  Clarified Artistic License for more details.
+*
+*  You should have received a copy of the Clarified Artistic License
+*  along with this program; if not you can get it here
+*  <A HREF="http://www.jpaulmorrison.com/fbp/artistic2.htm.">http://www.jpaulmorrison.com/fbp/artistic2.htm.</A>
+*/
+#include &quot;stdinc.h&quot; //precompiled header
+
+#include &quot;SoundManager.h&quot;
+
+#include &lt;set&gt;
+
+#include &quot;Actor.h&quot;
+#include &quot;ActorManager.h&quot;
+#include &quot;ConfigFile.h&quot;
+#include &quot;CoreSubsystem.h&quot;
+#include &quot;GameLoop.h&quot;
+#include &quot;ListenerMovable.h&quot;
+#include &quot;ListenerObject.h&quot;
+#include &quot;SoundDriver.h&quot;
+#include &quot;SoundResource.h&quot;
+
+#include &quot;NullDriver.h&quot;
+
+using namespace std;
+using namespace Ogre;
+
+/** Das Singleton
+ * @author JoSch
+ * @date 04-26-2004
+ */
+template&lt;&gt; rl::SoundManager* Singleton&lt;rl::SoundManager&gt;::ms_Singleton = 0;
+
+namespace rl
+{
+    /**
+     * Standardkonstruktor
+     * @author JoSch
+     * @date 01-27-2005
+     */
+    SoundManager::SoundManager()
+    : ResourceManager(),
+      mDriverList(),
+      mActiveDriver(NULL),
+      mListenerActor(NULL),
+      mActiveListener(NULL)
+    {
+        LOG_MESSAGE(Logger::MULTIMEDIA, &quot;Erzeuge Soundmanager...&quot;);
+        NullDriver* nullDriver = new NullDriver(this);
+        registerDriver(nullDriver);
+        setActiveDriver(nullDriver);
+
+        mResourceType = &quot;Sound&quot;;
+        ResourceGroupManager::getSingleton()._registerResourceManager(mResourceType, this);
+
+    }
+
+    SoundManager::~SoundManager()
+    {
+        ResourceGroupManager::getSingleton()._unregisterResourceManager(mResourceType);
+        unloadAllDrivers();
+    }
+
+/**
+ * Gibt die Suchmuster fuer die Extension zurueck.
+ * @return Die Liste der Suchmuster
+ * @author JoSch
+ * @date 06-18-2004
+ */
+StringList SoundManager::getExtension()
+{
+    StringList result;
+    result.push_back(&quot;*.ogg&quot;);
+    result.push_back(&quot;*.wav&quot;);
+
+    return result;
+}
+
+/**
+* @param resName. Der Name der Soundresource, die erzeugt
+* werden soll.
+* @author JoSch
+* @date 06-18-2004
+*/
+Resource* SoundManager::createImpl(
+    const String&amp; resName,
+    ResourceHandle handle,
+    const String&amp; group,
+    bool isManual,
+    ManualResourceLoader* loader,
+    const NameValuePairList* loadParams)
+{
+    SoundResource *newSound = NULL;
+    newSound = new SoundResource(this, resName, handle, group, isManual, loader);
+    return newSound;
+}
+
+/**
+ * @param Der neue Treiber.
+ * @author JoSch
+ * @date 12-23-2005
+ */
+void SoundManager::setActiveDriver(SoundDriver *driver)
+{
+    if (driver == NULL)
+    {
+        driver = getDriverByName(NullDriver::NAME);
+    }
+
+    if (mActiveDriver == driver)
+    {
+        LOG_DEBUG(Logger::MULTIMEDIA,
+            &quot;No need to change Sound Driver, &quot;
+            + mActiveDriver-&gt;getName()
+            + &quot; is already active.&quot;);
+        return;
+    }
+
+    LOG_MESSAGE(Logger::MULTIMEDIA,
+        &quot;Changing Sound Driver to &quot;
+         + driver-&gt;getName());
+
+    if (driver-&gt;initialize())
+    {
+        if (mActiveDriver != NULL)
+        {
+            mActiveDriver-&gt;shutdown();
+            mActiveDriver = NULL;
+        }
+        mActiveDriver = driver;
+    }
+    else
+    {
+        LOG_ERROR(
+            Logger::MULTIMEDIA,
+            &quot;Sound driver &quot;
+            + driver-&gt;getName()
+            + &quot; had an error while initializing, keeping old driver.&quot;);
+    }
+}
+
+void SoundManager::_clearListenerActor()
+{
+    mActiveListener = NULL;
+    mListenerActor = NULL;
+}
+
+
+/**
+ * @return Der aktive Treiber.
+ * @author JoSch
+ * @date 12-23-2005
+ */
+SoundDriver* SoundManager::getActiveDriver() const
+{
+    return mActiveDriver;
+}
+
+/**
+ * @return Der aktive Listener.
+ * @author JoSch
+ * @date 04-04-2006
+ */
+ListenerObject* SoundManager::getListener() const
+{
+    return mActiveListener;
+}
+
+Actor* SoundManager::createListenerActor()
+{
+    if (mListenerActor == NULL)
+    {
+        if (mActiveListener != NULL)
+        {
+            mActiveListener-&gt;getListener()-&gt;setActive(false);
+        }
+
+        mListenerActor = ActorManager::getSingleton().createListenerActor(&quot;SoundListenerObject&quot;);
+        mActiveListener = static_cast&lt;ListenerObject*&gt;(mListenerActor-&gt;getControlledObject());
+        mActiveListener-&gt;getListener()-&gt;setActive(true);
+        return mListenerActor;
+    }
+    else
+    {
+        Throw(IllegalStateException, &quot;ListenerActor already created.&quot;);
+    }
+}
+
+Actor* SoundManager::getListenerActor()
+{
+    return mListenerActor;
+}
+
+/**
+ * Hole einen Treiber durch Angabe seines Namens
+ * @param name Der name des gesuchten Treibers.
+ * @return Der gesuchte Treiber
+ * @author JoSch
+ * @date 05-10-2006
+ */
+SoundDriver *SoundManager::getDriverByName(const String &amp;name)
+{
+    DriverList::const_iterator it;
+    for(it = mDriverList.begin(); it != mDriverList.end(); it++)
+    {
+        if ((*it)-&gt;getName() == name)
+        {
+            return *it;
+        }
+    }
+    return 0;
+}
+
+    const std::list&lt;SoundDriver*&gt;&amp; SoundManager::getDriverList()
+    {
+        return mDriverList;
+    }
+
+    void SoundManager::registerDriver(rl::SoundDriver *driver)
+    {
+        mDriverList.push_back(driver);
+    }
+
+    void SoundManager::unregisterDriver(rl::SoundDriver *driver)
+    {
+        mDriverList.remove(driver);
+    }
+
+    void SoundManager::applySettings(const Ogre::NameValuePairList&amp; settings)
+    {
+        // Get the sound driver
+        Ogre::NameValuePairList::const_iterator it = settings.find(&quot;Driver&quot;);
+        Ogre::String drivername;
+
+        if (it == settings.end())
+        {
+            drivername = &quot;RlFmod4Driver&quot;;
+        }
+        else
+        {
+            drivername = it-&gt;second;
+        }
+
+        try
+        {
+            CoreSubsystem::getSingleton().loadPlugin(drivername);
+        }
+        catch(Ogre::Exception &amp;e)
+        {
+            LOG_MESSAGE(Logger::MULTIMEDIA,
+                CeGuiString(&quot;Soundtreiber kann nicht geladen werden: &quot;)
+                    + drivername + &quot;\n&quot;
+                    + e.getFullDescription());
+        }
+        catch(...)
+        {
+            LOG_MESSAGE(Logger::MULTIMEDIA,
+                 CeGuiString(&quot;Soundtreiber kann nicht geladen werden: &quot;)
+                    + drivername);
+        }
+
+        SoundDriver *driver = getDriverByName(drivername);
+
+        if (driver == NULL)
+        {
+            driver = getDriverByName(NullDriver::NAME);
+        }
+
+        RlAssert(driver != NULL, &quot;Beim Laden des Treibers ist ein Fehler aufgetreten&quot;);
+        setActiveDriver(driver);
+        getActiveDriver()-&gt;applySettings(settings);
+    }
+
+void SoundManager::unloadAllDrivers()
+{
+    if (mActiveDriver != NULL)
+    {
+        mActiveDriver-&gt;shutdown();
+        mActiveDriver = NULL;
+    }
+
+    for(DriverList::iterator it = mDriverList.begin(); it != mDriverList.end(); it++)
+    {
+#       if OGRE_PLATFORM == OGRE_PLATFORM_WIN32
+        Ogre::String driverPlugin = (*it)-&gt;getName();
+#       else
+        Ogre::String driverPlugin = &quot;lib&quot; + (*it)-&gt;getName();
+#       endif
+
+        LOG_MESSAGE(Logger::MULTIMEDIA,
+            &quot;Unloading sound driver DLL &quot;
+            + driverPlugin);
+
+        bool isDriverPlugin = (*it)-&gt;isDriverPlugin();
+        if (isDriverPlugin)
+        {
+            Ogre::Root::getSingleton().unloadPlugin(driverPlugin);
+        }
+        else
+        {
+            delete *it;
+        }
+
+        LOG_MESSAGE(Logger::MULTIMEDIA,
+            &quot;Sound driver DLL &quot;
+            + driverPlugin
+            + &quot; successfully unloaded.&quot;);
+    }
+
+    mDriverList.clear();
+}
+
+/**
+ * @author JoSch
+ * @date 07-03-2005
+ */
+void SoundManager::run(Real elapsedTime)
+{
+    if (mActiveDriver != NULL)
+    {
+        mActiveDriver-&gt;update();
+    }
+
+    if (mListenerActor != NULL)
+    {
+        mListenerActor-&gt;_update();
+    }
+}
+
+const Ogre::String&amp; SoundManager::getName() const
+{
+    static String NAME = &quot;SoundManager&quot;;
+
+    return NAME;
+}
+
+/**
+ * @author JoSch
+ * @date 20-04-2007
+ * Delegate sound creation to active driver
+ */
+Sound* SoundManager::createSound(const Ogre::String&amp; res, SoundType type)
+{
+    if (getActiveDriver() != NULL)
+    {
+        return getActiveDriver()-&gt;createSound(res, type);
+    }
+    return NULL;
+}
+
+/**
+ * @author JoSch
+ * @date 20-04-2007
+ * Delegate sound creation to active driver
+ */
+Sound* SoundManager::createSound(const SoundResourcePtr&amp; res, SoundType type)
+{
+    if (getActiveDriver() != NULL)
+    {
+        return getActiveDriver()-&gt;createSound(res, type);
+    }
+    return NULL;
+}
+
+/**
+ * @author JoSch
+ * @date 20-04-2007
+ * Delegate sound destruction to active driver
+ */
+void SoundManager::destroySound(Sound* sound)
+{
+    if (getActiveDriver() != NULL)
+    {
+        getActiveDriver()-&gt;destroySound(sound);
+    }
+}
+
+}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001770.html">[Dsa-hl-svn] r4713 - rl/trunk/Mac/Rastullah.xcodeproj
</A></li>
	<LI>Next message: <A HREF="001772.html">[Dsa-hl-svn] r4715 - in dependencies/OgreNewt_ngt: inc src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1771">[ date ]</a>
              <a href="thread.html#1771">[ thread ]</a>
              <a href="subject.html#1771">[ subject ]</a>
              <a href="author.html#1771">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
