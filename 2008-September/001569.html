<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Dsa-hl-svn] r4512 - in modules: aitest/scripts/maps	combattest/scripts combattest/scripts/maps common/scripts	kanalisation/scripts kanalisation/scripts/maps	persistenztest/scripts persistenztest/scripts/maps	regressiontest/scripts regressiontest/scripts/maps	ruchin/scripts ruchin/scripts/maps techdemo/scripts/maps	techdemo2/scripts techdemo2/scripts/maps teichtest/scripts/maps
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/dsa-hl-svn/2008-September/index.html" >
   <LINK REL="made" HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4512%20-%20in%20modules%3A%20aitest/scripts/maps%0A%09combattest/scripts%20combattest/scripts/maps%20common/scripts%0A%09kanalisation/scripts%20kanalisation/scripts/maps%0A%09persistenztest/scripts%20persistenztest/scripts/maps%0A%09regressiontest/scripts%20regressiontest/scripts/maps%0A%09ruchin/scripts%20ruchin/scripts/maps%20techdemo/scripts/maps%0A%09techdemo2/scripts%20techdemo2/scripts/maps%20teichtest/scripts/maps&In-Reply-To=%3C200809172225.m8HMPOJ5011855%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001568.html">
   <LINK REL="Next"  HREF="001570.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Dsa-hl-svn] r4512 - in modules: aitest/scripts/maps	combattest/scripts combattest/scripts/maps common/scripts	kanalisation/scripts kanalisation/scripts/maps	persistenztest/scripts persistenztest/scripts/maps	regressiontest/scripts regressiontest/scripts/maps	ruchin/scripts ruchin/scripts/maps techdemo/scripts/maps	techdemo2/scripts techdemo2/scripts/maps teichtest/scripts/maps</H1>
    <B>blakharaz at mail.berlios.de</B> 
    <A HREF="mailto:dsa-hl-svn%40lists.berlios.de?Subject=Re%3A%20%5BDsa-hl-svn%5D%20r4512%20-%20in%20modules%3A%20aitest/scripts/maps%0A%09combattest/scripts%20combattest/scripts/maps%20common/scripts%0A%09kanalisation/scripts%20kanalisation/scripts/maps%0A%09persistenztest/scripts%20persistenztest/scripts/maps%0A%09regressiontest/scripts%20regressiontest/scripts/maps%0A%09ruchin/scripts%20ruchin/scripts/maps%20techdemo/scripts/maps%0A%09techdemo2/scripts%20techdemo2/scripts/maps%20teichtest/scripts/maps&In-Reply-To=%3C200809172225.m8HMPOJ5011855%40sheep.berlios.de%3E"
       TITLE="[Dsa-hl-svn] r4512 - in modules: aitest/scripts/maps	combattest/scripts combattest/scripts/maps common/scripts	kanalisation/scripts kanalisation/scripts/maps	persistenztest/scripts persistenztest/scripts/maps	regressiontest/scripts regressiontest/scripts/maps	ruchin/scripts ruchin/scripts/maps techdemo/scripts/maps	techdemo2/scripts techdemo2/scripts/maps teichtest/scripts/maps">blakharaz at mail.berlios.de
       </A><BR>
    <I>Thu Sep 18 00:25:24 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001568.html">[Dsa-hl-svn] r4511 - in rl/trunk/engine: rules/include rules/src	script/src script/swig ui/include ui/src
</A></li>
        <LI>Next message: <A HREF="001570.html">[Dsa-hl-svn] r4513 - in rl/trunk/engine/ui: include src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1569">[ date ]</a>
              <a href="thread.html#1569">[ thread ]</a>
              <a href="subject.html#1569">[ subject ]</a>
              <a href="author.html#1569">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: blakharaz
Date: 2008-09-18 00:25:15 +0200 (Thu, 18 Sep 2008)
New Revision: 4512

Modified:
   modules/aitest/scripts/maps/aitest.rb
   modules/aitest/scripts/maps/aitest2.rb
   modules/aitest/scripts/maps/aitestold.rb
   modules/combattest/scripts/equip.rb
   modules/combattest/scripts/maps/combattest.rb
   modules/common/scripts/globals.rb
   modules/kanalisation/scripts/equip.rb
   modules/kanalisation/scripts/maps/kanalisation.rb
   modules/persistenztest/scripts/MapChange.rb
   modules/persistenztest/scripts/maps/setchar.rb
   modules/regressiontest/scripts/InventoryTest.rb
   modules/regressiontest/scripts/effecttest.rb
   modules/regressiontest/scripts/maps/regressiontest.rb
   modules/ruchin/scripts/equip.rb
   modules/ruchin/scripts/maps/maptest.rb
   modules/ruchin/scripts/maps/ruchin.rb
   modules/techdemo/scripts/maps/techdemo.rb
   modules/techdemo2/scripts/druidentod.rb
   modules/techdemo2/scripts/maps/techdemo2map1.rb
   modules/techdemo2/scripts/maps/techdemo2map2.rb
   modules/teichtest/scripts/maps/setchar.rb
Log:
Adapted ruby scripts

Modified: modules/aitest/scripts/maps/aitest.rb
===================================================================
--- modules/aitest/scripts/maps/aitest.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/aitest/scripts/maps/aitest.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -33,7 +33,7 @@
 PlayerSettings.preparePlayer($hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 $SCRIPT.log(&quot;Hero ready&quot;)
 
 $SCRIPT.log(&quot;map 'regressiontest' initialisiert.&quot;);

Modified: modules/aitest/scripts/maps/aitest2.rb
===================================================================
--- modules/aitest/scripts/maps/aitest2.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/aitest/scripts/maps/aitest2.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -35,7 +35,7 @@
 PlayerSettings.preparePlayer($hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 
 $SCRIPT.log(&quot;Hero ready&quot;)
 

Modified: modules/aitest/scripts/maps/aitestold.rb
===================================================================
--- modules/aitest/scripts/maps/aitestold.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/aitest/scripts/maps/aitestold.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -35,7 +35,7 @@
 PlayerSettings.preparePlayer($hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 
 $SCRIPT.log(&quot;Hero ready&quot;)
 

Modified: modules/combattest/scripts/equip.rb
===================================================================
--- modules/combattest/scripts/equip.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/combattest/scripts/equip.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -2,7 +2,7 @@
 require 'clothing.rb'
 	
 	$SCRIPT.log(&quot;aktiven hero geten&quot;);
-	hero = $UI.getActiveCharacter();
+	hero = PartyManager.getSingleton().getActiveCharacter();
 
     
     itemToAdd = $GOM.createGameObject(&quot;men_human_female_legs_pants_01_long&quot;);

Modified: modules/combattest/scripts/maps/combattest.rb
===================================================================
--- modules/combattest/scripts/maps/combattest.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/combattest/scripts/maps/combattest.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -23,7 +23,7 @@
 PlayerSettings.preparePlayer($hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 $SCRIPT.log(&quot;Hero ready&quot;)
 
 wolf = $GOM.createGameObject(&quot;Wolf&quot;)

Modified: modules/common/scripts/globals.rb
===================================================================
--- modules/common/scripts/globals.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/common/scripts/globals.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -9,7 +9,6 @@
 $JS = JobScheduler.getSingleton();
 $AM = ActorManager.getSingleton();
 $PM = PhysicsManager.getSingleton();
-$UI = UiSubsystem.getSingleton();
 $DM = DsaManager.getSingleton();
 $WF = WindowFactory.getSingleton();
 $AI = AiSubsystem.getSingleton();
@@ -30,7 +29,7 @@
 	
   end
   def writePos()
-	actor = $UI.getActiveCharacter().getActor();
+	actor = PartyManager.getSingleton().getActiveCharacter().getActor();
 	$SCRIPT.log(&quot;[ &quot;+actor.getWorldPosition()[0].to_s+&quot;, &quot;+actor.getWorldPosition()[1].to_s+&quot;, &quot;+actor.getWorldPosition()[2].to_s+&quot;]&quot; );  
 	$SCRIPT.log(&quot;[ [ &quot;+actor.getWorldOrientation()[0][0].to_s+&quot;, &quot;+actor.getWorldOrientation()[0][1].to_s+&quot;, &quot;+actor.getWorldOrientation()[0][2].to_s+&quot; ] , &quot;+actor.getWorldOrientation()[1].to_s+&quot;]&quot;) ; 
   end

Modified: modules/kanalisation/scripts/equip.rb
===================================================================
--- modules/kanalisation/scripts/equip.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/kanalisation/scripts/equip.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -2,7 +2,7 @@
 require 'torch.rb'
 require 'clothing.rb'
 
-hero = $UI.getActiveCharacter();
+hero = PartyManager.getSingleton().getActiveCharacter();
 
 itemToAdd = $GOM.createGameObject(&quot;men_human_female_legs_pants_01_long&quot;);
 hero.getInventory().hold(itemToAdd, &quot;Trousers&quot;);

Modified: modules/kanalisation/scripts/maps/kanalisation.rb
===================================================================
--- modules/kanalisation/scripts/maps/kanalisation.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/kanalisation/scripts/maps/kanalisation.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -38,15 +38,8 @@
 $hero.setPosition([ -35.15, 2.69, 26.09]);
 $hero.setOrientation([ [ -4.43614335381426e-005, -0.999999940395355, -3.53998184436932e-005 ] , 67.3891525268555]);
 PlayerSettings.preparePlayer($hero);
-$UI.setActiveCharacter($hero)
-$SCRIPT.log(&quot;Create hero&quot;)
+PartyManager.getSingleton().setActiveCharacter($hero)
 
-$SCRIPT.log(&quot;Prepare hero for being the active character&quot;)
-PlayerSettings.preparePlayer($hero)
-
-$SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter($hero)
-
 $SCRIPT.log(&quot;Hero ready&quot;)
 
 #$SCRIPT.log(&quot;Fackellicht erstellen..&quot;);

Modified: modules/persistenztest/scripts/MapChange.rb
===================================================================
--- modules/persistenztest/scripts/MapChange.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/persistenztest/scripts/MapChange.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -2,9 +2,9 @@
 require &quot;areahelper.rb&quot;
 
 def changeScene(scene)
-#	characterId = $UI.getActiveCharacter().getId()
-#	CreatureControllerManager.getSingleton().detachController($UI.getActiveCharacter())
-#	$UI.setActiveCharacter(nil)
+#	characterId = PartyManager.getSingleton().getActiveCharacter().getId()
+#	CreatureControllerManager.getSingleton().detachController(PartyManager.getSingleton().getActiveCharacter())
+#	PartyManager.getSingleton().setActiveCharacter(nil)
 	#$SCRIPT.logError(mapNames.type().to_s)
 #	mapLoader.requestSceneChange(mapNames)
 	SceneManager::getSingleton().loadScene(scene, true);

Modified: modules/persistenztest/scripts/maps/setchar.rb
===================================================================
--- modules/persistenztest/scripts/maps/setchar.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/persistenztest/scripts/maps/setchar.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -9,7 +9,7 @@
 PlayerSettings.preparePlayer(hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter(hero)
+PartyManager.getSingleton().setActiveCharacter(hero)
 
 $SCRIPT.log(&quot;Hero ready&quot;)
 itemToAdd = $GOM.createGameObject(&quot;men_human_female_legs_pants_01_long&quot;);

Modified: modules/regressiontest/scripts/InventoryTest.rb
===================================================================
--- modules/regressiontest/scripts/InventoryTest.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/regressiontest/scripts/InventoryTest.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -4,7 +4,7 @@
 class InventoryTest &lt; TestCase
   def execute()
     $SCRIPT.log(&quot;InventoryTest started.&quot;);
-    hero = $UI.getActiveCharacter();
+    hero = PartyManager.getSingleton().getActiveCharacter();
     backpack = $GOM.createGameObject(&quot;leather backpack&quot;);
     #backpack.addAction(ShowContainerContentAction.new());
     #backpack.setPosition(center);

Modified: modules/regressiontest/scripts/effecttest.rb
===================================================================
--- modules/regressiontest/scripts/effecttest.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/regressiontest/scripts/effecttest.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -49,7 +49,7 @@
     def execute()
 	
 		# Define a pointer to the hero
-		$h = $UI.getActiveCharacter()
+		$h = PartyManager.getSingleton().getActiveCharacter()
         # Define a base box to place everything else on.
         height = 0.1
         min_base = [-2.0, 0.05, -2.0]

Modified: modules/regressiontest/scripts/maps/regressiontest.rb
===================================================================
--- modules/regressiontest/scripts/maps/regressiontest.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/regressiontest/scripts/maps/regressiontest.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -11,10 +11,11 @@
 
 $SCRIPT.log(&quot;Prepare hero for being the active character&quot;)
 $hero = $GOM.getGameObject(10);
+$hero.modifyLe(-20);
 PlayerSettings.preparePlayer($hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 
 $SCRIPT.log(&quot;Hero ready&quot;)
 

Modified: modules/ruchin/scripts/equip.rb
===================================================================
--- modules/ruchin/scripts/equip.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/ruchin/scripts/equip.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -1,7 +1,7 @@
 require 'npc.rb'
 	
 	$SCRIPT.log(&quot;aktiven hero geten&quot;);
-	hero = $UI.getActiveCharacter();
+	hero = PartyManager.getSingleton().getActiveCharacter();
 	
 	$SCRIPT.log(&quot;backpack erstellen&quot;);
     #backpack = $GOM.createGameObject(&quot;leather backpack&quot;);

Modified: modules/ruchin/scripts/maps/maptest.rb
===================================================================
--- modules/ruchin/scripts/maps/maptest.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/ruchin/scripts/maps/maptest.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -46,7 +46,7 @@
 PlayerSettings.preparePlayer($hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 
 $SCRIPT.log(&quot;Hero ready&quot;)
 

Modified: modules/ruchin/scripts/maps/ruchin.rb
===================================================================
--- modules/ruchin/scripts/maps/ruchin.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/ruchin/scripts/maps/ruchin.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -18,7 +18,7 @@
 $hero.setPosition([ -35.3738746643066, -5.64282417297363, -64.6520767211914]);
 $hero.setOrientation([ [ -4.43614335381426e-005, -0.999999940395355, -3.53998184436932e-005 ] , 67.3891525268555]);
 PlayerSettings.preparePlayer($hero);
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 
 $SCRIPT.log(&quot;Initialize NPCs&quot;);
 $SCRIPT.log(&quot;Hesindiane...&quot;);

Modified: modules/techdemo/scripts/maps/techdemo.rb
===================================================================
--- modules/techdemo/scripts/maps/techdemo.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/techdemo/scripts/maps/techdemo.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -26,7 +26,7 @@
 
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter(hero)
+PartyManager.getSingleton().setActiveCharacter(hero)
 
 $World.setFog( World::FOG_EXP, [0.8,0.8,1.0,0.5], 0.00003, 0.4, 1.0);
 

Modified: modules/techdemo2/scripts/druidentod.rb
===================================================================
--- modules/techdemo2/scripts/druidentod.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/techdemo2/scripts/druidentod.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -1,6 +1,6 @@
 #&lt;!-- Script um Druiden mit Animationen sterben zu lassen, Physikschubs, als Dialogpartner deaktivieren. druidentod.rb--&gt;
 
-$UI.getActiveCharacter().getActor().getControlledObject().startAnimation(&quot;kampf_schwerter_angriff_1&quot;, 1.0, 1)
+PartyManager.getSingleton().getActiveCharacter().getActor().getControlledObject().startAnimation(&quot;kampf_schwerter_angriff_1&quot;, 1.0, 1)
 
 #Ger&#65533;usch
 @mTodSound = $AM.createSoundSampleActor(&quot;TodSound&quot;,&quot;altermann005.ogg&quot;);

Modified: modules/techdemo2/scripts/maps/techdemo2map1.rb
===================================================================
--- modules/techdemo2/scripts/maps/techdemo2map1.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/techdemo2/scripts/maps/techdemo2map1.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -13,7 +13,7 @@
 $hero = $GOM.createGameObject(&quot;hero&quot;, 1);
 $hero.placeIntoScene()
 PlayerSettings.preparePlayer($hero)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 $SCRIPT.log(&quot;Held erstellt&quot;);
 
 #$heroVehicle = $AGM.createAgent(AgentManager::AGENT_PLAYER, $hero);	

Modified: modules/techdemo2/scripts/maps/techdemo2map2.rb
===================================================================
--- modules/techdemo2/scripts/maps/techdemo2map2.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/techdemo2/scripts/maps/techdemo2map2.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -10,7 +10,7 @@
 $hero = $GOM.createGameObject(&quot;hero&quot;, 1);
 $hero.placeIntoScene()
 PlayerSettings.preparePlayer($hero)
-$UI.setActiveCharacter($hero)
+PartyManager.getSingleton().setActiveCharacter($hero)
 $SCRIPT.log(&quot;Held erstellt&quot;);
 
 #$heroVehicle = $AGM.createAgent(AgentManager::AGENT_PLAYER, $hero);	

Modified: modules/teichtest/scripts/maps/setchar.rb
===================================================================
--- modules/teichtest/scripts/maps/setchar.rb	2008-09-17 22:24:26 UTC (rev 4511)
+++ modules/teichtest/scripts/maps/setchar.rb	2008-09-17 22:25:15 UTC (rev 4512)
@@ -8,7 +8,7 @@
 PlayerSettings.preparePlayer(hero)
 
 $SCRIPT.log(&quot;Set hero as active character&quot;)
-$UI.setActiveCharacter(hero)
+PartyManager.getSingleton().setActiveCharacter(hero)
 
 $SCRIPT.log(&quot;Hero ready&quot;)
 itemToAdd = $GOM.createGameObject(&quot;men_human_female_legs_pants_01_long&quot;);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001568.html">[Dsa-hl-svn] r4511 - in rl/trunk/engine: rules/include rules/src	script/src script/swig ui/include ui/src
</A></li>
	<LI>Next message: <A HREF="001570.html">[Dsa-hl-svn] r4513 - in rl/trunk/engine/ui: include src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1569">[ date ]</a>
              <a href="thread.html#1569">[ thread ]</a>
              <a href="subject.html#1569">[ subject ]</a>
              <a href="author.html#1569">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/dsa-hl-svn">More information about the Dsa-hl-svn
mailing list</a><br>
</body></html>
